Command line
python /home/jxy/anaconda3/envs/chemprop_1119/bin/chemprop_train --data_path data/train_full.csv --dataset_type classification --save_dir checkpoints_18 --config_path hyperoptfile --epochs 100 --separate_test_path data/test_random_nocanonical.csv --separate_val_path data/val_full.csv --features_generator rdkit_2d_normalized --no_features_scaling --ensemble_size 5
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'hyperoptfile',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/train_full.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 5,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1200,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1200,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'checkpoints_18',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'data/test_random_nocanonical.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'data/val_full.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smile'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 46.78%, 1: 53.22%
Total size = 1,041 | train size = 1,041 | val size = 116 | test size = 290
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 4,900,801
Moving model to cuda
Epoch 0
Loss = 6.8340e-01, PNorm = 63.4095, GNorm = 1.1787, lr_0 = 3.4750e-04
Loss = 6.7985e-01, PNorm = 63.4490, GNorm = 1.3726, lr_0 = 5.7250e-04
Loss = 6.8123e-01, PNorm = 63.4539, GNorm = 2.3500, lr_0 = 5.9500e-04
Validation auc = 0.727079
Epoch 1
Loss = 6.6356e-01, PNorm = 63.5207, GNorm = 1.3937, lr_0 = 8.2000e-04
Loss = 6.5606e-01, PNorm = 63.6078, GNorm = 1.5779, lr_0 = 9.9765e-04
Validation auc = 0.737435
Epoch 2
Loss = 6.1403e-01, PNorm = 63.6974, GNorm = 1.4853, lr_0 = 9.8600e-04
Loss = 6.6604e-01, PNorm = 63.7886, GNorm = 1.4869, lr_0 = 9.7449e-04
Validation auc = 0.755407
Epoch 3
Loss = 5.9632e-01, PNorm = 63.8846, GNorm = 0.7625, lr_0 = 9.6310e-04
Loss = 6.2501e-01, PNorm = 63.9634, GNorm = 0.9221, lr_0 = 9.5186e-04
Validation auc = 0.764849
Epoch 4
Loss = 5.7075e-01, PNorm = 64.0461, GNorm = 0.5350, lr_0 = 9.4074e-04
Loss = 6.0045e-01, PNorm = 64.1474, GNorm = 0.7813, lr_0 = 9.2975e-04
Validation auc = 0.776119
Epoch 5
Loss = 5.9944e-01, PNorm = 64.2192, GNorm = 1.0570, lr_0 = 9.1889e-04
Loss = 5.7150e-01, PNorm = 64.3133, GNorm = 0.4832, lr_0 = 9.0816e-04
Validation auc = 0.789522
Epoch 6
Loss = 6.0698e-01, PNorm = 64.4157, GNorm = 1.0405, lr_0 = 8.9650e-04
Loss = 5.8803e-01, PNorm = 64.4908, GNorm = 0.9297, lr_0 = 8.8603e-04
Validation auc = 0.784648
Epoch 7
Loss = 5.5109e-01, PNorm = 64.5912, GNorm = 0.6961, lr_0 = 8.7568e-04
Loss = 5.6271e-01, PNorm = 64.6939, GNorm = 1.2121, lr_0 = 8.6546e-04
Validation auc = 0.778861
Epoch 8
Loss = 5.4532e-01, PNorm = 64.7747, GNorm = 0.6349, lr_0 = 8.5535e-04
Loss = 5.4040e-01, PNorm = 64.8960, GNorm = 1.0072, lr_0 = 8.4536e-04
Validation auc = 0.762108
Epoch 9
Loss = 5.7243e-01, PNorm = 65.0242, GNorm = 0.7446, lr_0 = 8.3549e-04
Loss = 5.5799e-01, PNorm = 65.1533, GNorm = 1.3804, lr_0 = 8.2573e-04
Validation auc = 0.769723
Epoch 10
Loss = 5.7106e-01, PNorm = 65.2577, GNorm = 0.6441, lr_0 = 8.1608e-04
Loss = 5.6082e-01, PNorm = 65.3903, GNorm = 0.6838, lr_0 = 8.0655e-04
Validation auc = 0.784039
Epoch 11
Loss = 5.7380e-01, PNorm = 65.5068, GNorm = 0.6283, lr_0 = 7.9713e-04
Loss = 5.1968e-01, PNorm = 65.6340, GNorm = 0.6911, lr_0 = 7.8782e-04
Validation auc = 0.772160
Epoch 12
Loss = 5.1296e-01, PNorm = 65.7632, GNorm = 0.6193, lr_0 = 7.7771e-04
Loss = 5.1677e-01, PNorm = 65.8686, GNorm = 0.4921, lr_0 = 7.6862e-04
Loss = 5.4382e-01, PNorm = 65.9842, GNorm = 0.6145, lr_0 = 7.5965e-04
Validation auc = 0.795918
Epoch 13
Loss = 5.1937e-01, PNorm = 66.1295, GNorm = 0.5172, lr_0 = 7.5078e-04
Loss = 5.2504e-01, PNorm = 66.2779, GNorm = 0.9889, lr_0 = 7.4201e-04
Validation auc = 0.760585
Epoch 14
Loss = 5.2157e-01, PNorm = 66.4352, GNorm = 0.6707, lr_0 = 7.3334e-04
Loss = 5.2000e-01, PNorm = 66.5726, GNorm = 0.8594, lr_0 = 7.2478e-04
Validation auc = 0.802620
Epoch 15
Loss = 4.7109e-01, PNorm = 66.7529, GNorm = 0.7173, lr_0 = 7.1631e-04
Loss = 4.8668e-01, PNorm = 66.9010, GNorm = 0.5441, lr_0 = 7.0795e-04
Validation auc = 0.795918
Epoch 16
Loss = 4.6881e-01, PNorm = 67.0543, GNorm = 0.5698, lr_0 = 6.9968e-04
Loss = 4.7763e-01, PNorm = 67.2251, GNorm = 0.5784, lr_0 = 6.9151e-04
Validation auc = 0.791959
Epoch 17
Loss = 4.5152e-01, PNorm = 67.3924, GNorm = 0.6386, lr_0 = 6.8263e-04
Loss = 4.6959e-01, PNorm = 67.5657, GNorm = 1.0235, lr_0 = 6.7465e-04
Validation auc = 0.792263
Epoch 18
Loss = 4.4083e-01, PNorm = 67.7009, GNorm = 0.5959, lr_0 = 6.6678e-04
Loss = 4.7548e-01, PNorm = 67.8880, GNorm = 0.5967, lr_0 = 6.5899e-04
Validation auc = 0.800183
Epoch 19
Loss = 4.2759e-01, PNorm = 68.0810, GNorm = 1.0830, lr_0 = 6.5129e-04
Loss = 4.8067e-01, PNorm = 68.2678, GNorm = 0.9418, lr_0 = 6.4369e-04
Validation auc = 0.789826
Epoch 20
Loss = 4.6347e-01, PNorm = 68.4506, GNorm = 0.6388, lr_0 = 6.3617e-04
Loss = 4.4240e-01, PNorm = 68.6480, GNorm = 1.2825, lr_0 = 6.2874e-04
Validation auc = 0.793177
Epoch 21
Loss = 4.7114e-01, PNorm = 68.8429, GNorm = 1.4037, lr_0 = 6.2139e-04
Loss = 4.4084e-01, PNorm = 69.0385, GNorm = 0.4980, lr_0 = 6.1414e-04
Validation auc = 0.808407
Epoch 22
Loss = 3.9711e-01, PNorm = 69.2310, GNorm = 0.7170, lr_0 = 6.0696e-04
Loss = 4.1318e-01, PNorm = 69.4346, GNorm = 0.7235, lr_0 = 5.9988e-04
Validation auc = 0.806275
Epoch 23
Loss = 3.9849e-01, PNorm = 69.6315, GNorm = 0.6019, lr_0 = 5.9217e-04
Loss = 4.3585e-01, PNorm = 69.8293, GNorm = 0.7537, lr_0 = 5.8526e-04
Validation auc = 0.799574
Epoch 24
Loss = 3.4797e-01, PNorm = 70.0214, GNorm = 0.6532, lr_0 = 5.7842e-04
Loss = 3.9989e-01, PNorm = 70.2045, GNorm = 1.1463, lr_0 = 5.7167e-04
Loss = 4.1907e-01, PNorm = 70.3810, GNorm = 0.7191, lr_0 = 5.6499e-04
Validation auc = 0.802315
Epoch 25
Loss = 3.8599e-01, PNorm = 70.5807, GNorm = 0.5771, lr_0 = 5.5839e-04
Loss = 3.8496e-01, PNorm = 70.7666, GNorm = 0.6333, lr_0 = 5.5187e-04
Validation auc = 0.766372
Epoch 26
Loss = 4.2007e-01, PNorm = 70.9421, GNorm = 0.9175, lr_0 = 5.4542e-04
Loss = 3.9476e-01, PNorm = 71.1235, GNorm = 0.7785, lr_0 = 5.3905e-04
Validation auc = 0.815413
Epoch 27
Loss = 3.8507e-01, PNorm = 71.3114, GNorm = 1.3720, lr_0 = 5.3276e-04
Loss = 3.6946e-01, PNorm = 71.4927, GNorm = 0.5521, lr_0 = 5.2654e-04
Validation auc = 0.799878
Epoch 28
Loss = 3.2883e-01, PNorm = 71.6920, GNorm = 0.9181, lr_0 = 5.1978e-04
Loss = 3.9822e-01, PNorm = 71.8800, GNorm = 0.8529, lr_0 = 5.1371e-04
Validation auc = 0.805970
Epoch 29
Loss = 3.6227e-01, PNorm = 72.0846, GNorm = 0.6317, lr_0 = 5.0771e-04
Loss = 3.6869e-01, PNorm = 72.2834, GNorm = 0.7813, lr_0 = 5.0178e-04
Validation auc = 0.793482
Epoch 30
Loss = 3.5435e-01, PNorm = 72.4601, GNorm = 1.1290, lr_0 = 4.9592e-04
Loss = 3.7277e-01, PNorm = 72.6263, GNorm = 1.4660, lr_0 = 4.9012e-04
Validation auc = 0.816327
Epoch 31
Loss = 3.2233e-01, PNorm = 72.7913, GNorm = 0.5277, lr_0 = 4.8440e-04
Loss = 3.5048e-01, PNorm = 72.9705, GNorm = 1.1111, lr_0 = 4.7874e-04
Validation auc = 0.808102
Epoch 32
Loss = 3.3444e-01, PNorm = 73.1265, GNorm = 0.9222, lr_0 = 4.7315e-04
Loss = 3.4939e-01, PNorm = 73.2783, GNorm = 1.5378, lr_0 = 4.6763e-04
Validation auc = 0.822419
Epoch 33
Loss = 3.0799e-01, PNorm = 73.4360, GNorm = 0.5779, lr_0 = 4.6216e-04
Loss = 3.2357e-01, PNorm = 73.6055, GNorm = 0.5769, lr_0 = 4.5677e-04
Validation auc = 0.816327
Epoch 34
Loss = 3.5805e-01, PNorm = 73.7787, GNorm = 0.7643, lr_0 = 4.5090e-04
Loss = 2.7706e-01, PNorm = 73.9376, GNorm = 0.5140, lr_0 = 4.4564e-04
Validation auc = 0.814499
Epoch 35
Loss = 2.7939e-01, PNorm = 74.0909, GNorm = 0.6693, lr_0 = 4.4043e-04
Loss = 3.1337e-01, PNorm = 74.2475, GNorm = 1.2306, lr_0 = 4.3529e-04
Validation auc = 0.831861
Epoch 36
Loss = 3.8447e-01, PNorm = 74.3975, GNorm = 1.2104, lr_0 = 4.3020e-04
Loss = 3.2512e-01, PNorm = 74.5548, GNorm = 1.0630, lr_0 = 4.2518e-04
Loss = 2.9208e-01, PNorm = 74.7082, GNorm = 0.9568, lr_0 = 4.2021e-04
Validation auc = 0.805666
Epoch 37
Loss = 3.0553e-01, PNorm = 74.8645, GNorm = 0.9807, lr_0 = 4.1531e-04
Loss = 2.7668e-01, PNorm = 75.0110, GNorm = 0.7353, lr_0 = 4.1045e-04
Validation auc = 0.805666
Epoch 38
Loss = 3.1762e-01, PNorm = 75.1693, GNorm = 0.8418, lr_0 = 4.0566e-04
Loss = 2.6961e-01, PNorm = 75.3221, GNorm = 0.6048, lr_0 = 4.0092e-04
Validation auc = 0.807189
Epoch 39
Loss = 2.6574e-01, PNorm = 75.4795, GNorm = 0.9452, lr_0 = 3.9578e-04
Loss = 2.2643e-01, PNorm = 75.6259, GNorm = 0.7610, lr_0 = 3.9115e-04
Validation auc = 0.823332
Epoch 40
Loss = 2.4525e-01, PNorm = 75.7630, GNorm = 0.7582, lr_0 = 3.8658e-04
Loss = 2.6715e-01, PNorm = 75.9202, GNorm = 0.8435, lr_0 = 3.8207e-04
Validation auc = 0.796223
Epoch 41
Loss = 2.2109e-01, PNorm = 76.0740, GNorm = 0.6558, lr_0 = 3.7761e-04
Loss = 2.9128e-01, PNorm = 76.2232, GNorm = 0.8962, lr_0 = 3.7320e-04
Validation auc = 0.786171
Epoch 42
Loss = 2.4888e-01, PNorm = 76.3790, GNorm = 0.5676, lr_0 = 3.6884e-04
Loss = 2.4234e-01, PNorm = 76.5294, GNorm = 0.7261, lr_0 = 3.6453e-04
Validation auc = 0.809016
Epoch 43
Loss = 2.0008e-01, PNorm = 76.6711, GNorm = 0.4878, lr_0 = 3.6027e-04
Loss = 2.3754e-01, PNorm = 76.8153, GNorm = 1.0360, lr_0 = 3.5607e-04
Validation auc = 0.778861
Epoch 44
Loss = 2.7210e-01, PNorm = 76.9499, GNorm = 0.7947, lr_0 = 3.5191e-04
Loss = 2.1552e-01, PNorm = 77.0834, GNorm = 0.8216, lr_0 = 3.4780e-04
Validation auc = 0.803229
Epoch 45
Loss = 2.3189e-01, PNorm = 77.2163, GNorm = 1.1673, lr_0 = 3.4333e-04
Loss = 2.2880e-01, PNorm = 77.3440, GNorm = 0.9631, lr_0 = 3.3932e-04
Validation auc = 0.797137
Epoch 46
Loss = 2.4909e-01, PNorm = 77.4685, GNorm = 0.6999, lr_0 = 3.3536e-04
Loss = 2.1698e-01, PNorm = 77.5959, GNorm = 0.8799, lr_0 = 3.3144e-04
Validation auc = 0.791959
Epoch 47
Loss = 2.6699e-01, PNorm = 77.7117, GNorm = 0.9623, lr_0 = 3.2757e-04
Loss = 2.0365e-01, PNorm = 77.8383, GNorm = 1.1900, lr_0 = 3.2375e-04
Validation auc = 0.805666
Epoch 48
Loss = 1.7775e-01, PNorm = 77.9536, GNorm = 0.9629, lr_0 = 3.1996e-04
Loss = 2.0516e-01, PNorm = 78.0611, GNorm = 1.1943, lr_0 = 3.1623e-04
Loss = 1.8786e-01, PNorm = 78.1690, GNorm = 0.9202, lr_0 = 3.1253e-04
Validation auc = 0.812976
Epoch 49
Loss = 1.7967e-01, PNorm = 78.2782, GNorm = 0.8894, lr_0 = 3.0888e-04
Loss = 2.1011e-01, PNorm = 78.3850, GNorm = 1.5537, lr_0 = 3.0528e-04
Validation auc = 0.792263
Epoch 50
Loss = 1.9860e-01, PNorm = 78.5010, GNorm = 0.6227, lr_0 = 3.0171e-04
Loss = 1.9294e-01, PNorm = 78.6193, GNorm = 0.9004, lr_0 = 2.9819e-04
Validation auc = 0.784648
Epoch 51
Loss = 1.7174e-01, PNorm = 78.7393, GNorm = 1.0962, lr_0 = 2.9436e-04
Loss = 1.7990e-01, PNorm = 78.8375, GNorm = 0.6089, lr_0 = 2.9092e-04
Validation auc = 0.783734
Epoch 52
Loss = 1.4942e-01, PNorm = 78.9389, GNorm = 0.7076, lr_0 = 2.8752e-04
Loss = 1.7129e-01, PNorm = 79.0546, GNorm = 0.6894, lr_0 = 2.8417e-04
Validation auc = 0.784039
Epoch 53
Loss = 1.6717e-01, PNorm = 79.1495, GNorm = 0.6170, lr_0 = 2.8085e-04
Loss = 1.4598e-01, PNorm = 79.2460, GNorm = 0.6362, lr_0 = 2.7757e-04
Validation auc = 0.796223
Epoch 54
Loss = 1.6065e-01, PNorm = 79.3420, GNorm = 0.7747, lr_0 = 2.7432e-04
Loss = 1.4892e-01, PNorm = 79.4301, GNorm = 1.2068, lr_0 = 2.7112e-04
Validation auc = 0.780993
Epoch 55
Loss = 1.5662e-01, PNorm = 79.5063, GNorm = 1.1422, lr_0 = 2.6795e-04
Loss = 1.5744e-01, PNorm = 79.5861, GNorm = 0.9784, lr_0 = 2.6483e-04
Validation auc = 0.777947
Epoch 56
Loss = 1.6902e-01, PNorm = 79.6811, GNorm = 0.7342, lr_0 = 2.6142e-04
Loss = 1.3503e-01, PNorm = 79.7727, GNorm = 0.7465, lr_0 = 2.5837e-04
Validation auc = 0.791045
Epoch 57
Loss = 1.1805e-01, PNorm = 79.8689, GNorm = 0.5208, lr_0 = 2.5535e-04
Loss = 1.3406e-01, PNorm = 79.9561, GNorm = 1.0963, lr_0 = 2.5237e-04
Validation auc = 0.763935
Epoch 58
Loss = 1.7078e-01, PNorm = 80.0422, GNorm = 0.9916, lr_0 = 2.4942e-04
Loss = 1.3162e-01, PNorm = 80.1263, GNorm = 1.1122, lr_0 = 2.4651e-04
Validation auc = 0.782211
Epoch 59
Loss = 1.0932e-01, PNorm = 80.2131, GNorm = 0.8419, lr_0 = 2.4363e-04
Loss = 1.2203e-01, PNorm = 80.3022, GNorm = 0.7201, lr_0 = 2.4079e-04
Validation auc = 0.789217
Epoch 60
Loss = 8.1897e-02, PNorm = 80.3847, GNorm = 0.5107, lr_0 = 2.3797e-04
Loss = 1.2548e-01, PNorm = 80.4640, GNorm = 0.8869, lr_0 = 2.3520e-04
Loss = 1.4397e-01, PNorm = 80.5387, GNorm = 1.0774, lr_0 = 2.3245e-04
Validation auc = 0.768504
Epoch 61
Loss = 1.3462e-01, PNorm = 80.6231, GNorm = 0.6369, lr_0 = 2.2973e-04
Loss = 1.4264e-01, PNorm = 80.6965, GNorm = 1.0169, lr_0 = 2.2705e-04
Loss = 8.6517e-02, PNorm = 80.7037, GNorm = 0.6290, lr_0 = 2.2678e-04
Validation auc = 0.774596
Epoch 62
Loss = 1.1342e-01, PNorm = 80.7657, GNorm = 0.6661, lr_0 = 2.2414e-04
Loss = 1.4226e-01, PNorm = 80.8315, GNorm = 1.1525, lr_0 = 2.2152e-04
Validation auc = 0.800487
Epoch 63
Loss = 1.3933e-01, PNorm = 80.8930, GNorm = 1.2163, lr_0 = 2.1893e-04
Loss = 1.4843e-01, PNorm = 80.9588, GNorm = 0.4802, lr_0 = 2.1637e-04
Validation auc = 0.785562
Epoch 64
Loss = 1.3437e-01, PNorm = 81.0255, GNorm = 1.5919, lr_0 = 2.1385e-04
Loss = 1.2618e-01, PNorm = 81.0949, GNorm = 0.6539, lr_0 = 2.1135e-04
Validation auc = 0.777642
Epoch 65
Loss = 1.1689e-01, PNorm = 81.1566, GNorm = 1.2954, lr_0 = 2.0888e-04
Loss = 1.1357e-01, PNorm = 81.2221, GNorm = 0.8185, lr_0 = 2.0644e-04
Validation auc = 0.778252
Epoch 66
Loss = 8.8612e-02, PNorm = 81.2835, GNorm = 0.7687, lr_0 = 2.0403e-04
Loss = 1.1056e-01, PNorm = 81.3316, GNorm = 1.5697, lr_0 = 2.0165e-04
Validation auc = 0.773683
Epoch 67
Loss = 1.0177e-01, PNorm = 81.3879, GNorm = 0.5411, lr_0 = 1.9906e-04
Loss = 8.6223e-02, PNorm = 81.4416, GNorm = 0.5487, lr_0 = 1.9673e-04
Validation auc = 0.766372
Epoch 68
Loss = 9.9469e-02, PNorm = 81.4944, GNorm = 1.7497, lr_0 = 1.9444e-04
Loss = 1.2261e-01, PNorm = 81.5482, GNorm = 1.4147, lr_0 = 1.9216e-04
Validation auc = 0.783734
Epoch 69
Loss = 1.0621e-01, PNorm = 81.6038, GNorm = 0.8197, lr_0 = 1.8992e-04
Loss = 9.6025e-02, PNorm = 81.6526, GNorm = 0.8521, lr_0 = 1.8770e-04
Validation auc = 0.796832
Epoch 70
Loss = 9.5399e-02, PNorm = 81.7001, GNorm = 0.6236, lr_0 = 1.8551e-04
Loss = 8.5793e-02, PNorm = 81.7498, GNorm = 0.7712, lr_0 = 1.8334e-04
Validation auc = 0.787085
Epoch 71
Loss = 6.9801e-02, PNorm = 81.7968, GNorm = 0.7593, lr_0 = 1.8120e-04
Loss = 9.2946e-02, PNorm = 81.8459, GNorm = 0.5280, lr_0 = 1.7909e-04
Validation auc = 0.776119
Epoch 72
Loss = 9.3414e-02, PNorm = 81.8881, GNorm = 0.7157, lr_0 = 1.7699e-04
Loss = 8.2547e-02, PNorm = 81.9267, GNorm = 0.9681, lr_0 = 1.7493e-04
Validation auc = 0.760585
Epoch 73
Loss = 6.3566e-02, PNorm = 81.9742, GNorm = 0.6726, lr_0 = 1.7268e-04
Loss = 8.7459e-02, PNorm = 82.0217, GNorm = 0.7315, lr_0 = 1.7066e-04
Loss = 1.1337e-01, PNorm = 82.0629, GNorm = 0.8105, lr_0 = 1.6867e-04
Validation auc = 0.764849
Epoch 74
Loss = 8.8911e-02, PNorm = 82.1074, GNorm = 0.9516, lr_0 = 1.6670e-04
Loss = 9.3689e-02, PNorm = 82.1457, GNorm = 0.6929, lr_0 = 1.6475e-04
Validation auc = 0.776424
Epoch 75
Loss = 9.8755e-02, PNorm = 82.1820, GNorm = 0.6962, lr_0 = 1.6283e-04
Loss = 9.2698e-02, PNorm = 82.2162, GNorm = 0.5384, lr_0 = 1.6093e-04
Validation auc = 0.774901
Epoch 76
Loss = 8.8715e-02, PNorm = 82.2558, GNorm = 0.8352, lr_0 = 1.5905e-04
Loss = 8.0835e-02, PNorm = 82.2927, GNorm = 1.2720, lr_0 = 1.5719e-04
Validation auc = 0.767591
Epoch 77
Loss = 6.9680e-02, PNorm = 82.3288, GNorm = 0.6897, lr_0 = 1.5536e-04
Loss = 7.2259e-02, PNorm = 82.3632, GNorm = 1.1670, lr_0 = 1.5354e-04
Validation auc = 0.752361
Epoch 78
Loss = 6.6494e-02, PNorm = 82.4026, GNorm = 0.5987, lr_0 = 1.5157e-04
Loss = 9.7919e-02, PNorm = 82.4372, GNorm = 0.8068, lr_0 = 1.4980e-04
Validation auc = 0.762412
Epoch 79
Loss = 5.4685e-02, PNorm = 82.4641, GNorm = 0.3103, lr_0 = 1.4805e-04
Loss = 8.5393e-02, PNorm = 82.4992, GNorm = 0.8901, lr_0 = 1.4632e-04
Validation auc = 0.778252
Epoch 80
Loss = 6.3399e-02, PNorm = 82.5317, GNorm = 1.0712, lr_0 = 1.4461e-04
Loss = 7.0675e-02, PNorm = 82.5629, GNorm = 1.3157, lr_0 = 1.4292e-04
Validation auc = 0.776424
Epoch 81
Loss = 1.0481e-01, PNorm = 82.5881, GNorm = 1.1469, lr_0 = 1.4125e-04
Loss = 7.5182e-02, PNorm = 82.6231, GNorm = 0.5610, lr_0 = 1.3960e-04
Validation auc = 0.760280
Epoch 82
Loss = 6.9461e-02, PNorm = 82.6580, GNorm = 0.6654, lr_0 = 1.3797e-04
Loss = 6.6218e-02, PNorm = 82.6866, GNorm = 0.5870, lr_0 = 1.3636e-04
Validation auc = 0.763022
Epoch 83
Loss = 9.2942e-02, PNorm = 82.7148, GNorm = 1.0467, lr_0 = 1.3477e-04
Loss = 5.1684e-02, PNorm = 82.7400, GNorm = 0.3480, lr_0 = 1.3320e-04
Validation auc = 0.765458
Epoch 84
Loss = 7.2711e-02, PNorm = 82.7698, GNorm = 0.5672, lr_0 = 1.3149e-04
Loss = 6.5766e-02, PNorm = 82.8016, GNorm = 0.7255, lr_0 = 1.2995e-04
Validation auc = 0.765154
Epoch 85
Loss = 4.1936e-02, PNorm = 82.8295, GNorm = 0.4630, lr_0 = 1.2843e-04
Loss = 6.6101e-02, PNorm = 82.8546, GNorm = 0.4965, lr_0 = 1.2693e-04
Loss = 7.5254e-02, PNorm = 82.8805, GNorm = 1.2550, lr_0 = 1.2545e-04
Validation auc = 0.767591
Epoch 86
Loss = 5.4959e-02, PNorm = 82.9063, GNorm = 0.5472, lr_0 = 1.2398e-04
Loss = 5.7309e-02, PNorm = 82.9306, GNorm = 0.5369, lr_0 = 1.2254e-04
Validation auc = 0.762108
Epoch 87
Loss = 6.4271e-02, PNorm = 82.9558, GNorm = 1.4912, lr_0 = 1.2111e-04
Loss = 6.1358e-02, PNorm = 82.9777, GNorm = 0.5803, lr_0 = 1.1969e-04
Validation auc = 0.760889
Epoch 88
Loss = 6.1380e-02, PNorm = 82.9971, GNorm = 0.7112, lr_0 = 1.1829e-04
Loss = 5.3331e-02, PNorm = 83.0184, GNorm = 0.4705, lr_0 = 1.1691e-04
Validation auc = 0.764240
Epoch 89
Loss = 7.0145e-02, PNorm = 83.0432, GNorm = 0.7129, lr_0 = 1.1541e-04
Loss = 6.3805e-02, PNorm = 83.0674, GNorm = 0.5265, lr_0 = 1.1406e-04
Validation auc = 0.758757
Epoch 90
Loss = 5.3691e-02, PNorm = 83.0918, GNorm = 0.4386, lr_0 = 1.1273e-04
Loss = 5.3551e-02, PNorm = 83.1171, GNorm = 0.6533, lr_0 = 1.1141e-04
Validation auc = 0.765154
Epoch 91
Loss = 6.1119e-02, PNorm = 83.1416, GNorm = 0.6866, lr_0 = 1.1011e-04
Loss = 6.0551e-02, PNorm = 83.1622, GNorm = 0.5437, lr_0 = 1.0883e-04
Validation auc = 0.752361
Epoch 92
Loss = 5.2874e-02, PNorm = 83.1828, GNorm = 0.6714, lr_0 = 1.0756e-04
Loss = 4.8475e-02, PNorm = 83.2036, GNorm = 0.8928, lr_0 = 1.0630e-04
Validation auc = 0.763022
Epoch 93
Loss = 3.8283e-02, PNorm = 83.2230, GNorm = 0.7049, lr_0 = 1.0506e-04
Loss = 6.5184e-02, PNorm = 83.2429, GNorm = 1.2967, lr_0 = 1.0383e-04
Validation auc = 0.752970
Epoch 94
Loss = 8.6334e-02, PNorm = 83.2649, GNorm = 0.8617, lr_0 = 1.0262e-04
Loss = 5.3641e-02, PNorm = 83.2842, GNorm = 0.7849, lr_0 = 1.0142e-04
Validation auc = 0.757539
Epoch 95
Loss = 3.3080e-02, PNorm = 83.3012, GNorm = 0.1734, lr_0 = 1.0012e-04
Loss = 4.9782e-02, PNorm = 83.3190, GNorm = 1.1680, lr_0 = 1.0000e-04
Validation auc = 0.770332
Epoch 96
Loss = 5.0989e-02, PNorm = 83.3376, GNorm = 1.0081, lr_0 = 1.0000e-04
Loss = 4.5289e-02, PNorm = 83.3550, GNorm = 0.8995, lr_0 = 1.0000e-04
Validation auc = 0.766068
Epoch 97
Loss = 6.7710e-02, PNorm = 83.3721, GNorm = 0.9072, lr_0 = 1.0000e-04
Loss = 4.5081e-02, PNorm = 83.3908, GNorm = 0.6973, lr_0 = 1.0000e-04
Loss = 4.7626e-02, PNorm = 83.4061, GNorm = 1.0071, lr_0 = 1.0000e-04
Validation auc = 0.753274
Epoch 98
Loss = 5.7829e-02, PNorm = 83.4241, GNorm = 0.7977, lr_0 = 1.0000e-04
Loss = 5.8722e-02, PNorm = 83.4423, GNorm = 0.4603, lr_0 = 1.0000e-04
Validation auc = 0.760280
Epoch 99
Loss = 4.2159e-02, PNorm = 83.4634, GNorm = 0.7926, lr_0 = 1.0000e-04
Loss = 5.0069e-02, PNorm = 83.4820, GNorm = 0.4602, lr_0 = 1.0000e-04
Validation auc = 0.765763
Model 0 best validation auc = 0.831861 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.802289
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 4,900,801
Moving model to cuda
Epoch 0
Loss = 7.1951e-01, PNorm = 63.4373, GNorm = 2.0152, lr_0 = 3.4750e-04
Loss = 6.7355e-01, PNorm = 63.4787, GNorm = 0.6321, lr_0 = 5.7250e-04
Loss = 6.8976e-01, PNorm = 63.4844, GNorm = 1.7553, lr_0 = 5.9500e-04
Validation auc = 0.703320
Epoch 1
Loss = 6.3771e-01, PNorm = 63.5564, GNorm = 0.6041, lr_0 = 8.2000e-04
Loss = 6.4985e-01, PNorm = 63.6444, GNorm = 1.2866, lr_0 = 9.9765e-04
Validation auc = 0.738958
Epoch 2
Loss = 6.2886e-01, PNorm = 63.7327, GNorm = 0.6112, lr_0 = 9.8600e-04
Loss = 6.7198e-01, PNorm = 63.8199, GNorm = 1.1861, lr_0 = 9.7449e-04
Validation auc = 0.748705
Epoch 3
Loss = 6.2340e-01, PNorm = 63.9083, GNorm = 0.5420, lr_0 = 9.6310e-04
Loss = 6.0771e-01, PNorm = 63.9966, GNorm = 0.4679, lr_0 = 9.5186e-04
Validation auc = 0.757234
Epoch 4
Loss = 6.1539e-01, PNorm = 64.1026, GNorm = 0.7198, lr_0 = 9.4074e-04
Loss = 5.9516e-01, PNorm = 64.1743, GNorm = 0.4460, lr_0 = 9.2975e-04
Validation auc = 0.760585
Epoch 5
Loss = 6.0880e-01, PNorm = 64.2649, GNorm = 0.6640, lr_0 = 9.1889e-04
Loss = 5.9648e-01, PNorm = 64.3497, GNorm = 0.6535, lr_0 = 9.0816e-04
Validation auc = 0.790740
Epoch 6
Loss = 5.5481e-01, PNorm = 64.4533, GNorm = 0.8734, lr_0 = 8.9650e-04
Loss = 6.0600e-01, PNorm = 64.5496, GNorm = 0.5551, lr_0 = 8.8603e-04
Validation auc = 0.783125
Epoch 7
Loss = 5.3726e-01, PNorm = 64.6672, GNorm = 0.7548, lr_0 = 8.7568e-04
Loss = 5.4538e-01, PNorm = 64.7774, GNorm = 0.9009, lr_0 = 8.6546e-04
Validation auc = 0.763935
Epoch 8
Loss = 5.6521e-01, PNorm = 64.8903, GNorm = 0.6540, lr_0 = 8.5535e-04
Loss = 5.5173e-01, PNorm = 65.0603, GNorm = 0.6734, lr_0 = 8.4536e-04
Validation auc = 0.785257
Epoch 9
Loss = 5.8493e-01, PNorm = 65.1659, GNorm = 0.6207, lr_0 = 8.3549e-04
Loss = 5.4245e-01, PNorm = 65.3014, GNorm = 0.8898, lr_0 = 8.2573e-04
Validation auc = 0.769418
Epoch 10
Loss = 6.7409e-01, PNorm = 65.4338, GNorm = 1.1141, lr_0 = 8.1608e-04
Loss = 5.2619e-01, PNorm = 65.5897, GNorm = 0.6011, lr_0 = 8.0655e-04
Validation auc = 0.788303
Epoch 11
Loss = 3.9843e-01, PNorm = 65.7201, GNorm = 0.4582, lr_0 = 7.9713e-04
Loss = 5.3737e-01, PNorm = 65.8644, GNorm = 0.7106, lr_0 = 7.8782e-04
Validation auc = 0.778556
Epoch 12
Loss = 4.8051e-01, PNorm = 66.0437, GNorm = 0.5561, lr_0 = 7.7771e-04
Loss = 5.1744e-01, PNorm = 66.2019, GNorm = 0.8688, lr_0 = 7.6862e-04
Loss = 5.2581e-01, PNorm = 66.3839, GNorm = 1.6243, lr_0 = 7.5965e-04
Validation auc = 0.782821
Epoch 13
Loss = 4.9722e-01, PNorm = 66.5513, GNorm = 0.4790, lr_0 = 7.5078e-04
Loss = 5.1230e-01, PNorm = 66.7269, GNorm = 0.9545, lr_0 = 7.4201e-04
Validation auc = 0.766372
Epoch 14
Loss = 4.8954e-01, PNorm = 66.8997, GNorm = 0.5825, lr_0 = 7.3334e-04
Loss = 5.1845e-01, PNorm = 67.0724, GNorm = 0.6319, lr_0 = 7.2478e-04
Validation auc = 0.773987
Epoch 15
Loss = 5.0570e-01, PNorm = 67.2429, GNorm = 0.6288, lr_0 = 7.1631e-04
Loss = 4.8473e-01, PNorm = 67.4141, GNorm = 0.5985, lr_0 = 7.0795e-04
Validation auc = 0.782516
Epoch 16
Loss = 4.6682e-01, PNorm = 67.5991, GNorm = 0.5942, lr_0 = 6.9968e-04
Loss = 4.8171e-01, PNorm = 67.7909, GNorm = 0.7511, lr_0 = 6.9151e-04
Validation auc = 0.773378
Epoch 17
Loss = 4.8174e-01, PNorm = 67.9946, GNorm = 1.0735, lr_0 = 6.8263e-04
Loss = 4.6627e-01, PNorm = 68.1991, GNorm = 0.6171, lr_0 = 6.7465e-04
Validation auc = 0.797137
Epoch 18
Loss = 4.2524e-01, PNorm = 68.3979, GNorm = 0.5589, lr_0 = 6.6678e-04
Loss = 4.8195e-01, PNorm = 68.5722, GNorm = 0.6068, lr_0 = 6.5899e-04
Validation auc = 0.808407
Epoch 19
Loss = 3.9760e-01, PNorm = 68.7572, GNorm = 0.6202, lr_0 = 6.5129e-04
Loss = 4.4132e-01, PNorm = 68.9565, GNorm = 0.6087, lr_0 = 6.4369e-04
Validation auc = 0.775206
Epoch 20
Loss = 4.2060e-01, PNorm = 69.1377, GNorm = 0.6495, lr_0 = 6.3617e-04
Loss = 4.3916e-01, PNorm = 69.3278, GNorm = 0.6936, lr_0 = 6.2874e-04
Validation auc = 0.796528
Epoch 21
Loss = 3.9230e-01, PNorm = 69.5214, GNorm = 0.5895, lr_0 = 6.2139e-04
Loss = 4.2563e-01, PNorm = 69.7161, GNorm = 0.8111, lr_0 = 6.1414e-04
Validation auc = 0.783430
Epoch 22
Loss = 4.4500e-01, PNorm = 69.8949, GNorm = 0.7128, lr_0 = 6.0696e-04
Loss = 4.2277e-01, PNorm = 70.1035, GNorm = 1.1788, lr_0 = 5.9988e-04
Validation auc = 0.789522
Epoch 23
Loss = 4.9018e-01, PNorm = 70.3095, GNorm = 0.8581, lr_0 = 5.9217e-04
Loss = 4.1560e-01, PNorm = 70.4784, GNorm = 0.9981, lr_0 = 5.8526e-04
Validation auc = 0.798964
Epoch 24
Loss = 3.0777e-01, PNorm = 70.6854, GNorm = 0.5869, lr_0 = 5.7842e-04
Loss = 3.5876e-01, PNorm = 70.9135, GNorm = 0.8558, lr_0 = 5.7167e-04
Loss = 4.2163e-01, PNorm = 71.0978, GNorm = 0.7643, lr_0 = 5.6499e-04
Validation auc = 0.831252
Epoch 25
Loss = 3.7667e-01, PNorm = 71.3133, GNorm = 0.8994, lr_0 = 5.5839e-04
Loss = 3.8605e-01, PNorm = 71.4994, GNorm = 0.7821, lr_0 = 5.5187e-04
Validation auc = 0.823332
Epoch 26
Loss = 3.5148e-01, PNorm = 71.6787, GNorm = 0.7670, lr_0 = 5.4542e-04
Loss = 4.1729e-01, PNorm = 71.8549, GNorm = 1.6119, lr_0 = 5.3905e-04
Validation auc = 0.798051
Epoch 27
Loss = 3.7674e-01, PNorm = 72.0292, GNorm = 0.9854, lr_0 = 5.3276e-04
Loss = 3.8886e-01, PNorm = 72.2068, GNorm = 1.1832, lr_0 = 5.2654e-04
Validation auc = 0.827597
Epoch 28
Loss = 3.7121e-01, PNorm = 72.3974, GNorm = 1.1505, lr_0 = 5.1978e-04
Loss = 3.4970e-01, PNorm = 72.5724, GNorm = 1.1055, lr_0 = 5.1371e-04
Validation auc = 0.812976
Epoch 29
Loss = 3.2495e-01, PNorm = 72.7426, GNorm = 0.6988, lr_0 = 5.0771e-04
Loss = 3.3677e-01, PNorm = 72.9152, GNorm = 1.0439, lr_0 = 5.0178e-04
Validation auc = 0.812976
Epoch 30
Loss = 2.6847e-01, PNorm = 73.0714, GNorm = 0.5682, lr_0 = 4.9592e-04
Loss = 3.5507e-01, PNorm = 73.2505, GNorm = 1.1492, lr_0 = 4.9012e-04
Validation auc = 0.808407
Epoch 31
Loss = 3.3690e-01, PNorm = 73.4337, GNorm = 0.7020, lr_0 = 4.8440e-04
Loss = 3.4298e-01, PNorm = 73.6323, GNorm = 1.0827, lr_0 = 4.7874e-04
Validation auc = 0.810844
Epoch 32
Loss = 3.5064e-01, PNorm = 73.7897, GNorm = 1.2485, lr_0 = 4.7315e-04
Loss = 3.2459e-01, PNorm = 73.9596, GNorm = 0.7113, lr_0 = 4.6763e-04
Validation auc = 0.805056
Epoch 33
Loss = 3.2941e-01, PNorm = 74.1036, GNorm = 0.7600, lr_0 = 4.6216e-04
Loss = 2.9009e-01, PNorm = 74.2663, GNorm = 1.0479, lr_0 = 4.5677e-04
Validation auc = 0.810235
Epoch 34
Loss = 3.4816e-01, PNorm = 74.4336, GNorm = 1.4764, lr_0 = 4.5090e-04
Loss = 2.6290e-01, PNorm = 74.5930, GNorm = 0.6326, lr_0 = 4.4564e-04
Validation auc = 0.815717
Epoch 35
Loss = 3.1208e-01, PNorm = 74.7365, GNorm = 0.7992, lr_0 = 4.4043e-04
Loss = 2.7971e-01, PNorm = 74.8961, GNorm = 1.3492, lr_0 = 4.3529e-04
Validation auc = 0.807189
Epoch 36
Loss = 3.6152e-01, PNorm = 75.0432, GNorm = 1.1676, lr_0 = 4.3020e-04
Loss = 2.8322e-01, PNorm = 75.1921, GNorm = 0.6101, lr_0 = 4.2518e-04
Loss = 2.5904e-01, PNorm = 75.3340, GNorm = 1.0760, lr_0 = 4.2021e-04
Validation auc = 0.813585
Epoch 37
Loss = 2.4650e-01, PNorm = 75.4794, GNorm = 1.0874, lr_0 = 4.1531e-04
Loss = 2.7723e-01, PNorm = 75.6254, GNorm = 1.0768, lr_0 = 4.1045e-04
Validation auc = 0.798660
Epoch 38
Loss = 2.5725e-01, PNorm = 75.7836, GNorm = 0.6508, lr_0 = 4.0566e-04
Loss = 2.6381e-01, PNorm = 75.9240, GNorm = 1.5670, lr_0 = 4.0092e-04
Validation auc = 0.798660
Epoch 39
Loss = 2.6236e-01, PNorm = 76.1095, GNorm = 1.0211, lr_0 = 3.9578e-04
Loss = 2.3722e-01, PNorm = 76.2685, GNorm = 0.6778, lr_0 = 3.9115e-04
Validation auc = 0.810539
Epoch 40
Loss = 2.4814e-01, PNorm = 76.4124, GNorm = 0.7755, lr_0 = 3.8658e-04
Loss = 2.2911e-01, PNorm = 76.5528, GNorm = 0.4898, lr_0 = 3.8207e-04
Validation auc = 0.805056
Epoch 41
Loss = 2.2203e-01, PNorm = 76.6910, GNorm = 0.8966, lr_0 = 3.7761e-04
Loss = 2.4230e-01, PNorm = 76.8373, GNorm = 0.9189, lr_0 = 3.7320e-04
Validation auc = 0.797441
Epoch 42
Loss = 2.1222e-01, PNorm = 76.9710, GNorm = 1.0607, lr_0 = 3.6884e-04
Loss = 2.2478e-01, PNorm = 77.1157, GNorm = 1.0263, lr_0 = 3.6453e-04
Validation auc = 0.783430
Epoch 43
Loss = 1.8515e-01, PNorm = 77.2563, GNorm = 1.0667, lr_0 = 3.6027e-04
Loss = 2.3380e-01, PNorm = 77.3962, GNorm = 0.7604, lr_0 = 3.5607e-04
Validation auc = 0.798660
Epoch 44
Loss = 2.2925e-01, PNorm = 77.5372, GNorm = 1.5675, lr_0 = 3.5191e-04
Loss = 2.0126e-01, PNorm = 77.6698, GNorm = 0.7657, lr_0 = 3.4780e-04
Validation auc = 0.791959
Epoch 45
Loss = 2.2436e-01, PNorm = 77.8176, GNorm = 1.4736, lr_0 = 3.4333e-04
Loss = 2.1350e-01, PNorm = 77.9537, GNorm = 0.8590, lr_0 = 3.3932e-04
Validation auc = 0.788303
Epoch 46
Loss = 2.9052e-01, PNorm = 78.0645, GNorm = 1.4128, lr_0 = 3.3536e-04
Loss = 2.1931e-01, PNorm = 78.1876, GNorm = 0.7398, lr_0 = 3.3144e-04
Validation auc = 0.790131
Epoch 47
Loss = 1.5435e-01, PNorm = 78.3034, GNorm = 0.5017, lr_0 = 3.2757e-04
Loss = 2.0167e-01, PNorm = 78.4147, GNorm = 1.6491, lr_0 = 3.2375e-04
Validation auc = 0.787390
Epoch 48
Loss = 1.1764e-01, PNorm = 78.5168, GNorm = 0.4262, lr_0 = 3.1996e-04
Loss = 1.8614e-01, PNorm = 78.6273, GNorm = 0.8944, lr_0 = 3.1623e-04
Loss = 1.7115e-01, PNorm = 78.7322, GNorm = 0.8095, lr_0 = 3.1253e-04
Validation auc = 0.790131
Epoch 49
Loss = 1.7849e-01, PNorm = 78.8390, GNorm = 0.8499, lr_0 = 3.0888e-04
Loss = 1.7587e-01, PNorm = 78.9473, GNorm = 1.0473, lr_0 = 3.0528e-04
Validation auc = 0.766068
Epoch 50
Loss = 1.3881e-01, PNorm = 79.0526, GNorm = 1.1459, lr_0 = 3.0171e-04
Loss = 1.8231e-01, PNorm = 79.1517, GNorm = 0.7245, lr_0 = 2.9819e-04
Validation auc = 0.795614
Epoch 51
Loss = 1.8490e-01, PNorm = 79.2647, GNorm = 0.7934, lr_0 = 2.9436e-04
Loss = 1.6185e-01, PNorm = 79.3676, GNorm = 0.7612, lr_0 = 2.9092e-04
Validation auc = 0.768504
Epoch 52
Loss = 1.4787e-01, PNorm = 79.4563, GNorm = 0.9535, lr_0 = 2.8752e-04
Loss = 1.4477e-01, PNorm = 79.5432, GNorm = 0.8261, lr_0 = 2.8417e-04
Validation auc = 0.781298
Epoch 53
Loss = 1.2530e-01, PNorm = 79.6382, GNorm = 0.5691, lr_0 = 2.8085e-04
Loss = 1.5697e-01, PNorm = 79.7302, GNorm = 1.1226, lr_0 = 2.7757e-04
Validation auc = 0.777033
Epoch 54
Loss = 1.5352e-01, PNorm = 79.8309, GNorm = 1.0445, lr_0 = 2.7432e-04
Loss = 1.3450e-01, PNorm = 79.9187, GNorm = 1.1873, lr_0 = 2.7112e-04
Validation auc = 0.792568
Epoch 55
Loss = 1.4857e-01, PNorm = 80.0006, GNorm = 0.7353, lr_0 = 2.6795e-04
Loss = 1.5781e-01, PNorm = 80.0885, GNorm = 0.9824, lr_0 = 2.6483e-04
Validation auc = 0.780384
Epoch 56
Loss = 1.3307e-01, PNorm = 80.1819, GNorm = 0.6726, lr_0 = 2.6142e-04
Loss = 1.5901e-01, PNorm = 80.2690, GNorm = 0.7931, lr_0 = 2.5837e-04
Validation auc = 0.779775
Epoch 57
Loss = 1.1662e-01, PNorm = 80.3453, GNorm = 0.8378, lr_0 = 2.5535e-04
Loss = 1.1716e-01, PNorm = 80.4240, GNorm = 0.7821, lr_0 = 2.5237e-04
Validation auc = 0.765458
Epoch 58
Loss = 1.3539e-01, PNorm = 80.5049, GNorm = 1.2036, lr_0 = 2.4942e-04
Loss = 1.1540e-01, PNorm = 80.5738, GNorm = 0.8767, lr_0 = 2.4651e-04
Validation auc = 0.769723
Epoch 59
Loss = 1.4693e-01, PNorm = 80.6472, GNorm = 1.4497, lr_0 = 2.4363e-04
Loss = 1.1564e-01, PNorm = 80.7210, GNorm = 1.2500, lr_0 = 2.4079e-04
Validation auc = 0.752665
Epoch 60
Loss = 9.6652e-02, PNorm = 80.7963, GNorm = 0.6530, lr_0 = 2.3797e-04
Loss = 1.1436e-01, PNorm = 80.8700, GNorm = 0.6251, lr_0 = 2.3520e-04
Loss = 1.2783e-01, PNorm = 80.9377, GNorm = 0.9231, lr_0 = 2.3245e-04
Validation auc = 0.767895
Epoch 61
Loss = 1.1203e-01, PNorm = 81.0092, GNorm = 1.3109, lr_0 = 2.2973e-04
Loss = 1.3434e-01, PNorm = 81.0741, GNorm = 1.2198, lr_0 = 2.2705e-04
Loss = 1.0704e-01, PNorm = 81.0811, GNorm = 1.2723, lr_0 = 2.2678e-04
Validation auc = 0.767591
Epoch 62
Loss = 1.1606e-01, PNorm = 81.1355, GNorm = 0.6146, lr_0 = 2.2414e-04
Loss = 1.1715e-01, PNorm = 81.1932, GNorm = 0.6910, lr_0 = 2.2152e-04
Validation auc = 0.764240
Epoch 63
Loss = 1.0119e-01, PNorm = 81.2533, GNorm = 1.1721, lr_0 = 2.1893e-04
Loss = 1.2056e-01, PNorm = 81.3087, GNorm = 2.2048, lr_0 = 2.1637e-04
Validation auc = 0.779470
Epoch 64
Loss = 1.1174e-01, PNorm = 81.3740, GNorm = 0.7962, lr_0 = 2.1385e-04
Loss = 9.3686e-02, PNorm = 81.4302, GNorm = 0.9118, lr_0 = 2.1135e-04
Validation auc = 0.774596
Epoch 65
Loss = 8.9060e-02, PNorm = 81.4861, GNorm = 1.0644, lr_0 = 2.0888e-04
Loss = 1.1099e-01, PNorm = 81.5357, GNorm = 1.1677, lr_0 = 2.0644e-04
Validation auc = 0.758757
Epoch 66
Loss = 1.1615e-01, PNorm = 81.5828, GNorm = 0.6178, lr_0 = 2.0403e-04
Loss = 8.8514e-02, PNorm = 81.6337, GNorm = 0.5671, lr_0 = 2.0165e-04
Validation auc = 0.764545
Epoch 67
Loss = 9.8855e-02, PNorm = 81.6927, GNorm = 0.9085, lr_0 = 1.9906e-04
Loss = 9.9395e-02, PNorm = 81.7429, GNorm = 0.7844, lr_0 = 1.9673e-04
Validation auc = 0.748401
Epoch 68
Loss = 9.3580e-02, PNorm = 81.7949, GNorm = 1.7936, lr_0 = 1.9444e-04
Loss = 8.2031e-02, PNorm = 81.8419, GNorm = 0.9364, lr_0 = 1.9216e-04
Validation auc = 0.770027
Epoch 69
Loss = 6.7537e-02, PNorm = 81.8903, GNorm = 0.4697, lr_0 = 1.8992e-04
Loss = 1.1710e-01, PNorm = 81.9338, GNorm = 0.4237, lr_0 = 1.8770e-04
Validation auc = 0.773987
Epoch 70
Loss = 1.0796e-01, PNorm = 81.9868, GNorm = 0.7484, lr_0 = 1.8551e-04
Loss = 8.3942e-02, PNorm = 82.0395, GNorm = 0.4745, lr_0 = 1.8334e-04
Validation auc = 0.775510
Epoch 71
Loss = 8.2831e-02, PNorm = 82.0847, GNorm = 0.8771, lr_0 = 1.8120e-04
Loss = 9.0635e-02, PNorm = 82.1307, GNorm = 1.0907, lr_0 = 1.7909e-04
Validation auc = 0.766068
Epoch 72
Loss = 1.0167e-01, PNorm = 82.1678, GNorm = 0.9944, lr_0 = 1.7699e-04
Loss = 7.3732e-02, PNorm = 82.2109, GNorm = 0.8257, lr_0 = 1.7493e-04
Validation auc = 0.768504
Epoch 73
Loss = 6.6825e-02, PNorm = 82.2587, GNorm = 0.5982, lr_0 = 1.7268e-04
Loss = 9.1568e-02, PNorm = 82.2936, GNorm = 1.6697, lr_0 = 1.7066e-04
Loss = 8.2586e-02, PNorm = 82.3336, GNorm = 0.2440, lr_0 = 1.6867e-04
Validation auc = 0.770332
Epoch 74
Loss = 7.4559e-02, PNorm = 82.3766, GNorm = 0.5269, lr_0 = 1.6670e-04
Loss = 9.7579e-02, PNorm = 82.4113, GNorm = 1.0305, lr_0 = 1.6475e-04
Validation auc = 0.770027
Epoch 75
Loss = 6.1343e-02, PNorm = 82.4446, GNorm = 0.4593, lr_0 = 1.6283e-04
Loss = 9.0812e-02, PNorm = 82.4780, GNorm = 0.9461, lr_0 = 1.6093e-04
Validation auc = 0.764545
Epoch 76
Loss = 6.7616e-02, PNorm = 82.5154, GNorm = 0.7937, lr_0 = 1.5905e-04
Loss = 9.2469e-02, PNorm = 82.5480, GNorm = 0.7479, lr_0 = 1.5719e-04
Validation auc = 0.761194
Epoch 77
Loss = 6.8449e-02, PNorm = 82.5810, GNorm = 0.8488, lr_0 = 1.5536e-04
Loss = 7.1699e-02, PNorm = 82.6154, GNorm = 1.0450, lr_0 = 1.5354e-04
Validation auc = 0.761499
Epoch 78
Loss = 6.9292e-02, PNorm = 82.6524, GNorm = 0.6564, lr_0 = 1.5157e-04
Loss = 8.3709e-02, PNorm = 82.6845, GNorm = 0.5644, lr_0 = 1.4980e-04
Validation auc = 0.760889
Epoch 79
Loss = 7.1140e-02, PNorm = 82.7156, GNorm = 0.7996, lr_0 = 1.4805e-04
Loss = 9.2406e-02, PNorm = 82.7471, GNorm = 1.0840, lr_0 = 1.4632e-04
Validation auc = 0.766068
Epoch 80
Loss = 6.9300e-02, PNorm = 82.7751, GNorm = 0.8593, lr_0 = 1.4461e-04
Loss = 6.8712e-02, PNorm = 82.7997, GNorm = 0.7435, lr_0 = 1.4292e-04
Validation auc = 0.763631
Epoch 81
Loss = 8.1282e-02, PNorm = 82.8307, GNorm = 1.1487, lr_0 = 1.4125e-04
Loss = 6.6849e-02, PNorm = 82.8609, GNorm = 0.5706, lr_0 = 1.3960e-04
Validation auc = 0.768200
Epoch 82
Loss = 5.7340e-02, PNorm = 82.8887, GNorm = 1.0796, lr_0 = 1.3797e-04
Loss = 7.3616e-02, PNorm = 82.9171, GNorm = 0.8335, lr_0 = 1.3636e-04
Validation auc = 0.760585
Epoch 83
Loss = 4.1780e-02, PNorm = 82.9476, GNorm = 0.5118, lr_0 = 1.3477e-04
Loss = 5.8001e-02, PNorm = 82.9757, GNorm = 0.6053, lr_0 = 1.3320e-04
Validation auc = 0.759062
Epoch 84
Loss = 5.6438e-02, PNorm = 83.0018, GNorm = 0.6623, lr_0 = 1.3149e-04
Loss = 6.0692e-02, PNorm = 83.0270, GNorm = 0.5796, lr_0 = 1.2995e-04
Validation auc = 0.770027
Epoch 85
Loss = 7.3685e-02, PNorm = 83.0480, GNorm = 0.7990, lr_0 = 1.2843e-04
Loss = 6.6897e-02, PNorm = 83.0732, GNorm = 0.6757, lr_0 = 1.2693e-04
Loss = 5.0365e-02, PNorm = 83.0987, GNorm = 0.4428, lr_0 = 1.2545e-04
Validation auc = 0.758757
Epoch 86
Loss = 5.5800e-02, PNorm = 83.1217, GNorm = 0.9016, lr_0 = 1.2398e-04
Loss = 5.8760e-02, PNorm = 83.1431, GNorm = 0.8550, lr_0 = 1.2254e-04
Validation auc = 0.761194
Epoch 87
Loss = 5.0352e-02, PNorm = 83.1622, GNorm = 1.3951, lr_0 = 1.2111e-04
Loss = 5.9811e-02, PNorm = 83.1847, GNorm = 0.2086, lr_0 = 1.1969e-04
Validation auc = 0.759671
Epoch 88
Loss = 7.2351e-02, PNorm = 83.2030, GNorm = 1.0045, lr_0 = 1.1829e-04
Loss = 7.8261e-02, PNorm = 83.2275, GNorm = 0.9007, lr_0 = 1.1691e-04
Validation auc = 0.763326
Epoch 89
Loss = 6.5432e-02, PNorm = 83.2502, GNorm = 0.7509, lr_0 = 1.1541e-04
Loss = 5.9982e-02, PNorm = 83.2690, GNorm = 0.6675, lr_0 = 1.1406e-04
Validation auc = 0.766981
Epoch 90
Loss = 8.6688e-02, PNorm = 83.2941, GNorm = 0.5574, lr_0 = 1.1273e-04
Loss = 8.1549e-02, PNorm = 83.3154, GNorm = 1.9423, lr_0 = 1.1141e-04
Validation auc = 0.765154
Epoch 91
Loss = 7.1704e-02, PNorm = 83.3420, GNorm = 1.4621, lr_0 = 1.1011e-04
Loss = 6.6301e-02, PNorm = 83.3638, GNorm = 0.7972, lr_0 = 1.0883e-04
Validation auc = 0.759366
Epoch 92
Loss = 4.0507e-02, PNorm = 83.3834, GNorm = 0.2762, lr_0 = 1.0756e-04
Loss = 5.8887e-02, PNorm = 83.4051, GNorm = 0.9536, lr_0 = 1.0630e-04
Validation auc = 0.773683
Epoch 93
Loss = 5.3253e-02, PNorm = 83.4271, GNorm = 0.5431, lr_0 = 1.0506e-04
Loss = 5.7987e-02, PNorm = 83.4479, GNorm = 0.2451, lr_0 = 1.0383e-04
Validation auc = 0.767286
Epoch 94
Loss = 7.4826e-02, PNorm = 83.4680, GNorm = 0.9462, lr_0 = 1.0262e-04
Loss = 5.4812e-02, PNorm = 83.4894, GNorm = 1.1010, lr_0 = 1.0142e-04
Validation auc = 0.756625
Epoch 95
Loss = 3.7758e-02, PNorm = 83.5094, GNorm = 0.4697, lr_0 = 1.0012e-04
Loss = 4.7656e-02, PNorm = 83.5267, GNorm = 0.2539, lr_0 = 1.0000e-04
Validation auc = 0.756930
Epoch 96
Loss = 3.9972e-02, PNorm = 83.5428, GNorm = 0.8099, lr_0 = 1.0000e-04
Loss = 5.3895e-02, PNorm = 83.5601, GNorm = 0.8509, lr_0 = 1.0000e-04
Validation auc = 0.760280
Epoch 97
Loss = 2.6685e-02, PNorm = 83.5762, GNorm = 0.4143, lr_0 = 1.0000e-04
Loss = 5.1077e-02, PNorm = 83.5930, GNorm = 0.7529, lr_0 = 1.0000e-04
Loss = 5.9670e-02, PNorm = 83.6073, GNorm = 1.1245, lr_0 = 1.0000e-04
Validation auc = 0.759062
Epoch 98
Loss = 4.7261e-02, PNorm = 83.6258, GNorm = 1.6511, lr_0 = 1.0000e-04
Loss = 5.9392e-02, PNorm = 83.6434, GNorm = 1.0977, lr_0 = 1.0000e-04
Validation auc = 0.757539
Epoch 99
Loss = 5.3089e-02, PNorm = 83.6581, GNorm = 0.6019, lr_0 = 1.0000e-04
Loss = 5.1674e-02, PNorm = 83.6718, GNorm = 0.7159, lr_0 = 1.0000e-04
Validation auc = 0.763022
Model 1 best validation auc = 0.831252 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test auc = 0.790894
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 4,900,801
Moving model to cuda
Epoch 0
Loss = 7.0433e-01, PNorm = 63.3925, GNorm = 1.4777, lr_0 = 3.4750e-04
Loss = 6.7164e-01, PNorm = 63.4333, GNorm = 0.9855, lr_0 = 5.7250e-04
Loss = 7.2722e-01, PNorm = 63.4389, GNorm = 1.2592, lr_0 = 5.9500e-04
Validation auc = 0.689004
Epoch 1
Loss = 6.7005e-01, PNorm = 63.5080, GNorm = 1.1283, lr_0 = 8.2000e-04
Loss = 6.5822e-01, PNorm = 63.6026, GNorm = 0.4883, lr_0 = 9.9765e-04
Validation auc = 0.725251
Epoch 2
Loss = 6.2275e-01, PNorm = 63.7108, GNorm = 1.0797, lr_0 = 9.8600e-04
Loss = 6.2927e-01, PNorm = 63.8005, GNorm = 0.4261, lr_0 = 9.7449e-04
Validation auc = 0.744441
Epoch 3
Loss = 6.2078e-01, PNorm = 63.8683, GNorm = 0.6388, lr_0 = 9.6310e-04
Loss = 6.0983e-01, PNorm = 63.9393, GNorm = 0.6875, lr_0 = 9.5186e-04
Validation auc = 0.756625
Epoch 4
Loss = 5.9762e-01, PNorm = 64.0100, GNorm = 1.1209, lr_0 = 9.4074e-04
Loss = 6.2110e-01, PNorm = 64.0902, GNorm = 1.0596, lr_0 = 9.2975e-04
Validation auc = 0.766677
Epoch 5
Loss = 5.6237e-01, PNorm = 64.1681, GNorm = 0.5811, lr_0 = 9.1889e-04
Loss = 5.9398e-01, PNorm = 64.2607, GNorm = 0.5948, lr_0 = 9.0816e-04
Validation auc = 0.780993
Epoch 6
Loss = 5.9135e-01, PNorm = 64.3572, GNorm = 0.5925, lr_0 = 8.9650e-04
Loss = 5.7490e-01, PNorm = 64.4525, GNorm = 1.1573, lr_0 = 8.8603e-04
Validation auc = 0.780993
Epoch 7
Loss = 5.3714e-01, PNorm = 64.5526, GNorm = 1.0847, lr_0 = 8.7568e-04
Loss = 5.8968e-01, PNorm = 64.6634, GNorm = 1.1102, lr_0 = 8.6546e-04
Validation auc = 0.773987
Epoch 8
Loss = 6.1425e-01, PNorm = 64.7651, GNorm = 0.4711, lr_0 = 8.5535e-04
Loss = 5.4900e-01, PNorm = 64.9015, GNorm = 0.5461, lr_0 = 8.4536e-04
Validation auc = 0.764240
Epoch 9
Loss = 5.4965e-01, PNorm = 65.0015, GNorm = 0.4491, lr_0 = 8.3549e-04
Loss = 5.4390e-01, PNorm = 65.1288, GNorm = 0.8616, lr_0 = 8.2573e-04
Validation auc = 0.772160
Epoch 10
Loss = 5.0036e-01, PNorm = 65.2477, GNorm = 0.7621, lr_0 = 8.1608e-04
Loss = 5.2283e-01, PNorm = 65.3690, GNorm = 0.4313, lr_0 = 8.0655e-04
Validation auc = 0.786780
Epoch 11
Loss = 6.4632e-01, PNorm = 65.5033, GNorm = 1.0256, lr_0 = 7.9713e-04
Loss = 5.2455e-01, PNorm = 65.6650, GNorm = 0.5462, lr_0 = 7.8782e-04
Validation auc = 0.772464
Epoch 12
Loss = 6.3329e-01, PNorm = 65.8438, GNorm = 0.6942, lr_0 = 7.7771e-04
Loss = 5.1752e-01, PNorm = 65.9987, GNorm = 0.6308, lr_0 = 7.6862e-04
Loss = 5.4880e-01, PNorm = 66.1397, GNorm = 0.6155, lr_0 = 7.5965e-04
Validation auc = 0.775206
Epoch 13
Loss = 5.0486e-01, PNorm = 66.2831, GNorm = 0.7227, lr_0 = 7.5078e-04
Loss = 5.3270e-01, PNorm = 66.4257, GNorm = 0.9479, lr_0 = 7.4201e-04
Validation auc = 0.790131
Epoch 14
Loss = 5.2004e-01, PNorm = 66.5578, GNorm = 0.9099, lr_0 = 7.3334e-04
Loss = 5.2661e-01, PNorm = 66.7099, GNorm = 1.0205, lr_0 = 7.2478e-04
Validation auc = 0.797137
Epoch 15
Loss = 5.0572e-01, PNorm = 66.8764, GNorm = 0.5029, lr_0 = 7.1631e-04
Loss = 4.9751e-01, PNorm = 67.0344, GNorm = 0.5004, lr_0 = 7.0795e-04
Validation auc = 0.791959
Epoch 16
Loss = 5.1246e-01, PNorm = 67.1723, GNorm = 0.4982, lr_0 = 6.9968e-04
Loss = 4.5870e-01, PNorm = 67.3307, GNorm = 0.5463, lr_0 = 6.9151e-04
Validation auc = 0.779775
Epoch 17
Loss = 4.9358e-01, PNorm = 67.5484, GNorm = 0.9020, lr_0 = 6.8263e-04
Loss = 4.5671e-01, PNorm = 67.7405, GNorm = 0.6939, lr_0 = 6.7465e-04
Validation auc = 0.795918
Epoch 18
Loss = 4.2479e-01, PNorm = 67.9235, GNorm = 0.5373, lr_0 = 6.6678e-04
Loss = 4.7614e-01, PNorm = 68.1223, GNorm = 0.9746, lr_0 = 6.5899e-04
Validation auc = 0.808712
Epoch 19
Loss = 4.2703e-01, PNorm = 68.3270, GNorm = 0.6010, lr_0 = 6.5129e-04
Loss = 4.4083e-01, PNorm = 68.4951, GNorm = 1.4448, lr_0 = 6.4369e-04
Validation auc = 0.801097
Epoch 20
Loss = 4.4448e-01, PNorm = 68.6584, GNorm = 0.8111, lr_0 = 6.3617e-04
Loss = 4.3173e-01, PNorm = 68.8549, GNorm = 0.5241, lr_0 = 6.2874e-04
Validation auc = 0.787694
Epoch 21
Loss = 4.0913e-01, PNorm = 69.0401, GNorm = 0.5093, lr_0 = 6.2139e-04
Loss = 4.2301e-01, PNorm = 69.2263, GNorm = 1.1812, lr_0 = 6.1414e-04
Validation auc = 0.820896
Epoch 22
Loss = 4.9015e-01, PNorm = 69.4145, GNorm = 0.9511, lr_0 = 6.0696e-04
Loss = 3.9809e-01, PNorm = 69.6265, GNorm = 0.9729, lr_0 = 5.9988e-04
Validation auc = 0.798660
Epoch 23
Loss = 3.6136e-01, PNorm = 69.8319, GNorm = 0.5193, lr_0 = 5.9217e-04
Loss = 4.2244e-01, PNorm = 70.0347, GNorm = 0.6168, lr_0 = 5.8526e-04
Validation auc = 0.790131
Epoch 24
Loss = 3.4911e-01, PNorm = 70.2353, GNorm = 0.6801, lr_0 = 5.7842e-04
Loss = 3.9690e-01, PNorm = 70.4260, GNorm = 0.7902, lr_0 = 5.7167e-04
Loss = 3.9500e-01, PNorm = 70.6320, GNorm = 0.6597, lr_0 = 5.6499e-04
Validation auc = 0.812062
Epoch 25
Loss = 4.2206e-01, PNorm = 70.8344, GNorm = 0.5448, lr_0 = 5.5839e-04
Loss = 3.8337e-01, PNorm = 71.0497, GNorm = 0.8385, lr_0 = 5.5187e-04
Validation auc = 0.814804
Epoch 26
Loss = 3.9141e-01, PNorm = 71.2322, GNorm = 0.6698, lr_0 = 5.4542e-04
Loss = 3.6301e-01, PNorm = 71.4329, GNorm = 0.7862, lr_0 = 5.3905e-04
Validation auc = 0.815717
Epoch 27
Loss = 3.7338e-01, PNorm = 71.6297, GNorm = 0.8626, lr_0 = 5.3276e-04
Loss = 3.4333e-01, PNorm = 71.8042, GNorm = 0.7773, lr_0 = 5.2654e-04
Validation auc = 0.827901
Epoch 28
Loss = 3.3998e-01, PNorm = 71.9958, GNorm = 0.6764, lr_0 = 5.1978e-04
Loss = 3.8136e-01, PNorm = 72.1847, GNorm = 1.2081, lr_0 = 5.1371e-04
Validation auc = 0.802315
Epoch 29
Loss = 3.5004e-01, PNorm = 72.3707, GNorm = 0.5594, lr_0 = 5.0771e-04
Loss = 3.1510e-01, PNorm = 72.5736, GNorm = 1.1179, lr_0 = 5.0178e-04
Validation auc = 0.815108
Epoch 30
Loss = 3.4066e-01, PNorm = 72.7598, GNorm = 1.2636, lr_0 = 4.9592e-04
Loss = 3.5133e-01, PNorm = 72.9397, GNorm = 1.6518, lr_0 = 4.9012e-04
Validation auc = 0.813890
Epoch 31
Loss = 3.6005e-01, PNorm = 73.1181, GNorm = 0.6369, lr_0 = 4.8440e-04
Loss = 2.8987e-01, PNorm = 73.3113, GNorm = 0.5150, lr_0 = 4.7874e-04
Validation auc = 0.820286
Epoch 32
Loss = 3.7014e-01, PNorm = 73.4931, GNorm = 0.9295, lr_0 = 4.7315e-04
Loss = 3.3252e-01, PNorm = 73.6717, GNorm = 1.2093, lr_0 = 4.6763e-04
Validation auc = 0.817545
Epoch 33
Loss = 3.1796e-01, PNorm = 73.8507, GNorm = 0.6806, lr_0 = 4.6216e-04
Loss = 3.3747e-01, PNorm = 74.0130, GNorm = 0.9562, lr_0 = 4.5677e-04
Validation auc = 0.826074
Epoch 34
Loss = 2.5087e-01, PNorm = 74.2032, GNorm = 0.4945, lr_0 = 4.5090e-04
Loss = 3.3604e-01, PNorm = 74.3696, GNorm = 0.6859, lr_0 = 4.4564e-04
Validation auc = 0.809625
Epoch 35
Loss = 2.7659e-01, PNorm = 74.5364, GNorm = 0.6411, lr_0 = 4.4043e-04
Loss = 2.7094e-01, PNorm = 74.7136, GNorm = 0.8488, lr_0 = 4.3529e-04
Validation auc = 0.832775
Epoch 36
Loss = 1.9980e-01, PNorm = 74.8708, GNorm = 0.6271, lr_0 = 4.3020e-04
Loss = 2.8583e-01, PNorm = 75.0348, GNorm = 0.8254, lr_0 = 4.2518e-04
Loss = 3.1742e-01, PNorm = 75.2043, GNorm = 0.5920, lr_0 = 4.2021e-04
Validation auc = 0.813890
Epoch 37
Loss = 2.7646e-01, PNorm = 75.3680, GNorm = 1.0462, lr_0 = 4.1531e-04
Loss = 2.6793e-01, PNorm = 75.5403, GNorm = 1.1758, lr_0 = 4.1045e-04
Validation auc = 0.813281
Epoch 38
Loss = 2.5338e-01, PNorm = 75.6957, GNorm = 0.8659, lr_0 = 4.0566e-04
Loss = 2.8122e-01, PNorm = 75.8602, GNorm = 0.8960, lr_0 = 4.0092e-04
Validation auc = 0.824855
Epoch 39
Loss = 2.7206e-01, PNorm = 76.0367, GNorm = 1.3775, lr_0 = 3.9578e-04
Loss = 2.4543e-01, PNorm = 76.1935, GNorm = 0.5877, lr_0 = 3.9115e-04
Validation auc = 0.794395
Epoch 40
Loss = 2.3031e-01, PNorm = 76.3581, GNorm = 1.4243, lr_0 = 3.8658e-04
Loss = 2.7331e-01, PNorm = 76.5103, GNorm = 0.9227, lr_0 = 3.8207e-04
Validation auc = 0.822114
Epoch 41
Loss = 2.2681e-01, PNorm = 76.6643, GNorm = 0.5782, lr_0 = 3.7761e-04
Loss = 2.3244e-01, PNorm = 76.8122, GNorm = 0.6543, lr_0 = 3.7320e-04
Validation auc = 0.810844
Epoch 42
Loss = 2.2440e-01, PNorm = 76.9501, GNorm = 0.5245, lr_0 = 3.6884e-04
Loss = 2.1672e-01, PNorm = 77.0961, GNorm = 0.8852, lr_0 = 3.6453e-04
Validation auc = 0.809016
Epoch 43
Loss = 2.7398e-01, PNorm = 77.2272, GNorm = 1.3782, lr_0 = 3.6027e-04
Loss = 2.0287e-01, PNorm = 77.3702, GNorm = 1.1015, lr_0 = 3.5607e-04
Validation auc = 0.796832
Epoch 44
Loss = 2.2893e-01, PNorm = 77.5155, GNorm = 0.6010, lr_0 = 3.5191e-04
Loss = 2.1328e-01, PNorm = 77.6590, GNorm = 0.6133, lr_0 = 3.4780e-04
Validation auc = 0.795918
Epoch 45
Loss = 2.1493e-01, PNorm = 77.8181, GNorm = 1.1655, lr_0 = 3.4333e-04
Loss = 2.1436e-01, PNorm = 77.9572, GNorm = 0.8986, lr_0 = 3.3932e-04
Validation auc = 0.816327
Epoch 46
Loss = 2.2566e-01, PNorm = 78.0999, GNorm = 0.7159, lr_0 = 3.3536e-04
Loss = 1.9375e-01, PNorm = 78.2273, GNorm = 0.8511, lr_0 = 3.3144e-04
Validation auc = 0.796223
Epoch 47
Loss = 2.3666e-01, PNorm = 78.3465, GNorm = 0.7737, lr_0 = 3.2757e-04
Loss = 1.6324e-01, PNorm = 78.4764, GNorm = 0.7273, lr_0 = 3.2375e-04
Validation auc = 0.789826
Epoch 48
Loss = 1.1922e-01, PNorm = 78.5935, GNorm = 0.8319, lr_0 = 3.1996e-04
Loss = 1.9195e-01, PNorm = 78.7187, GNorm = 0.8462, lr_0 = 3.1623e-04
Loss = 1.9378e-01, PNorm = 78.8358, GNorm = 1.0597, lr_0 = 3.1253e-04
Validation auc = 0.801706
Epoch 49
Loss = 1.9146e-01, PNorm = 78.9529, GNorm = 0.7006, lr_0 = 3.0888e-04
Loss = 1.7406e-01, PNorm = 79.0763, GNorm = 1.0623, lr_0 = 3.0528e-04
Validation auc = 0.776119
Epoch 50
Loss = 1.7484e-01, PNorm = 79.1929, GNorm = 0.8377, lr_0 = 3.0171e-04
Loss = 1.8206e-01, PNorm = 79.3120, GNorm = 1.0724, lr_0 = 2.9819e-04
Validation auc = 0.795918
Epoch 51
Loss = 1.6756e-01, PNorm = 79.4429, GNorm = 0.6108, lr_0 = 2.9436e-04
Loss = 1.7966e-01, PNorm = 79.5553, GNorm = 1.7981, lr_0 = 2.9092e-04
Validation auc = 0.776729
Epoch 52
Loss = 2.1721e-01, PNorm = 79.6663, GNorm = 1.6723, lr_0 = 2.8752e-04
Loss = 1.9840e-01, PNorm = 79.7736, GNorm = 0.6450, lr_0 = 2.8417e-04
Validation auc = 0.813890
Epoch 53
Loss = 1.4938e-01, PNorm = 79.8811, GNorm = 0.7870, lr_0 = 2.8085e-04
Loss = 1.5748e-01, PNorm = 79.9700, GNorm = 0.8724, lr_0 = 2.7757e-04
Validation auc = 0.790131
Epoch 54
Loss = 1.2501e-01, PNorm = 80.0627, GNorm = 0.5787, lr_0 = 2.7432e-04
Loss = 1.5993e-01, PNorm = 80.1431, GNorm = 1.4053, lr_0 = 2.7112e-04
Validation auc = 0.795918
Epoch 55
Loss = 1.3315e-01, PNorm = 80.2211, GNorm = 0.7832, lr_0 = 2.6795e-04
Loss = 1.5340e-01, PNorm = 80.3028, GNorm = 0.8131, lr_0 = 2.6483e-04
Validation auc = 0.795309
Epoch 56
Loss = 1.2241e-01, PNorm = 80.3997, GNorm = 0.8738, lr_0 = 2.6142e-04
Loss = 1.6931e-01, PNorm = 80.4954, GNorm = 0.7394, lr_0 = 2.5837e-04
Validation auc = 0.789217
Epoch 57
Loss = 1.4418e-01, PNorm = 80.5847, GNorm = 0.9603, lr_0 = 2.5535e-04
Loss = 1.1435e-01, PNorm = 80.6671, GNorm = 1.4505, lr_0 = 2.5237e-04
Validation auc = 0.773987
Epoch 58
Loss = 1.2663e-01, PNorm = 80.7417, GNorm = 0.6820, lr_0 = 2.4942e-04
Loss = 1.2879e-01, PNorm = 80.8243, GNorm = 0.6542, lr_0 = 2.4651e-04
Validation auc = 0.778252
Epoch 59
Loss = 1.4446e-01, PNorm = 80.9138, GNorm = 2.2897, lr_0 = 2.4363e-04
Loss = 1.0582e-01, PNorm = 81.0017, GNorm = 0.7434, lr_0 = 2.4079e-04
Validation auc = 0.789826
Epoch 60
Loss = 1.2522e-01, PNorm = 81.0844, GNorm = 1.1677, lr_0 = 2.3797e-04
Loss = 1.2296e-01, PNorm = 81.1651, GNorm = 0.4786, lr_0 = 2.3520e-04
Loss = 1.4225e-01, PNorm = 81.2382, GNorm = 1.2365, lr_0 = 2.3245e-04
Validation auc = 0.781907
Epoch 61
Loss = 1.0719e-01, PNorm = 81.3055, GNorm = 0.8656, lr_0 = 2.2973e-04
Loss = 1.3463e-01, PNorm = 81.3741, GNorm = 1.4428, lr_0 = 2.2705e-04
Loss = 1.3417e-01, PNorm = 81.3804, GNorm = 0.8397, lr_0 = 2.2678e-04
Validation auc = 0.781298
Epoch 62
Loss = 1.2154e-01, PNorm = 81.4506, GNorm = 2.0071, lr_0 = 2.2414e-04
Loss = 1.2319e-01, PNorm = 81.5230, GNorm = 0.6351, lr_0 = 2.2152e-04
Validation auc = 0.784953
Epoch 63
Loss = 1.0763e-01, PNorm = 81.5954, GNorm = 0.6300, lr_0 = 2.1893e-04
Loss = 1.0697e-01, PNorm = 81.6646, GNorm = 0.9996, lr_0 = 2.1637e-04
Validation auc = 0.791045
Epoch 64
Loss = 9.6572e-02, PNorm = 81.7238, GNorm = 0.9320, lr_0 = 2.1385e-04
Loss = 1.0923e-01, PNorm = 81.7755, GNorm = 0.8999, lr_0 = 2.1135e-04
Validation auc = 0.776729
Epoch 65
Loss = 8.9554e-02, PNorm = 81.8280, GNorm = 0.6717, lr_0 = 2.0888e-04
Loss = 1.0897e-01, PNorm = 81.8801, GNorm = 0.9996, lr_0 = 2.0644e-04
Validation auc = 0.787999
Epoch 66
Loss = 1.2565e-01, PNorm = 81.9394, GNorm = 0.6523, lr_0 = 2.0403e-04
Loss = 8.6393e-02, PNorm = 82.0015, GNorm = 0.3411, lr_0 = 2.0165e-04
Validation auc = 0.781602
Epoch 67
Loss = 9.4141e-02, PNorm = 82.0599, GNorm = 0.7717, lr_0 = 1.9906e-04
Loss = 1.0371e-01, PNorm = 82.1117, GNorm = 0.6053, lr_0 = 1.9673e-04
Validation auc = 0.775663
Epoch 68
Loss = 9.5161e-02, PNorm = 82.1634, GNorm = 0.5614, lr_0 = 1.9444e-04
Loss = 9.2294e-02, PNorm = 82.2200, GNorm = 0.5917, lr_0 = 1.9216e-04
Validation auc = 0.791045
Epoch 69
Loss = 1.2694e-01, PNorm = 82.2712, GNorm = 0.7906, lr_0 = 1.8992e-04
Loss = 8.6586e-02, PNorm = 82.3210, GNorm = 0.9238, lr_0 = 1.8770e-04
Validation auc = 0.775815
Epoch 70
Loss = 7.9938e-02, PNorm = 82.3676, GNorm = 0.9557, lr_0 = 1.8551e-04
Loss = 9.1831e-02, PNorm = 82.4118, GNorm = 0.8351, lr_0 = 1.8334e-04
Validation auc = 0.777338
Epoch 71
Loss = 1.0414e-01, PNorm = 82.4596, GNorm = 1.1353, lr_0 = 1.8120e-04
Loss = 7.1099e-02, PNorm = 82.5015, GNorm = 0.7724, lr_0 = 1.7909e-04
Validation auc = 0.785867
Epoch 72
Loss = 7.0807e-02, PNorm = 82.5407, GNorm = 0.7252, lr_0 = 1.7699e-04
Loss = 8.1980e-02, PNorm = 82.5862, GNorm = 0.7344, lr_0 = 1.7493e-04
Validation auc = 0.769418
Epoch 73
Loss = 9.9215e-02, PNorm = 82.6349, GNorm = 1.0536, lr_0 = 1.7268e-04
Loss = 6.7236e-02, PNorm = 82.6746, GNorm = 0.5539, lr_0 = 1.7066e-04
Loss = 8.9148e-02, PNorm = 82.7129, GNorm = 1.0645, lr_0 = 1.6867e-04
Validation auc = 0.773073
Epoch 74
Loss = 7.7387e-02, PNorm = 82.7530, GNorm = 0.4137, lr_0 = 1.6670e-04
Loss = 7.8106e-02, PNorm = 82.7952, GNorm = 0.8277, lr_0 = 1.6475e-04
Validation auc = 0.773683
Epoch 75
Loss = 6.8388e-02, PNorm = 82.8348, GNorm = 0.5273, lr_0 = 1.6283e-04
Loss = 6.8023e-02, PNorm = 82.8688, GNorm = 0.7933, lr_0 = 1.6093e-04
Validation auc = 0.770637
Epoch 76
Loss = 6.4695e-02, PNorm = 82.9044, GNorm = 0.5216, lr_0 = 1.5905e-04
Loss = 6.7309e-02, PNorm = 82.9378, GNorm = 0.5102, lr_0 = 1.5719e-04
Validation auc = 0.784648
Epoch 77
Loss = 7.2939e-02, PNorm = 82.9750, GNorm = 0.7295, lr_0 = 1.5536e-04
Loss = 7.3733e-02, PNorm = 83.0121, GNorm = 1.0157, lr_0 = 1.5354e-04
Validation auc = 0.778556
Epoch 78
Loss = 7.7795e-02, PNorm = 83.0520, GNorm = 0.8988, lr_0 = 1.5157e-04
Loss = 7.1042e-02, PNorm = 83.0870, GNorm = 0.5388, lr_0 = 1.4980e-04
Validation auc = 0.770332
Epoch 79
Loss = 6.5636e-02, PNorm = 83.1217, GNorm = 0.7883, lr_0 = 1.4805e-04
Loss = 8.2146e-02, PNorm = 83.1530, GNorm = 0.7922, lr_0 = 1.4632e-04
Validation auc = 0.771550
Epoch 80
Loss = 6.2512e-02, PNorm = 83.1854, GNorm = 0.5719, lr_0 = 1.4461e-04
Loss = 7.7305e-02, PNorm = 83.2177, GNorm = 1.1028, lr_0 = 1.4292e-04
Validation auc = 0.766981
Epoch 81
Loss = 6.2010e-02, PNorm = 83.2492, GNorm = 0.7025, lr_0 = 1.4125e-04
Loss = 7.2901e-02, PNorm = 83.2791, GNorm = 0.7181, lr_0 = 1.3960e-04
Validation auc = 0.774596
Epoch 82
Loss = 7.4098e-02, PNorm = 83.3116, GNorm = 1.1886, lr_0 = 1.3797e-04
Loss = 5.8942e-02, PNorm = 83.3440, GNorm = 0.7989, lr_0 = 1.3636e-04
Validation auc = 0.766677
Epoch 83
Loss = 6.6184e-02, PNorm = 83.3734, GNorm = 0.8387, lr_0 = 1.3477e-04
Loss = 6.3711e-02, PNorm = 83.4044, GNorm = 0.7851, lr_0 = 1.3320e-04
Validation auc = 0.775510
Epoch 84
Loss = 7.4124e-02, PNorm = 83.4347, GNorm = 0.8820, lr_0 = 1.3149e-04
Loss = 6.3596e-02, PNorm = 83.4591, GNorm = 1.0100, lr_0 = 1.2995e-04
Validation auc = 0.761499
Epoch 85
Loss = 3.8489e-02, PNorm = 83.4836, GNorm = 0.3051, lr_0 = 1.2843e-04
Loss = 6.1265e-02, PNorm = 83.5078, GNorm = 0.6808, lr_0 = 1.2693e-04
Loss = 6.8372e-02, PNorm = 83.5342, GNorm = 1.3566, lr_0 = 1.2545e-04
Validation auc = 0.749467
Epoch 86
Loss = 7.0841e-02, PNorm = 83.5582, GNorm = 0.8038, lr_0 = 1.2398e-04
Loss = 4.8688e-02, PNorm = 83.5840, GNorm = 0.7865, lr_0 = 1.2254e-04
Validation auc = 0.776729
Epoch 87
Loss = 7.0819e-02, PNorm = 83.6087, GNorm = 0.8319, lr_0 = 1.2111e-04
Loss = 4.8331e-02, PNorm = 83.6331, GNorm = 0.3584, lr_0 = 1.1969e-04
Validation auc = 0.773073
Epoch 88
Loss = 5.0837e-02, PNorm = 83.6549, GNorm = 1.0164, lr_0 = 1.1829e-04
Loss = 5.8903e-02, PNorm = 83.6804, GNorm = 0.3846, lr_0 = 1.1691e-04
Validation auc = 0.767895
Epoch 89
Loss = 5.4172e-02, PNorm = 83.7032, GNorm = 0.4491, lr_0 = 1.1541e-04
Loss = 5.5038e-02, PNorm = 83.7248, GNorm = 0.8714, lr_0 = 1.1406e-04
Validation auc = 0.766829
Epoch 90
Loss = 4.5161e-02, PNorm = 83.7464, GNorm = 0.3614, lr_0 = 1.1273e-04
Loss = 6.2222e-02, PNorm = 83.7672, GNorm = 1.4586, lr_0 = 1.1141e-04
Validation auc = 0.768809
Epoch 91
Loss = 6.9162e-02, PNorm = 83.7870, GNorm = 1.4119, lr_0 = 1.1011e-04
Loss = 5.0151e-02, PNorm = 83.8092, GNorm = 0.6588, lr_0 = 1.0883e-04
Validation auc = 0.768352
Epoch 92
Loss = 5.7589e-02, PNorm = 83.8296, GNorm = 0.6175, lr_0 = 1.0756e-04
Loss = 4.8249e-02, PNorm = 83.8509, GNorm = 0.5799, lr_0 = 1.0630e-04
Validation auc = 0.768504
Epoch 93
Loss = 4.7711e-02, PNorm = 83.8725, GNorm = 0.3843, lr_0 = 1.0506e-04
Loss = 4.3918e-02, PNorm = 83.8921, GNorm = 1.0159, lr_0 = 1.0383e-04
Validation auc = 0.763935
Epoch 94
Loss = 3.5641e-02, PNorm = 83.9121, GNorm = 0.4436, lr_0 = 1.0262e-04
Loss = 5.8360e-02, PNorm = 83.9332, GNorm = 0.3966, lr_0 = 1.0142e-04
Validation auc = 0.759062
Epoch 95
Loss = 5.2215e-02, PNorm = 83.9535, GNorm = 0.6294, lr_0 = 1.0012e-04
Loss = 5.0074e-02, PNorm = 83.9733, GNorm = 1.0050, lr_0 = 1.0000e-04
Validation auc = 0.765154
Epoch 96
Loss = 2.6793e-02, PNorm = 83.9935, GNorm = 0.3346, lr_0 = 1.0000e-04
Loss = 4.2437e-02, PNorm = 84.0117, GNorm = 0.5488, lr_0 = 1.0000e-04
Validation auc = 0.767134
Epoch 97
Loss = 4.5291e-02, PNorm = 84.0288, GNorm = 0.5681, lr_0 = 1.0000e-04
Loss = 4.8770e-02, PNorm = 84.0436, GNorm = 0.7847, lr_0 = 1.0000e-04
Loss = 5.1073e-02, PNorm = 84.0607, GNorm = 0.5416, lr_0 = 1.0000e-04
Validation auc = 0.770027
Epoch 98
Loss = 4.3382e-02, PNorm = 84.0826, GNorm = 1.3173, lr_0 = 1.0000e-04
Loss = 5.2163e-02, PNorm = 84.1021, GNorm = 0.4808, lr_0 = 1.0000e-04
Validation auc = 0.769723
Epoch 99
Loss = 4.9598e-02, PNorm = 84.1190, GNorm = 0.6090, lr_0 = 1.0000e-04
Loss = 5.1374e-02, PNorm = 84.1377, GNorm = 1.0273, lr_0 = 1.0000e-04
Validation auc = 0.763783
Model 2 best validation auc = 0.832775 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 2 test auc = 0.774317
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 4,900,801
Moving model to cuda
Epoch 0
Loss = 7.0195e-01, PNorm = 63.4453, GNorm = 0.8749, lr_0 = 3.4750e-04
Loss = 6.8736e-01, PNorm = 63.4850, GNorm = 0.7110, lr_0 = 5.7250e-04
Loss = 6.2659e-01, PNorm = 63.4905, GNorm = 1.1221, lr_0 = 5.9500e-04
Validation auc = 0.717027
Epoch 1
Loss = 6.6588e-01, PNorm = 63.5613, GNorm = 0.7019, lr_0 = 8.2000e-04
Loss = 6.8038e-01, PNorm = 63.6486, GNorm = 0.5336, lr_0 = 9.9765e-04
Validation auc = 0.751751
Epoch 2
Loss = 6.3267e-01, PNorm = 63.7448, GNorm = 0.7133, lr_0 = 9.8600e-04
Loss = 6.6236e-01, PNorm = 63.8303, GNorm = 1.4200, lr_0 = 9.7449e-04
Validation auc = 0.743527
Epoch 3
Loss = 6.1830e-01, PNorm = 63.9026, GNorm = 0.4752, lr_0 = 9.6310e-04
Loss = 6.3138e-01, PNorm = 63.9632, GNorm = 0.6959, lr_0 = 9.5186e-04
Validation auc = 0.766981
Epoch 4
Loss = 6.3382e-01, PNorm = 64.0367, GNorm = 0.7506, lr_0 = 9.4074e-04
Loss = 6.0962e-01, PNorm = 64.1028, GNorm = 0.4188, lr_0 = 9.2975e-04
Validation auc = 0.766981
Epoch 5
Loss = 6.1029e-01, PNorm = 64.1772, GNorm = 0.4258, lr_0 = 9.1889e-04
Loss = 6.0208e-01, PNorm = 64.2543, GNorm = 0.4791, lr_0 = 9.0816e-04
Validation auc = 0.784953
Epoch 6
Loss = 6.1098e-01, PNorm = 64.3227, GNorm = 0.6623, lr_0 = 8.9650e-04
Loss = 5.9560e-01, PNorm = 64.3972, GNorm = 0.6678, lr_0 = 8.8603e-04
Validation auc = 0.790131
Epoch 7
Loss = 5.7441e-01, PNorm = 64.4933, GNorm = 0.4785, lr_0 = 8.7568e-04
Loss = 5.8650e-01, PNorm = 64.5955, GNorm = 1.2193, lr_0 = 8.6546e-04
Validation auc = 0.777338
Epoch 8
Loss = 5.5082e-01, PNorm = 64.6723, GNorm = 0.4511, lr_0 = 8.5535e-04
Loss = 5.4991e-01, PNorm = 64.7549, GNorm = 0.7682, lr_0 = 8.4536e-04
Validation auc = 0.777338
Epoch 9
Loss = 5.5468e-01, PNorm = 64.8260, GNorm = 0.7119, lr_0 = 8.3549e-04
Loss = 5.4321e-01, PNorm = 64.9146, GNorm = 0.5506, lr_0 = 8.2573e-04
Validation auc = 0.779470
Epoch 10
Loss = 4.9215e-01, PNorm = 64.9997, GNorm = 0.4482, lr_0 = 8.1608e-04
Loss = 5.6920e-01, PNorm = 65.1069, GNorm = 1.4574, lr_0 = 8.0655e-04
Validation auc = 0.777947
Epoch 11
Loss = 4.6376e-01, PNorm = 65.2107, GNorm = 0.4765, lr_0 = 7.9713e-04
Loss = 5.4862e-01, PNorm = 65.3157, GNorm = 0.6183, lr_0 = 7.8782e-04
Validation auc = 0.776729
Epoch 12
Loss = 5.9366e-01, PNorm = 65.4422, GNorm = 0.5335, lr_0 = 7.7771e-04
Loss = 5.1481e-01, PNorm = 65.5884, GNorm = 0.7539, lr_0 = 7.6862e-04
Loss = 5.2925e-01, PNorm = 65.6936, GNorm = 0.6777, lr_0 = 7.5965e-04
Validation auc = 0.790740
Epoch 13
Loss = 5.1717e-01, PNorm = 65.8109, GNorm = 0.5982, lr_0 = 7.5078e-04
Loss = 5.3336e-01, PNorm = 65.9567, GNorm = 0.5544, lr_0 = 7.4201e-04
Validation auc = 0.782516
Epoch 14
Loss = 5.0368e-01, PNorm = 66.0945, GNorm = 0.5606, lr_0 = 7.3334e-04
Loss = 5.0467e-01, PNorm = 66.2231, GNorm = 0.4121, lr_0 = 7.2478e-04
Validation auc = 0.788303
Epoch 15
Loss = 5.1330e-01, PNorm = 66.3652, GNorm = 1.0316, lr_0 = 7.1631e-04
Loss = 5.1395e-01, PNorm = 66.5046, GNorm = 0.5884, lr_0 = 7.0795e-04
Validation auc = 0.800183
Epoch 16
Loss = 4.8796e-01, PNorm = 66.6444, GNorm = 0.7351, lr_0 = 6.9968e-04
Loss = 4.8433e-01, PNorm = 66.7987, GNorm = 0.5647, lr_0 = 6.9151e-04
Validation auc = 0.792568
Epoch 17
Loss = 4.8689e-01, PNorm = 66.9750, GNorm = 0.7062, lr_0 = 6.8263e-04
Loss = 4.9678e-01, PNorm = 67.1274, GNorm = 0.4949, lr_0 = 6.7465e-04
Validation auc = 0.791349
Epoch 18
Loss = 4.4891e-01, PNorm = 67.3027, GNorm = 0.5766, lr_0 = 6.6678e-04
Loss = 5.0211e-01, PNorm = 67.4673, GNorm = 0.6139, lr_0 = 6.5899e-04
Validation auc = 0.810844
Epoch 19
Loss = 4.5358e-01, PNorm = 67.6172, GNorm = 0.4553, lr_0 = 6.5129e-04
Loss = 4.4942e-01, PNorm = 67.7952, GNorm = 0.5531, lr_0 = 6.4369e-04
Validation auc = 0.818459
Epoch 20
Loss = 4.7119e-01, PNorm = 67.9773, GNorm = 0.5878, lr_0 = 6.3617e-04
Loss = 4.3954e-01, PNorm = 68.1375, GNorm = 0.6167, lr_0 = 6.2874e-04
Validation auc = 0.791045
Epoch 21
Loss = 3.9663e-01, PNorm = 68.3029, GNorm = 0.5769, lr_0 = 6.2139e-04
Loss = 4.5687e-01, PNorm = 68.4931, GNorm = 0.7328, lr_0 = 6.1414e-04
Validation auc = 0.813585
Epoch 22
Loss = 4.2190e-01, PNorm = 68.6799, GNorm = 0.5556, lr_0 = 6.0696e-04
Loss = 4.5161e-01, PNorm = 68.8581, GNorm = 0.7403, lr_0 = 5.9988e-04
Validation auc = 0.784039
Epoch 23
Loss = 4.2838e-01, PNorm = 69.0667, GNorm = 0.7446, lr_0 = 5.9217e-04
Loss = 4.3243e-01, PNorm = 69.2745, GNorm = 0.8280, lr_0 = 5.8526e-04
Validation auc = 0.816936
Epoch 24
Loss = 3.5539e-01, PNorm = 69.4467, GNorm = 1.0549, lr_0 = 5.7842e-04
Loss = 4.3764e-01, PNorm = 69.6258, GNorm = 0.7497, lr_0 = 5.7167e-04
Loss = 4.2353e-01, PNorm = 69.8009, GNorm = 0.6337, lr_0 = 5.6499e-04
Validation auc = 0.792263
Epoch 25
Loss = 4.2037e-01, PNorm = 69.9838, GNorm = 1.4094, lr_0 = 5.5839e-04
Loss = 3.9964e-01, PNorm = 70.1801, GNorm = 0.6021, lr_0 = 5.5187e-04
Validation auc = 0.816631
Epoch 26
Loss = 4.1655e-01, PNorm = 70.3670, GNorm = 0.7448, lr_0 = 5.4542e-04
Loss = 3.7463e-01, PNorm = 70.5548, GNorm = 0.5591, lr_0 = 5.3905e-04
Validation auc = 0.821200
Epoch 27
Loss = 3.7268e-01, PNorm = 70.7230, GNorm = 0.8849, lr_0 = 5.3276e-04
Loss = 3.9375e-01, PNorm = 70.8958, GNorm = 0.6660, lr_0 = 5.2654e-04
Validation auc = 0.781602
Epoch 28
Loss = 3.5673e-01, PNorm = 71.0862, GNorm = 0.6536, lr_0 = 5.1978e-04
Loss = 3.8745e-01, PNorm = 71.2676, GNorm = 0.8038, lr_0 = 5.1371e-04
Validation auc = 0.811148
Epoch 29
Loss = 3.6460e-01, PNorm = 71.4715, GNorm = 0.8308, lr_0 = 5.0771e-04
Loss = 3.6006e-01, PNorm = 71.6630, GNorm = 1.5627, lr_0 = 5.0178e-04
Validation auc = 0.829729
Epoch 30
Loss = 3.4949e-01, PNorm = 71.8386, GNorm = 0.8280, lr_0 = 4.9592e-04
Loss = 3.7293e-01, PNorm = 72.0104, GNorm = 0.7320, lr_0 = 4.9012e-04
Validation auc = 0.800487
Epoch 31
Loss = 3.0651e-01, PNorm = 72.1795, GNorm = 0.8801, lr_0 = 4.8440e-04
Loss = 3.5265e-01, PNorm = 72.3464, GNorm = 0.6558, lr_0 = 4.7874e-04
Validation auc = 0.797746
Epoch 32
Loss = 3.2587e-01, PNorm = 72.4924, GNorm = 0.7596, lr_0 = 4.7315e-04
Loss = 3.4446e-01, PNorm = 72.6609, GNorm = 0.9655, lr_0 = 4.6763e-04
Validation auc = 0.799878
Epoch 33
Loss = 3.0782e-01, PNorm = 72.8086, GNorm = 0.6219, lr_0 = 4.6216e-04
Loss = 3.4098e-01, PNorm = 72.9620, GNorm = 0.6284, lr_0 = 4.5677e-04
Validation auc = 0.818763
Epoch 34
Loss = 2.7461e-01, PNorm = 73.1255, GNorm = 0.6022, lr_0 = 4.5090e-04
Loss = 3.3166e-01, PNorm = 73.2792, GNorm = 1.2052, lr_0 = 4.4564e-04
Validation auc = 0.823637
Epoch 35
Loss = 3.1003e-01, PNorm = 73.4361, GNorm = 0.7509, lr_0 = 4.4043e-04
Loss = 3.2194e-01, PNorm = 73.5986, GNorm = 0.7443, lr_0 = 4.3529e-04
Validation auc = 0.806579
Epoch 36
Loss = 3.1656e-01, PNorm = 73.7382, GNorm = 0.6711, lr_0 = 4.3020e-04
Loss = 3.3960e-01, PNorm = 73.9003, GNorm = 0.9529, lr_0 = 4.2518e-04
Loss = 2.6837e-01, PNorm = 74.0455, GNorm = 0.8379, lr_0 = 4.2021e-04
Validation auc = 0.822419
Epoch 37
Loss = 2.6390e-01, PNorm = 74.2053, GNorm = 0.8525, lr_0 = 4.1531e-04
Loss = 3.0253e-01, PNorm = 74.3553, GNorm = 0.7010, lr_0 = 4.1045e-04
Validation auc = 0.803533
Epoch 38
Loss = 2.9680e-01, PNorm = 74.5001, GNorm = 0.7719, lr_0 = 4.0566e-04
Loss = 2.8627e-01, PNorm = 74.6442, GNorm = 0.7556, lr_0 = 4.0092e-04
Validation auc = 0.819373
Epoch 39
Loss = 2.8916e-01, PNorm = 74.7991, GNorm = 0.9149, lr_0 = 3.9578e-04
Loss = 2.3825e-01, PNorm = 74.9422, GNorm = 0.7249, lr_0 = 3.9115e-04
Validation auc = 0.823028
Epoch 40
Loss = 2.7214e-01, PNorm = 75.0791, GNorm = 0.9783, lr_0 = 3.8658e-04
Loss = 2.6495e-01, PNorm = 75.2209, GNorm = 1.5558, lr_0 = 3.8207e-04
Validation auc = 0.816936
Epoch 41
Loss = 2.5741e-01, PNorm = 75.3559, GNorm = 0.7874, lr_0 = 3.7761e-04
Loss = 2.8006e-01, PNorm = 75.5100, GNorm = 0.6819, lr_0 = 3.7320e-04
Validation auc = 0.813281
Epoch 42
Loss = 2.7721e-01, PNorm = 75.6581, GNorm = 0.7715, lr_0 = 3.6884e-04
Loss = 2.3690e-01, PNorm = 75.7997, GNorm = 0.7653, lr_0 = 3.6453e-04
Validation auc = 0.823637
Epoch 43
Loss = 2.3605e-01, PNorm = 75.9289, GNorm = 0.8416, lr_0 = 3.6027e-04
Loss = 2.3267e-01, PNorm = 76.0636, GNorm = 0.8908, lr_0 = 3.5607e-04
Validation auc = 0.819677
Epoch 44
Loss = 2.4483e-01, PNorm = 76.1738, GNorm = 1.1702, lr_0 = 3.5191e-04
Loss = 2.4695e-01, PNorm = 76.2996, GNorm = 0.9477, lr_0 = 3.4780e-04
Validation auc = 0.814194
Epoch 45
Loss = 2.0388e-01, PNorm = 76.4497, GNorm = 0.5792, lr_0 = 3.4333e-04
Loss = 2.2038e-01, PNorm = 76.5796, GNorm = 1.3011, lr_0 = 3.3932e-04
Validation auc = 0.799878
Epoch 46
Loss = 1.6450e-01, PNorm = 76.6873, GNorm = 0.7745, lr_0 = 3.3536e-04
Loss = 1.9984e-01, PNorm = 76.8062, GNorm = 0.7042, lr_0 = 3.3144e-04
Validation auc = 0.813281
Epoch 47
Loss = 1.8316e-01, PNorm = 76.9261, GNorm = 0.8018, lr_0 = 3.2757e-04
Loss = 2.1913e-01, PNorm = 77.0370, GNorm = 0.8146, lr_0 = 3.2375e-04
Validation auc = 0.812976
Epoch 48
Loss = 1.1702e-01, PNorm = 77.1517, GNorm = 0.4905, lr_0 = 3.1996e-04
Loss = 1.8937e-01, PNorm = 77.2701, GNorm = 0.8036, lr_0 = 3.1623e-04
Loss = 2.0086e-01, PNorm = 77.3866, GNorm = 0.7497, lr_0 = 3.1253e-04
Validation auc = 0.794395
Epoch 49
Loss = 1.9265e-01, PNorm = 77.4989, GNorm = 0.7185, lr_0 = 3.0888e-04
Loss = 2.1225e-01, PNorm = 77.6063, GNorm = 0.8819, lr_0 = 3.0528e-04
Validation auc = 0.805361
Epoch 50
Loss = 1.7591e-01, PNorm = 77.7127, GNorm = 0.5380, lr_0 = 3.0171e-04
Loss = 2.1597e-01, PNorm = 77.8251, GNorm = 1.4821, lr_0 = 2.9819e-04
Validation auc = 0.819982
Epoch 51
Loss = 1.9254e-01, PNorm = 77.9482, GNorm = 1.1557, lr_0 = 2.9436e-04
Loss = 1.6369e-01, PNorm = 78.0453, GNorm = 0.7965, lr_0 = 2.9092e-04
Validation auc = 0.798051
Epoch 52
Loss = 1.7515e-01, PNorm = 78.1247, GNorm = 0.6235, lr_0 = 2.8752e-04
Loss = 1.6126e-01, PNorm = 78.2072, GNorm = 0.8388, lr_0 = 2.8417e-04
Validation auc = 0.792872
Epoch 53
Loss = 1.6217e-01, PNorm = 78.2874, GNorm = 0.9788, lr_0 = 2.8085e-04
Loss = 1.8631e-01, PNorm = 78.3800, GNorm = 1.5515, lr_0 = 2.7757e-04
Validation auc = 0.799574
Epoch 54
Loss = 1.7809e-01, PNorm = 78.4851, GNorm = 1.2848, lr_0 = 2.7432e-04
Loss = 1.6884e-01, PNorm = 78.5844, GNorm = 0.6114, lr_0 = 2.7112e-04
Validation auc = 0.785562
Epoch 55
Loss = 1.6229e-01, PNorm = 78.6669, GNorm = 1.0666, lr_0 = 2.6795e-04
Loss = 1.6611e-01, PNorm = 78.7514, GNorm = 0.9684, lr_0 = 2.6483e-04
Validation auc = 0.786476
Epoch 56
Loss = 1.7711e-01, PNorm = 78.8545, GNorm = 0.7402, lr_0 = 2.6142e-04
Loss = 1.2734e-01, PNorm = 78.9409, GNorm = 0.7850, lr_0 = 2.5837e-04
Validation auc = 0.796528
Epoch 57
Loss = 1.3069e-01, PNorm = 79.0183, GNorm = 1.2188, lr_0 = 2.5535e-04
Loss = 1.4122e-01, PNorm = 79.0944, GNorm = 0.8381, lr_0 = 2.5237e-04
Validation auc = 0.793786
Epoch 58
Loss = 1.3266e-01, PNorm = 79.1690, GNorm = 0.7258, lr_0 = 2.4942e-04
Loss = 1.3283e-01, PNorm = 79.2464, GNorm = 0.9131, lr_0 = 2.4651e-04
Validation auc = 0.787694
Epoch 59
Loss = 1.4308e-01, PNorm = 79.3250, GNorm = 0.7607, lr_0 = 2.4363e-04
Loss = 1.3055e-01, PNorm = 79.4017, GNorm = 0.9519, lr_0 = 2.4079e-04
Validation auc = 0.795614
Epoch 60
Loss = 1.6848e-01, PNorm = 79.4710, GNorm = 0.7550, lr_0 = 2.3797e-04
Loss = 1.2514e-01, PNorm = 79.5451, GNorm = 1.3562, lr_0 = 2.3520e-04
Loss = 1.2796e-01, PNorm = 79.6214, GNorm = 0.6792, lr_0 = 2.3245e-04
Validation auc = 0.794395
Epoch 61
Loss = 1.1409e-01, PNorm = 79.6905, GNorm = 0.7752, lr_0 = 2.2973e-04
Loss = 1.5821e-01, PNorm = 79.7520, GNorm = 1.1726, lr_0 = 2.2705e-04
Loss = 1.7190e-01, PNorm = 79.7574, GNorm = 0.9528, lr_0 = 2.2678e-04
Validation auc = 0.781602
Epoch 62
Loss = 1.3741e-01, PNorm = 79.8152, GNorm = 1.1283, lr_0 = 2.2414e-04
Loss = 1.2221e-01, PNorm = 79.8737, GNorm = 1.0733, lr_0 = 2.2152e-04
Validation auc = 0.775815
Epoch 63
Loss = 1.2588e-01, PNorm = 79.9387, GNorm = 1.4724, lr_0 = 2.1893e-04
Loss = 1.3664e-01, PNorm = 79.9994, GNorm = 1.0340, lr_0 = 2.1637e-04
Validation auc = 0.794700
Epoch 64
Loss = 1.3022e-01, PNorm = 80.0574, GNorm = 0.6884, lr_0 = 2.1385e-04
Loss = 1.3639e-01, PNorm = 80.1201, GNorm = 0.5696, lr_0 = 2.1135e-04
Validation auc = 0.792872
Epoch 65
Loss = 1.1335e-01, PNorm = 80.1802, GNorm = 0.6310, lr_0 = 2.0888e-04
Loss = 1.0827e-01, PNorm = 80.2408, GNorm = 0.9167, lr_0 = 2.0644e-04
Validation auc = 0.780079
Epoch 66
Loss = 1.2601e-01, PNorm = 80.2937, GNorm = 0.7706, lr_0 = 2.0403e-04
Loss = 1.0947e-01, PNorm = 80.3488, GNorm = 1.0752, lr_0 = 2.0165e-04
Validation auc = 0.771550
Epoch 67
Loss = 1.4259e-01, PNorm = 80.4017, GNorm = 1.8477, lr_0 = 1.9906e-04
Loss = 1.1796e-01, PNorm = 80.4623, GNorm = 1.2881, lr_0 = 1.9673e-04
Validation auc = 0.785562
Epoch 68
Loss = 9.4293e-02, PNorm = 80.5232, GNorm = 0.7645, lr_0 = 1.9444e-04
Loss = 1.1057e-01, PNorm = 80.5777, GNorm = 0.9996, lr_0 = 1.9216e-04
Validation auc = 0.770789
Epoch 69
Loss = 9.3004e-02, PNorm = 80.6263, GNorm = 0.7417, lr_0 = 1.8992e-04
Loss = 9.9776e-02, PNorm = 80.6705, GNorm = 0.8518, lr_0 = 1.8770e-04
Validation auc = 0.779165
Epoch 70
Loss = 1.3421e-01, PNorm = 80.7237, GNorm = 1.4827, lr_0 = 1.8551e-04
Loss = 1.0037e-01, PNorm = 80.7739, GNorm = 0.5220, lr_0 = 1.8334e-04
Validation auc = 0.792263
Epoch 71
Loss = 1.3550e-01, PNorm = 80.8219, GNorm = 1.6168, lr_0 = 1.8120e-04
Loss = 1.0408e-01, PNorm = 80.8655, GNorm = 0.7519, lr_0 = 1.7909e-04
Validation auc = 0.785562
Epoch 72
Loss = 1.2560e-01, PNorm = 80.9068, GNorm = 0.9423, lr_0 = 1.7699e-04
Loss = 9.4816e-02, PNorm = 80.9522, GNorm = 0.9385, lr_0 = 1.7493e-04
Validation auc = 0.788913
Epoch 73
Loss = 7.3310e-02, PNorm = 80.9998, GNorm = 0.5745, lr_0 = 1.7268e-04
Loss = 1.0653e-01, PNorm = 81.0466, GNorm = 0.8845, lr_0 = 1.7066e-04
Loss = 1.1654e-01, PNorm = 81.0898, GNorm = 0.6827, lr_0 = 1.6867e-04
Validation auc = 0.788303
Epoch 74
Loss = 1.0642e-01, PNorm = 81.1291, GNorm = 1.0487, lr_0 = 1.6670e-04
Loss = 8.1303e-02, PNorm = 81.1707, GNorm = 0.5432, lr_0 = 1.6475e-04
Validation auc = 0.794091
Epoch 75
Loss = 1.0759e-01, PNorm = 81.2124, GNorm = 0.8963, lr_0 = 1.6283e-04
Loss = 7.8160e-02, PNorm = 81.2550, GNorm = 0.6613, lr_0 = 1.6093e-04
Validation auc = 0.783734
Epoch 76
Loss = 9.2198e-02, PNorm = 81.2947, GNorm = 0.7757, lr_0 = 1.5905e-04
Loss = 8.1893e-02, PNorm = 81.3312, GNorm = 0.5539, lr_0 = 1.5719e-04
Validation auc = 0.781907
Epoch 77
Loss = 8.9058e-02, PNorm = 81.3684, GNorm = 0.8112, lr_0 = 1.5536e-04
Loss = 8.5636e-02, PNorm = 81.4018, GNorm = 0.6525, lr_0 = 1.5354e-04
Validation auc = 0.787694
Epoch 78
Loss = 6.7545e-02, PNorm = 81.4330, GNorm = 1.0061, lr_0 = 1.5157e-04
Loss = 6.4462e-02, PNorm = 81.4606, GNorm = 0.6293, lr_0 = 1.4980e-04
Validation auc = 0.777642
Epoch 79
Loss = 7.8354e-02, PNorm = 81.4937, GNorm = 1.0184, lr_0 = 1.4805e-04
Loss = 8.0158e-02, PNorm = 81.5271, GNorm = 0.5026, lr_0 = 1.4632e-04
Validation auc = 0.785257
Epoch 80
Loss = 5.7329e-02, PNorm = 81.5625, GNorm = 0.7909, lr_0 = 1.4461e-04
Loss = 9.1581e-02, PNorm = 81.5939, GNorm = 0.6821, lr_0 = 1.4292e-04
Validation auc = 0.782211
Epoch 81
Loss = 6.2597e-02, PNorm = 81.6261, GNorm = 0.6055, lr_0 = 1.4125e-04
Loss = 7.2303e-02, PNorm = 81.6560, GNorm = 0.8647, lr_0 = 1.3960e-04
Validation auc = 0.782516
Epoch 82
Loss = 1.0168e-01, PNorm = 81.6822, GNorm = 0.4674, lr_0 = 1.3797e-04
Loss = 7.6962e-02, PNorm = 81.7123, GNorm = 0.6348, lr_0 = 1.3636e-04
Validation auc = 0.779775
Epoch 83
Loss = 6.0590e-02, PNorm = 81.7393, GNorm = 0.5856, lr_0 = 1.3477e-04
Loss = 7.0360e-02, PNorm = 81.7692, GNorm = 1.0672, lr_0 = 1.3320e-04
Validation auc = 0.791349
Epoch 84
Loss = 8.9665e-02, PNorm = 81.7987, GNorm = 0.8261, lr_0 = 1.3149e-04
Loss = 7.2462e-02, PNorm = 81.8275, GNorm = 0.5117, lr_0 = 1.2995e-04
Validation auc = 0.777947
Epoch 85
Loss = 1.2801e-01, PNorm = 81.8549, GNorm = 1.2385, lr_0 = 1.2843e-04
Loss = 5.4114e-02, PNorm = 81.8823, GNorm = 0.4059, lr_0 = 1.2693e-04
Loss = 8.1956e-02, PNorm = 81.9091, GNorm = 1.3351, lr_0 = 1.2545e-04
Validation auc = 0.780079
Epoch 86
Loss = 7.1021e-02, PNorm = 81.9329, GNorm = 0.5420, lr_0 = 1.2398e-04
Loss = 6.2994e-02, PNorm = 81.9593, GNorm = 0.7137, lr_0 = 1.2254e-04
Validation auc = 0.770637
Epoch 87
Loss = 6.8467e-02, PNorm = 81.9864, GNorm = 0.6033, lr_0 = 1.2111e-04
Loss = 6.5151e-02, PNorm = 82.0080, GNorm = 0.5408, lr_0 = 1.1969e-04
Validation auc = 0.777642
Epoch 88
Loss = 6.9974e-02, PNorm = 82.0299, GNorm = 0.7021, lr_0 = 1.1829e-04
Loss = 6.7731e-02, PNorm = 82.0512, GNorm = 1.2282, lr_0 = 1.1691e-04
Validation auc = 0.778404
Epoch 89
Loss = 4.4280e-02, PNorm = 82.0736, GNorm = 0.4828, lr_0 = 1.1541e-04
Loss = 8.6893e-02, PNorm = 82.0953, GNorm = 0.8226, lr_0 = 1.1406e-04
Validation auc = 0.769723
Epoch 90
Loss = 5.3035e-02, PNorm = 82.1213, GNorm = 0.5089, lr_0 = 1.1273e-04
Loss = 7.7015e-02, PNorm = 82.1458, GNorm = 1.6634, lr_0 = 1.1141e-04
Validation auc = 0.779470
Epoch 91
Loss = 6.1875e-02, PNorm = 82.1705, GNorm = 0.6295, lr_0 = 1.1011e-04
Loss = 7.2189e-02, PNorm = 82.1932, GNorm = 1.0877, lr_0 = 1.0883e-04
Validation auc = 0.767895
Epoch 92
Loss = 6.1871e-02, PNorm = 82.2145, GNorm = 0.6259, lr_0 = 1.0756e-04
Loss = 6.7323e-02, PNorm = 82.2374, GNorm = 0.9155, lr_0 = 1.0630e-04
Validation auc = 0.777338
Epoch 93
Loss = 5.9978e-02, PNorm = 82.2618, GNorm = 0.5257, lr_0 = 1.0506e-04
Loss = 5.5749e-02, PNorm = 82.2837, GNorm = 0.4789, lr_0 = 1.0383e-04
Validation auc = 0.777642
Epoch 94
Loss = 5.5040e-02, PNorm = 82.3047, GNorm = 0.3580, lr_0 = 1.0262e-04
Loss = 5.0823e-02, PNorm = 82.3244, GNorm = 0.6226, lr_0 = 1.0142e-04
Validation auc = 0.770637
Epoch 95
Loss = 5.3204e-02, PNorm = 82.3419, GNorm = 0.6543, lr_0 = 1.0012e-04
Loss = 5.7358e-02, PNorm = 82.3594, GNorm = 1.1634, lr_0 = 1.0000e-04
Validation auc = 0.776729
Epoch 96
Loss = 5.6591e-02, PNorm = 82.3757, GNorm = 0.9766, lr_0 = 1.0000e-04
Loss = 5.5748e-02, PNorm = 82.3943, GNorm = 0.6657, lr_0 = 1.0000e-04
Validation auc = 0.776119
Epoch 97
Loss = 5.8134e-02, PNorm = 82.4115, GNorm = 0.5379, lr_0 = 1.0000e-04
Loss = 5.3348e-02, PNorm = 82.4303, GNorm = 0.8096, lr_0 = 1.0000e-04
Loss = 4.2990e-02, PNorm = 82.4500, GNorm = 0.7536, lr_0 = 1.0000e-04
Validation auc = 0.773683
Epoch 98
Loss = 6.7554e-02, PNorm = 82.4701, GNorm = 0.6856, lr_0 = 1.0000e-04
Loss = 5.6389e-02, PNorm = 82.4887, GNorm = 0.5699, lr_0 = 1.0000e-04
Validation auc = 0.770637
Epoch 99
Loss = 4.7784e-02, PNorm = 82.5078, GNorm = 1.4472, lr_0 = 1.0000e-04
Loss = 5.9633e-02, PNorm = 82.5288, GNorm = 0.4650, lr_0 = 1.0000e-04
Validation auc = 0.771550
Model 3 best validation auc = 0.829729 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 3 test auc = 0.797887
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1200, bias=False)
        (W_h): Linear(in_features=1200, out_features=1200, bias=False)
        (W_o): Linear(in_features=1333, out_features=1200, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=1400, out_features=1200, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=1200, out_features=1, bias=True)
  )
)
Number of parameters = 4,900,801
Moving model to cuda
Epoch 0
Loss = 6.7516e-01, PNorm = 63.4011, GNorm = 1.2758, lr_0 = 3.4750e-04
Loss = 6.7583e-01, PNorm = 63.4480, GNorm = 2.0644, lr_0 = 5.7250e-04
Loss = 6.4010e-01, PNorm = 63.4538, GNorm = 2.0466, lr_0 = 5.9500e-04
Validation auc = 0.697228
Epoch 1
Loss = 6.4904e-01, PNorm = 63.5307, GNorm = 0.9953, lr_0 = 8.2000e-04
Loss = 6.4346e-01, PNorm = 63.6322, GNorm = 0.7112, lr_0 = 9.9765e-04
Validation auc = 0.752665
Epoch 2
Loss = 6.4363e-01, PNorm = 63.7406, GNorm = 1.7241, lr_0 = 9.8600e-04
Loss = 6.1904e-01, PNorm = 63.8354, GNorm = 0.9328, lr_0 = 9.7449e-04
Validation auc = 0.754188
Epoch 3
Loss = 6.4495e-01, PNorm = 63.9299, GNorm = 0.5806, lr_0 = 9.6310e-04
Loss = 6.1727e-01, PNorm = 64.0040, GNorm = 0.6094, lr_0 = 9.5186e-04
Validation auc = 0.767895
Epoch 4
Loss = 5.9833e-01, PNorm = 64.0936, GNorm = 1.2308, lr_0 = 9.4074e-04
Loss = 6.0299e-01, PNorm = 64.1744, GNorm = 0.4527, lr_0 = 9.2975e-04
Validation auc = 0.786476
Epoch 5
Loss = 5.9729e-01, PNorm = 64.2501, GNorm = 0.6794, lr_0 = 9.1889e-04
Loss = 5.8543e-01, PNorm = 64.3451, GNorm = 0.4614, lr_0 = 9.0816e-04
Validation auc = 0.772160
Epoch 6
Loss = 5.9236e-01, PNorm = 64.4576, GNorm = 0.4731, lr_0 = 8.9650e-04
Loss = 5.8035e-01, PNorm = 64.5511, GNorm = 0.5630, lr_0 = 8.8603e-04
Validation auc = 0.796528
Epoch 7
Loss = 5.6842e-01, PNorm = 64.6555, GNorm = 0.5564, lr_0 = 8.7568e-04
Loss = 5.9550e-01, PNorm = 64.7732, GNorm = 1.0320, lr_0 = 8.6546e-04
Validation auc = 0.775206
Epoch 8
Loss = 5.7948e-01, PNorm = 64.9011, GNorm = 0.6865, lr_0 = 8.5535e-04
Loss = 5.5840e-01, PNorm = 65.0219, GNorm = 0.7914, lr_0 = 8.4536e-04
Validation auc = 0.796832
Epoch 9
Loss = 5.9794e-01, PNorm = 65.1498, GNorm = 1.2053, lr_0 = 8.3549e-04
Loss = 5.4327e-01, PNorm = 65.2720, GNorm = 0.7965, lr_0 = 8.2573e-04
Validation auc = 0.773073
Epoch 10
Loss = 5.6061e-01, PNorm = 65.3822, GNorm = 0.5253, lr_0 = 8.1608e-04
Loss = 5.4694e-01, PNorm = 65.5402, GNorm = 0.6832, lr_0 = 8.0655e-04
Validation auc = 0.789217
Epoch 11
Loss = 4.8775e-01, PNorm = 65.6622, GNorm = 0.8592, lr_0 = 7.9713e-04
Loss = 5.4033e-01, PNorm = 65.8176, GNorm = 0.7323, lr_0 = 7.8782e-04
Validation auc = 0.799269
Epoch 12
Loss = 4.0576e-01, PNorm = 65.9669, GNorm = 0.4377, lr_0 = 7.7771e-04
Loss = 4.9870e-01, PNorm = 66.1099, GNorm = 0.7567, lr_0 = 7.6862e-04
Loss = 5.6622e-01, PNorm = 66.2730, GNorm = 0.7215, lr_0 = 7.5965e-04
Validation auc = 0.774901
Epoch 13
Loss = 5.1294e-01, PNorm = 66.4202, GNorm = 0.6093, lr_0 = 7.5078e-04
Loss = 5.0694e-01, PNorm = 66.5828, GNorm = 0.7979, lr_0 = 7.4201e-04
Validation auc = 0.799269
Epoch 14
Loss = 4.8513e-01, PNorm = 66.7588, GNorm = 0.5741, lr_0 = 7.3334e-04
Loss = 5.1290e-01, PNorm = 66.9228, GNorm = 1.1786, lr_0 = 7.2478e-04
Validation auc = 0.797746
Epoch 15
Loss = 4.9127e-01, PNorm = 67.0966, GNorm = 0.5451, lr_0 = 7.1631e-04
Loss = 5.0483e-01, PNorm = 67.2921, GNorm = 0.7868, lr_0 = 7.0795e-04
Validation auc = 0.808102
Epoch 16
Loss = 5.0470e-01, PNorm = 67.4883, GNorm = 0.6836, lr_0 = 6.9968e-04
Loss = 4.8993e-01, PNorm = 67.6893, GNorm = 0.8693, lr_0 = 6.9151e-04
Validation auc = 0.773073
Epoch 17
Loss = 4.6368e-01, PNorm = 67.8981, GNorm = 0.5807, lr_0 = 6.8263e-04
Loss = 4.5507e-01, PNorm = 68.0780, GNorm = 0.5911, lr_0 = 6.7465e-04
Validation auc = 0.802010
Epoch 18
Loss = 4.3738e-01, PNorm = 68.2863, GNorm = 0.7995, lr_0 = 6.6678e-04
Loss = 4.8351e-01, PNorm = 68.5059, GNorm = 0.6192, lr_0 = 6.5899e-04
Validation auc = 0.812976
Epoch 19
Loss = 4.3409e-01, PNorm = 68.7288, GNorm = 0.8690, lr_0 = 6.5129e-04
Loss = 4.7522e-01, PNorm = 68.9377, GNorm = 0.7724, lr_0 = 6.4369e-04
Validation auc = 0.821200
Epoch 20
Loss = 4.0272e-01, PNorm = 69.1454, GNorm = 0.5195, lr_0 = 6.3617e-04
Loss = 4.7087e-01, PNorm = 69.3683, GNorm = 0.9497, lr_0 = 6.2874e-04
Validation auc = 0.785562
Epoch 21
Loss = 3.8891e-01, PNorm = 69.5744, GNorm = 0.5309, lr_0 = 6.2139e-04
Loss = 4.4749e-01, PNorm = 69.7686, GNorm = 0.6239, lr_0 = 6.1414e-04
Validation auc = 0.806884
Epoch 22
Loss = 5.3159e-01, PNorm = 69.9721, GNorm = 1.4875, lr_0 = 6.0696e-04
Loss = 4.0197e-01, PNorm = 70.1621, GNorm = 0.4506, lr_0 = 5.9988e-04
Validation auc = 0.802620
Epoch 23
Loss = 3.5386e-01, PNorm = 70.3793, GNorm = 0.5797, lr_0 = 5.9217e-04
Loss = 3.9779e-01, PNorm = 70.5795, GNorm = 0.7368, lr_0 = 5.8526e-04
Validation auc = 0.815717
Epoch 24
Loss = 4.4166e-01, PNorm = 70.7689, GNorm = 1.0830, lr_0 = 5.7842e-04
Loss = 3.9144e-01, PNorm = 70.9686, GNorm = 0.7185, lr_0 = 5.7167e-04
Loss = 4.3197e-01, PNorm = 71.1686, GNorm = 1.7014, lr_0 = 5.6499e-04
Validation auc = 0.796528
Epoch 25
Loss = 3.7613e-01, PNorm = 71.3630, GNorm = 0.8124, lr_0 = 5.5839e-04
Loss = 4.3368e-01, PNorm = 71.5620, GNorm = 1.5519, lr_0 = 5.5187e-04
Validation auc = 0.794091
Epoch 26
Loss = 3.8885e-01, PNorm = 71.7503, GNorm = 0.5649, lr_0 = 5.4542e-04
Loss = 4.0277e-01, PNorm = 71.9293, GNorm = 1.2126, lr_0 = 5.3905e-04
Validation auc = 0.778252
Epoch 27
Loss = 3.6320e-01, PNorm = 72.1341, GNorm = 0.6075, lr_0 = 5.3276e-04
Loss = 3.6502e-01, PNorm = 72.3062, GNorm = 1.0854, lr_0 = 5.2654e-04
Validation auc = 0.809321
Epoch 28
Loss = 3.6890e-01, PNorm = 72.5093, GNorm = 0.6173, lr_0 = 5.1978e-04
Loss = 3.4405e-01, PNorm = 72.7092, GNorm = 0.7681, lr_0 = 5.1371e-04
Validation auc = 0.795309
Epoch 29
Loss = 3.2366e-01, PNorm = 72.8916, GNorm = 0.5393, lr_0 = 5.0771e-04
Loss = 3.6034e-01, PNorm = 73.0736, GNorm = 0.6255, lr_0 = 5.0178e-04
Validation auc = 0.798660
Epoch 30
Loss = 3.4051e-01, PNorm = 73.2446, GNorm = 0.6147, lr_0 = 4.9592e-04
Loss = 3.6998e-01, PNorm = 73.4223, GNorm = 0.9219, lr_0 = 4.9012e-04
Validation auc = 0.820591
Epoch 31
Loss = 3.1296e-01, PNorm = 73.6074, GNorm = 0.8507, lr_0 = 4.8440e-04
Loss = 3.4951e-01, PNorm = 73.7982, GNorm = 0.8257, lr_0 = 4.7874e-04
Validation auc = 0.816936
Epoch 32
Loss = 3.3183e-01, PNorm = 73.9699, GNorm = 1.0200, lr_0 = 4.7315e-04
Loss = 3.2366e-01, PNorm = 74.1412, GNorm = 0.6743, lr_0 = 4.6763e-04
Validation auc = 0.810235
Epoch 33
Loss = 3.0564e-01, PNorm = 74.2962, GNorm = 0.7387, lr_0 = 4.6216e-04
Loss = 2.8194e-01, PNorm = 74.4771, GNorm = 0.5117, lr_0 = 4.5677e-04
Validation auc = 0.818459
Epoch 34
Loss = 2.6065e-01, PNorm = 74.6646, GNorm = 0.7555, lr_0 = 4.5090e-04
Loss = 3.0901e-01, PNorm = 74.8548, GNorm = 1.7308, lr_0 = 4.4564e-04
Validation auc = 0.812367
Epoch 35
Loss = 2.7818e-01, PNorm = 75.0265, GNorm = 0.8176, lr_0 = 4.4043e-04
Loss = 2.9216e-01, PNorm = 75.2004, GNorm = 0.6966, lr_0 = 4.3529e-04
Validation auc = 0.809321
Epoch 36
Loss = 2.2787e-01, PNorm = 75.3681, GNorm = 0.6114, lr_0 = 4.3020e-04
Loss = 3.0527e-01, PNorm = 75.5467, GNorm = 1.3387, lr_0 = 4.2518e-04
Loss = 3.0078e-01, PNorm = 75.7055, GNorm = 1.1726, lr_0 = 4.2021e-04
Validation auc = 0.806884
Epoch 37
Loss = 2.5635e-01, PNorm = 75.8873, GNorm = 0.7622, lr_0 = 4.1531e-04
Loss = 2.5376e-01, PNorm = 76.0597, GNorm = 0.8292, lr_0 = 4.1045e-04
Validation auc = 0.777033
Epoch 38
Loss = 2.5114e-01, PNorm = 76.2250, GNorm = 0.7816, lr_0 = 4.0566e-04
Loss = 2.7687e-01, PNorm = 76.3901, GNorm = 1.3352, lr_0 = 4.0092e-04
Validation auc = 0.816022
Epoch 39
Loss = 2.5821e-01, PNorm = 76.5640, GNorm = 0.6073, lr_0 = 3.9578e-04
Loss = 2.6268e-01, PNorm = 76.7254, GNorm = 0.7759, lr_0 = 3.9115e-04
Validation auc = 0.780384
Epoch 40
Loss = 2.5768e-01, PNorm = 76.8843, GNorm = 0.5707, lr_0 = 3.8658e-04
Loss = 2.5502e-01, PNorm = 77.0405, GNorm = 0.9383, lr_0 = 3.8207e-04
Validation auc = 0.804143
Epoch 41
Loss = 2.4930e-01, PNorm = 77.1957, GNorm = 1.6745, lr_0 = 3.7761e-04
Loss = 2.2400e-01, PNorm = 77.3288, GNorm = 0.9842, lr_0 = 3.7320e-04
Validation auc = 0.791654
Epoch 42
Loss = 2.1819e-01, PNorm = 77.4541, GNorm = 0.8820, lr_0 = 3.6884e-04
Loss = 2.0994e-01, PNorm = 77.5959, GNorm = 0.8798, lr_0 = 3.6453e-04
Validation auc = 0.798051
Epoch 43
Loss = 2.2140e-01, PNorm = 77.7520, GNorm = 1.4560, lr_0 = 3.6027e-04
Loss = 2.3043e-01, PNorm = 77.9064, GNorm = 0.7617, lr_0 = 3.5607e-04
Validation auc = 0.790131
Epoch 44
Loss = 1.9589e-01, PNorm = 78.0374, GNorm = 0.8239, lr_0 = 3.5191e-04
Loss = 2.1151e-01, PNorm = 78.1631, GNorm = 0.9106, lr_0 = 3.4780e-04
Validation auc = 0.790436
Epoch 45
Loss = 2.2191e-01, PNorm = 78.3093, GNorm = 0.7846, lr_0 = 3.4333e-04
Loss = 2.0360e-01, PNorm = 78.4442, GNorm = 1.4636, lr_0 = 3.3932e-04
Validation auc = 0.803533
Epoch 46
Loss = 1.5174e-01, PNorm = 78.5752, GNorm = 0.5262, lr_0 = 3.3536e-04
Loss = 1.9269e-01, PNorm = 78.7188, GNorm = 0.9545, lr_0 = 3.3144e-04
Validation auc = 0.776729
Epoch 47
Loss = 1.4598e-01, PNorm = 78.8377, GNorm = 1.1624, lr_0 = 3.2757e-04
Loss = 1.7439e-01, PNorm = 78.9695, GNorm = 0.4343, lr_0 = 3.2375e-04
Validation auc = 0.807493
Epoch 48
Loss = 2.0903e-01, PNorm = 79.0960, GNorm = 1.5238, lr_0 = 3.1996e-04
Loss = 2.0177e-01, PNorm = 79.2054, GNorm = 1.2462, lr_0 = 3.1623e-04
Loss = 2.0819e-01, PNorm = 79.3176, GNorm = 1.6396, lr_0 = 3.1253e-04
Validation auc = 0.779165
Epoch 49
Loss = 1.9899e-01, PNorm = 79.4252, GNorm = 0.8788, lr_0 = 3.0888e-04
Loss = 1.8329e-01, PNorm = 79.5297, GNorm = 0.9152, lr_0 = 3.0528e-04
Validation auc = 0.787999
Epoch 50
Loss = 1.6277e-01, PNorm = 79.6358, GNorm = 0.8081, lr_0 = 3.0171e-04
Loss = 1.6645e-01, PNorm = 79.7334, GNorm = 0.8664, lr_0 = 2.9819e-04
Validation auc = 0.805361
Epoch 51
Loss = 1.5025e-01, PNorm = 79.8405, GNorm = 0.6195, lr_0 = 2.9436e-04
Loss = 1.4435e-01, PNorm = 79.9376, GNorm = 0.8665, lr_0 = 2.9092e-04
Validation auc = 0.801097
Epoch 52
Loss = 1.8028e-01, PNorm = 80.0369, GNorm = 0.9197, lr_0 = 2.8752e-04
Loss = 1.6088e-01, PNorm = 80.1406, GNorm = 0.7099, lr_0 = 2.8417e-04
Validation auc = 0.790131
Epoch 53
Loss = 1.6341e-01, PNorm = 80.2361, GNorm = 1.2061, lr_0 = 2.8085e-04
Loss = 1.6417e-01, PNorm = 80.3282, GNorm = 0.9398, lr_0 = 2.7757e-04
Validation auc = 0.777947
Epoch 54
Loss = 1.6474e-01, PNorm = 80.4206, GNorm = 1.0226, lr_0 = 2.7432e-04
Loss = 1.4183e-01, PNorm = 80.5099, GNorm = 0.8341, lr_0 = 2.7112e-04
Validation auc = 0.777033
Epoch 55
Loss = 1.3047e-01, PNorm = 80.6022, GNorm = 1.4828, lr_0 = 2.6795e-04
Loss = 1.6834e-01, PNorm = 80.6829, GNorm = 1.1648, lr_0 = 2.6483e-04
Validation auc = 0.790131
Epoch 56
Loss = 1.6699e-01, PNorm = 80.7708, GNorm = 1.3247, lr_0 = 2.6142e-04
Loss = 1.3067e-01, PNorm = 80.8479, GNorm = 0.9179, lr_0 = 2.5837e-04
Validation auc = 0.795918
Epoch 57
Loss = 1.5020e-01, PNorm = 80.9350, GNorm = 1.0845, lr_0 = 2.5535e-04
Loss = 1.2094e-01, PNorm = 81.0162, GNorm = 0.5855, lr_0 = 2.5237e-04
Validation auc = 0.785867
Epoch 58
Loss = 1.0822e-01, PNorm = 81.0909, GNorm = 0.5745, lr_0 = 2.4942e-04
Loss = 1.4477e-01, PNorm = 81.1647, GNorm = 0.8586, lr_0 = 2.4651e-04
Validation auc = 0.787085
Epoch 59
Loss = 1.0089e-01, PNorm = 81.2388, GNorm = 0.7071, lr_0 = 2.4363e-04
Loss = 1.1940e-01, PNorm = 81.3105, GNorm = 1.1152, lr_0 = 2.4079e-04
Validation auc = 0.779470
Epoch 60
Loss = 9.3589e-02, PNorm = 81.3811, GNorm = 0.6557, lr_0 = 2.3797e-04
Loss = 1.2182e-01, PNorm = 81.4571, GNorm = 1.2024, lr_0 = 2.3520e-04
Loss = 1.2009e-01, PNorm = 81.5208, GNorm = 0.6831, lr_0 = 2.3245e-04
Validation auc = 0.783125
Epoch 61
Loss = 1.0764e-01, PNorm = 81.5824, GNorm = 0.6495, lr_0 = 2.2973e-04
Loss = 1.1155e-01, PNorm = 81.6486, GNorm = 1.0494, lr_0 = 2.2705e-04
Loss = 1.0597e-01, PNorm = 81.6554, GNorm = 0.7935, lr_0 = 2.2678e-04
Validation auc = 0.798051
Epoch 62
Loss = 1.0627e-01, PNorm = 81.7220, GNorm = 0.7002, lr_0 = 2.2414e-04
Loss = 1.0475e-01, PNorm = 81.7835, GNorm = 0.8918, lr_0 = 2.2152e-04
Validation auc = 0.786171
Epoch 63
Loss = 9.5985e-02, PNorm = 81.8390, GNorm = 0.7995, lr_0 = 2.1893e-04
Loss = 1.0012e-01, PNorm = 81.8954, GNorm = 0.9609, lr_0 = 2.1637e-04
Validation auc = 0.789217
Epoch 64
Loss = 1.0657e-01, PNorm = 81.9558, GNorm = 0.4148, lr_0 = 2.1385e-04
Loss = 9.5352e-02, PNorm = 82.0164, GNorm = 0.5639, lr_0 = 2.1135e-04
Validation auc = 0.789826
Epoch 65
Loss = 7.4014e-02, PNorm = 82.0715, GNorm = 0.5998, lr_0 = 2.0888e-04
Loss = 1.0283e-01, PNorm = 82.1298, GNorm = 0.9162, lr_0 = 2.0644e-04
Validation auc = 0.793177
Epoch 66
Loss = 8.4688e-02, PNorm = 82.1927, GNorm = 1.7140, lr_0 = 2.0403e-04
Loss = 1.0835e-01, PNorm = 82.2484, GNorm = 1.0238, lr_0 = 2.0165e-04
Validation auc = 0.787085
Epoch 67
Loss = 7.7369e-02, PNorm = 82.3020, GNorm = 0.5388, lr_0 = 1.9906e-04
Loss = 9.5260e-02, PNorm = 82.3535, GNorm = 0.7569, lr_0 = 1.9673e-04
Validation auc = 0.795918
Epoch 68
Loss = 9.8142e-02, PNorm = 82.4067, GNorm = 0.8531, lr_0 = 1.9444e-04
Loss = 1.3296e-01, PNorm = 82.4660, GNorm = 1.5890, lr_0 = 1.9216e-04
Validation auc = 0.792263
Epoch 69
Loss = 9.4497e-02, PNorm = 82.5278, GNorm = 0.8539, lr_0 = 1.8992e-04
Loss = 8.0794e-02, PNorm = 82.5819, GNorm = 0.7735, lr_0 = 1.8770e-04
Validation auc = 0.789826
Epoch 70
Loss = 1.0157e-01, PNorm = 82.6270, GNorm = 0.7530, lr_0 = 1.8551e-04
Loss = 7.9414e-02, PNorm = 82.6729, GNorm = 0.7114, lr_0 = 1.8334e-04
Validation auc = 0.779470
Epoch 71
Loss = 1.0300e-01, PNorm = 82.7151, GNorm = 0.9227, lr_0 = 1.8120e-04
Loss = 1.0179e-01, PNorm = 82.7531, GNorm = 0.8507, lr_0 = 1.7909e-04
Validation auc = 0.791045
Epoch 72
Loss = 9.1094e-02, PNorm = 82.7952, GNorm = 0.7572, lr_0 = 1.7699e-04
Loss = 8.9562e-02, PNorm = 82.8364, GNorm = 1.3160, lr_0 = 1.7493e-04
Validation auc = 0.793482
Epoch 73
Loss = 4.4784e-02, PNorm = 82.8874, GNorm = 0.7033, lr_0 = 1.7268e-04
Loss = 5.8639e-02, PNorm = 82.9308, GNorm = 0.3944, lr_0 = 1.7066e-04
Loss = 8.7886e-02, PNorm = 82.9716, GNorm = 0.6822, lr_0 = 1.6867e-04
Validation auc = 0.778556
Epoch 74
Loss = 8.0189e-02, PNorm = 83.0115, GNorm = 0.7953, lr_0 = 1.6670e-04
Loss = 8.2999e-02, PNorm = 83.0488, GNorm = 0.9031, lr_0 = 1.6475e-04
Validation auc = 0.784344
Epoch 75
Loss = 6.3217e-02, PNorm = 83.0837, GNorm = 0.3316, lr_0 = 1.6283e-04
Loss = 9.4124e-02, PNorm = 83.1185, GNorm = 1.1263, lr_0 = 1.6093e-04
Validation auc = 0.787694
Epoch 76
Loss = 5.7894e-02, PNorm = 83.1555, GNorm = 0.6710, lr_0 = 1.5905e-04
Loss = 5.4958e-02, PNorm = 83.1912, GNorm = 0.2456, lr_0 = 1.5719e-04
Validation auc = 0.775815
Epoch 77
Loss = 7.5574e-02, PNorm = 83.2258, GNorm = 0.9477, lr_0 = 1.5536e-04
Loss = 7.6989e-02, PNorm = 83.2612, GNorm = 0.9306, lr_0 = 1.5354e-04
Validation auc = 0.776119
Epoch 78
Loss = 5.9323e-02, PNorm = 83.3012, GNorm = 0.4277, lr_0 = 1.5157e-04
Loss = 6.3436e-02, PNorm = 83.3345, GNorm = 0.7446, lr_0 = 1.4980e-04
Validation auc = 0.782973
Epoch 79
Loss = 5.0978e-02, PNorm = 83.3645, GNorm = 1.1716, lr_0 = 1.4805e-04
Loss = 8.2025e-02, PNorm = 83.3947, GNorm = 1.1814, lr_0 = 1.4632e-04
Validation auc = 0.766068
Epoch 80
Loss = 6.1472e-02, PNorm = 83.4300, GNorm = 0.6307, lr_0 = 1.4461e-04
Loss = 7.1689e-02, PNorm = 83.4625, GNorm = 1.4227, lr_0 = 1.4292e-04
Validation auc = 0.778252
Epoch 81
Loss = 5.1393e-02, PNorm = 83.4920, GNorm = 0.5731, lr_0 = 1.4125e-04
Loss = 7.6121e-02, PNorm = 83.5235, GNorm = 0.3647, lr_0 = 1.3960e-04
Validation auc = 0.772160
Epoch 82
Loss = 4.2545e-02, PNorm = 83.5492, GNorm = 1.1103, lr_0 = 1.3797e-04
Loss = 6.8478e-02, PNorm = 83.5799, GNorm = 1.9560, lr_0 = 1.3636e-04
Validation auc = 0.776119
Epoch 83
Loss = 6.0510e-02, PNorm = 83.6098, GNorm = 0.9219, lr_0 = 1.3477e-04
Loss = 6.4787e-02, PNorm = 83.6396, GNorm = 0.5462, lr_0 = 1.3320e-04
Validation auc = 0.763326
Epoch 84
Loss = 5.1065e-02, PNorm = 83.6706, GNorm = 0.8117, lr_0 = 1.3149e-04
Loss = 7.2699e-02, PNorm = 83.6935, GNorm = 0.4015, lr_0 = 1.2995e-04
Validation auc = 0.759671
Epoch 85
Loss = 3.4321e-02, PNorm = 83.7191, GNorm = 0.4752, lr_0 = 1.2843e-04
Loss = 6.6826e-02, PNorm = 83.7493, GNorm = 0.3107, lr_0 = 1.2693e-04
Loss = 4.8408e-02, PNorm = 83.7763, GNorm = 0.4668, lr_0 = 1.2545e-04
Validation auc = 0.775206
Epoch 86
Loss = 4.6376e-02, PNorm = 83.7994, GNorm = 0.6273, lr_0 = 1.2398e-04
Loss = 6.0211e-02, PNorm = 83.8211, GNorm = 0.6923, lr_0 = 1.2254e-04
Validation auc = 0.761194
Epoch 87
Loss = 5.6076e-02, PNorm = 83.8435, GNorm = 0.4714, lr_0 = 1.2111e-04
Loss = 5.4059e-02, PNorm = 83.8641, GNorm = 0.4906, lr_0 = 1.1969e-04
Validation auc = 0.767895
Epoch 88
Loss = 4.8187e-02, PNorm = 83.8858, GNorm = 0.6561, lr_0 = 1.1829e-04
Loss = 5.0792e-02, PNorm = 83.9084, GNorm = 0.3236, lr_0 = 1.1691e-04
Validation auc = 0.767895
Epoch 89
Loss = 5.9898e-02, PNorm = 83.9319, GNorm = 0.6732, lr_0 = 1.1541e-04
Loss = 6.1682e-02, PNorm = 83.9528, GNorm = 1.0014, lr_0 = 1.1406e-04
Validation auc = 0.775510
Epoch 90
Loss = 5.9783e-02, PNorm = 83.9728, GNorm = 0.6415, lr_0 = 1.1273e-04
Loss = 6.7143e-02, PNorm = 83.9949, GNorm = 0.7458, lr_0 = 1.1141e-04
Validation auc = 0.772160
Epoch 91
Loss = 6.9926e-02, PNorm = 84.0177, GNorm = 0.4711, lr_0 = 1.1011e-04
Loss = 6.6741e-02, PNorm = 84.0424, GNorm = 0.6715, lr_0 = 1.0883e-04
Validation auc = 0.767591
Epoch 92
Loss = 5.0688e-02, PNorm = 84.0664, GNorm = 1.1297, lr_0 = 1.0756e-04
Loss = 5.6478e-02, PNorm = 84.0871, GNorm = 0.8446, lr_0 = 1.0630e-04
Validation auc = 0.767591
Epoch 93
Loss = 3.7623e-02, PNorm = 84.1082, GNorm = 0.5563, lr_0 = 1.0506e-04
Loss = 5.1156e-02, PNorm = 84.1278, GNorm = 0.3917, lr_0 = 1.0383e-04
Validation auc = 0.773987
Epoch 94
Loss = 2.8492e-02, PNorm = 84.1444, GNorm = 0.2570, lr_0 = 1.0262e-04
Loss = 4.6514e-02, PNorm = 84.1637, GNorm = 0.7031, lr_0 = 1.0142e-04
Validation auc = 0.765154
Epoch 95
Loss = 6.5590e-02, PNorm = 84.1870, GNorm = 1.2977, lr_0 = 1.0012e-04
Loss = 4.2155e-02, PNorm = 84.2074, GNorm = 0.3736, lr_0 = 1.0000e-04
Validation auc = 0.771246
Epoch 96
Loss = 3.3878e-02, PNorm = 84.2254, GNorm = 0.7040, lr_0 = 1.0000e-04
Loss = 4.4489e-02, PNorm = 84.2424, GNorm = 0.6226, lr_0 = 1.0000e-04
Validation auc = 0.767591
Epoch 97
Loss = 3.5172e-02, PNorm = 84.2588, GNorm = 0.5461, lr_0 = 1.0000e-04
Loss = 4.1241e-02, PNorm = 84.2767, GNorm = 0.5091, lr_0 = 1.0000e-04
Loss = 5.0800e-02, PNorm = 84.2954, GNorm = 1.0288, lr_0 = 1.0000e-04
Validation auc = 0.769723
Epoch 98
Loss = 4.6326e-02, PNorm = 84.3128, GNorm = 0.7711, lr_0 = 1.0000e-04
Loss = 4.9248e-02, PNorm = 84.3300, GNorm = 0.6928, lr_0 = 1.0000e-04
Validation auc = 0.770332
Epoch 99
Loss = 5.9513e-02, PNorm = 84.3471, GNorm = 0.8616, lr_0 = 1.0000e-04
Loss = 4.7657e-02, PNorm = 84.3638, GNorm = 0.4250, lr_0 = 1.0000e-04
Validation auc = 0.772160
Model 4 best validation auc = 0.821200 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 4 test auc = 0.804978
Ensemble test auc = 0.798328
1-fold cross validation
	Seed 0 ==> test auc = 0.798328
Overall test auc = 0.798328 +/- 0.000000
Elapsed time = 0:07:19
