Command line
python /home/jxy/anaconda3/envs/chemprop_1119/bin/chemprop_train --data_path data/train_full.csv --dataset_type classification --save_dir checkpoints_35 --config_path hyperoptfile5 --epochs 100 --separate_test_path data/test2_random_nocanonical.csv --separate_val_path data/val_full.csv --features_generator rdkit_2d_normalized --no_features_scaling
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'hyperoptfile5',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/train_full.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'checkpoints_35',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'data/test2_random_nocanonical.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'data/val_full.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smile'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 46.78%, 1: 53.22%
Total size = 1,041 | train size = 1,041 | val size = 116 | test size = 141
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=100, bias=False)
        (W_h): Linear(in_features=100, out_features=100, bias=False)
        (W_o): Linear(in_features=233, out_features=100, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=100, out_features=1, bias=True)
  )
)
Number of parameters = 78,401
Moving model to cuda
Epoch 0
Loss = 7.5430e-01, PNorm = 22.6181, GNorm = 0.8137, lr_0 = 3.4750e-04
Loss = 7.2277e-01, PNorm = 22.6170, GNorm = 1.2531, lr_0 = 5.7250e-04
Loss = 6.3699e-01, PNorm = 22.6170, GNorm = 0.7210, lr_0 = 5.9500e-04
Validation auc = 0.663722
Epoch 1
Loss = 6.7030e-01, PNorm = 22.6199, GNorm = 1.1939, lr_0 = 8.2000e-04
Loss = 6.5799e-01, PNorm = 22.6292, GNorm = 0.7365, lr_0 = 9.9765e-04
Validation auc = 0.691745
Epoch 2
Loss = 6.6161e-01, PNorm = 22.6378, GNorm = 0.8644, lr_0 = 9.8600e-04
Loss = 6.4800e-01, PNorm = 22.6452, GNorm = 0.8476, lr_0 = 9.7449e-04
Validation auc = 0.733171
Epoch 3
Loss = 6.4552e-01, PNorm = 22.6534, GNorm = 0.6694, lr_0 = 9.6310e-04
Loss = 6.3561e-01, PNorm = 22.6622, GNorm = 1.0124, lr_0 = 9.5186e-04
Validation auc = 0.745050
Epoch 4
Loss = 6.2005e-01, PNorm = 22.6717, GNorm = 0.5869, lr_0 = 9.4074e-04
Loss = 6.3682e-01, PNorm = 22.6820, GNorm = 1.4176, lr_0 = 9.2975e-04
Validation auc = 0.737435
Epoch 5
Loss = 6.5973e-01, PNorm = 22.6906, GNorm = 1.3846, lr_0 = 9.1889e-04
Loss = 6.0904e-01, PNorm = 22.6996, GNorm = 0.5884, lr_0 = 9.0816e-04
Validation auc = 0.746573
Epoch 6
Loss = 6.3862e-01, PNorm = 22.7067, GNorm = 1.1667, lr_0 = 8.9650e-04
Loss = 6.2793e-01, PNorm = 22.7153, GNorm = 0.5896, lr_0 = 8.8603e-04
Validation auc = 0.761803
Epoch 7
Loss = 6.0800e-01, PNorm = 22.7258, GNorm = 0.7919, lr_0 = 8.7568e-04
Loss = 6.2165e-01, PNorm = 22.7357, GNorm = 0.7717, lr_0 = 8.6546e-04
Validation auc = 0.766068
Epoch 8
Loss = 6.1586e-01, PNorm = 22.7471, GNorm = 0.6942, lr_0 = 8.5535e-04
Loss = 6.1857e-01, PNorm = 22.7609, GNorm = 0.5456, lr_0 = 8.4536e-04
Validation auc = 0.771855
Epoch 9
Loss = 6.4037e-01, PNorm = 22.7719, GNorm = 0.5085, lr_0 = 8.3549e-04
Loss = 6.1173e-01, PNorm = 22.7852, GNorm = 0.8127, lr_0 = 8.2573e-04
Validation auc = 0.768504
Epoch 10
Loss = 6.3485e-01, PNorm = 22.8004, GNorm = 0.4685, lr_0 = 8.1608e-04
Loss = 5.9423e-01, PNorm = 22.8146, GNorm = 0.5105, lr_0 = 8.0655e-04
Validation auc = 0.768504
Epoch 11
Loss = 6.8308e-01, PNorm = 22.8341, GNorm = 0.7422, lr_0 = 7.9713e-04
Loss = 5.8353e-01, PNorm = 22.8511, GNorm = 0.8733, lr_0 = 7.8782e-04
Validation auc = 0.776119
Epoch 12
Loss = 5.5065e-01, PNorm = 22.8720, GNorm = 0.4534, lr_0 = 7.7771e-04
Loss = 5.7302e-01, PNorm = 22.8930, GNorm = 0.4874, lr_0 = 7.6862e-04
Loss = 6.0492e-01, PNorm = 22.9075, GNorm = 0.6591, lr_0 = 7.5965e-04
Validation auc = 0.777033
Epoch 13
Loss = 5.8105e-01, PNorm = 22.9247, GNorm = 0.5926, lr_0 = 7.5078e-04
Loss = 5.8281e-01, PNorm = 22.9456, GNorm = 0.6333, lr_0 = 7.4201e-04
Validation auc = 0.786476
Epoch 14
Loss = 5.9606e-01, PNorm = 22.9671, GNorm = 0.5678, lr_0 = 7.3334e-04
Loss = 5.6930e-01, PNorm = 22.9846, GNorm = 0.7098, lr_0 = 7.2478e-04
Validation auc = 0.785562
Epoch 15
Loss = 5.5010e-01, PNorm = 23.0049, GNorm = 0.6178, lr_0 = 7.1631e-04
Loss = 5.5610e-01, PNorm = 23.0281, GNorm = 0.4489, lr_0 = 7.0795e-04
Validation auc = 0.778252
Epoch 16
Loss = 5.7355e-01, PNorm = 23.0464, GNorm = 0.7208, lr_0 = 6.9968e-04
Loss = 5.5924e-01, PNorm = 23.0685, GNorm = 0.5672, lr_0 = 6.9151e-04
Validation auc = 0.787999
Epoch 17
Loss = 5.4836e-01, PNorm = 23.0957, GNorm = 0.5797, lr_0 = 6.8263e-04
Loss = 5.5744e-01, PNorm = 23.1133, GNorm = 0.6004, lr_0 = 6.7465e-04
Validation auc = 0.786476
Epoch 18
Loss = 5.7252e-01, PNorm = 23.1344, GNorm = 0.6198, lr_0 = 6.6678e-04
Loss = 5.4568e-01, PNorm = 23.1626, GNorm = 0.5206, lr_0 = 6.5899e-04
Validation auc = 0.778252
Epoch 19
Loss = 5.2803e-01, PNorm = 23.1800, GNorm = 0.8220, lr_0 = 6.5129e-04
Loss = 5.6433e-01, PNorm = 23.2054, GNorm = 0.7979, lr_0 = 6.4369e-04
Validation auc = 0.778861
Epoch 20
Loss = 5.6779e-01, PNorm = 23.2297, GNorm = 0.5016, lr_0 = 6.3617e-04
Loss = 5.3941e-01, PNorm = 23.2493, GNorm = 0.7069, lr_0 = 6.2874e-04
Validation auc = 0.776119
Epoch 21
Loss = 5.7949e-01, PNorm = 23.2664, GNorm = 0.7147, lr_0 = 6.2139e-04
Loss = 5.3647e-01, PNorm = 23.2834, GNorm = 0.5418, lr_0 = 6.1414e-04
Validation auc = 0.773683
Epoch 22
Loss = 5.5822e-01, PNorm = 23.2967, GNorm = 0.9275, lr_0 = 6.0696e-04
Loss = 5.5129e-01, PNorm = 23.3185, GNorm = 0.5412, lr_0 = 5.9988e-04
Validation auc = 0.765458
Epoch 23
Loss = 5.4077e-01, PNorm = 23.3426, GNorm = 0.4907, lr_0 = 5.9217e-04
Loss = 5.4240e-01, PNorm = 23.3624, GNorm = 0.5911, lr_0 = 5.8526e-04
Validation auc = 0.759671
Epoch 24
Loss = 5.8446e-01, PNorm = 23.3861, GNorm = 0.5482, lr_0 = 5.7842e-04
Loss = 5.2754e-01, PNorm = 23.4070, GNorm = 0.8743, lr_0 = 5.7167e-04
Loss = 5.7260e-01, PNorm = 23.4289, GNorm = 0.7779, lr_0 = 5.6499e-04
Validation auc = 0.757234
Epoch 25
Loss = 5.6436e-01, PNorm = 23.4428, GNorm = 0.7279, lr_0 = 5.5839e-04
Loss = 5.2264e-01, PNorm = 23.4609, GNorm = 0.6052, lr_0 = 5.5187e-04
Validation auc = 0.766981
Epoch 26
Loss = 5.4315e-01, PNorm = 23.4771, GNorm = 1.0559, lr_0 = 5.4542e-04
Loss = 5.1591e-01, PNorm = 23.4975, GNorm = 1.0213, lr_0 = 5.3905e-04
Validation auc = 0.775510
Epoch 27
Loss = 5.2317e-01, PNorm = 23.5207, GNorm = 1.2068, lr_0 = 5.3276e-04
Loss = 5.2909e-01, PNorm = 23.5405, GNorm = 0.6998, lr_0 = 5.2654e-04
Validation auc = 0.776424
Epoch 28
Loss = 5.0575e-01, PNorm = 23.5637, GNorm = 1.0445, lr_0 = 5.1978e-04
Loss = 5.3809e-01, PNorm = 23.5782, GNorm = 0.6271, lr_0 = 5.1371e-04
Validation auc = 0.777947
Epoch 29
Loss = 5.1931e-01, PNorm = 23.5921, GNorm = 0.6618, lr_0 = 5.0771e-04
Loss = 5.2744e-01, PNorm = 23.6082, GNorm = 0.5313, lr_0 = 5.0178e-04
Validation auc = 0.777947
Epoch 30
Loss = 5.3506e-01, PNorm = 23.6243, GNorm = 0.4969, lr_0 = 4.9592e-04
Loss = 5.3943e-01, PNorm = 23.6407, GNorm = 1.0258, lr_0 = 4.9012e-04
Validation auc = 0.769114
Epoch 31
Loss = 5.3123e-01, PNorm = 23.6575, GNorm = 0.4905, lr_0 = 4.8440e-04
Loss = 5.2221e-01, PNorm = 23.6738, GNorm = 0.5442, lr_0 = 4.7874e-04
Validation auc = 0.772160
Epoch 32
Loss = 4.9795e-01, PNorm = 23.6947, GNorm = 0.8015, lr_0 = 4.7315e-04
Loss = 5.0939e-01, PNorm = 23.7164, GNorm = 0.5269, lr_0 = 4.6763e-04
Validation auc = 0.775815
Epoch 33
Loss = 4.9798e-01, PNorm = 23.7324, GNorm = 0.7902, lr_0 = 4.6216e-04
Loss = 5.0268e-01, PNorm = 23.7498, GNorm = 0.5092, lr_0 = 4.5677e-04
Validation auc = 0.776424
Epoch 34
Loss = 5.1129e-01, PNorm = 23.7713, GNorm = 0.7588, lr_0 = 4.5090e-04
Loss = 4.9192e-01, PNorm = 23.7913, GNorm = 0.6287, lr_0 = 4.4564e-04
Validation auc = 0.782211
Epoch 35
Loss = 5.2377e-01, PNorm = 23.8078, GNorm = 0.8462, lr_0 = 4.4043e-04
Loss = 5.0900e-01, PNorm = 23.8236, GNorm = 0.5631, lr_0 = 4.3529e-04
Validation auc = 0.773073
Epoch 36
Loss = 5.1647e-01, PNorm = 23.8417, GNorm = 0.5543, lr_0 = 4.3020e-04
Loss = 5.2593e-01, PNorm = 23.8596, GNorm = 0.9471, lr_0 = 4.2518e-04
Loss = 5.1168e-01, PNorm = 23.8789, GNorm = 0.6407, lr_0 = 4.2021e-04
Validation auc = 0.776119
Epoch 37
Loss = 5.3104e-01, PNorm = 23.8967, GNorm = 0.8078, lr_0 = 4.1531e-04
Loss = 5.2048e-01, PNorm = 23.9110, GNorm = 0.7360, lr_0 = 4.1045e-04
Validation auc = 0.788608
Epoch 38
Loss = 5.1776e-01, PNorm = 23.9260, GNorm = 0.7344, lr_0 = 4.0566e-04
Loss = 5.0532e-01, PNorm = 23.9411, GNorm = 0.7564, lr_0 = 4.0092e-04
Validation auc = 0.777338
Epoch 39
Loss = 5.4294e-01, PNorm = 23.9590, GNorm = 0.7052, lr_0 = 3.9578e-04
Loss = 4.7986e-01, PNorm = 23.9730, GNorm = 0.6054, lr_0 = 3.9115e-04
Validation auc = 0.782211
Epoch 40
Loss = 4.7298e-01, PNorm = 23.9937, GNorm = 0.7441, lr_0 = 3.8658e-04
Loss = 5.0346e-01, PNorm = 24.0072, GNorm = 0.6557, lr_0 = 3.8207e-04
Validation auc = 0.775510
Epoch 41
Loss = 4.7162e-01, PNorm = 24.0222, GNorm = 0.7407, lr_0 = 3.7761e-04
Loss = 4.8860e-01, PNorm = 24.0372, GNorm = 0.5457, lr_0 = 3.7320e-04
Validation auc = 0.778252
Epoch 42
Loss = 4.8205e-01, PNorm = 24.0505, GNorm = 0.6854, lr_0 = 3.6884e-04
Loss = 5.0969e-01, PNorm = 24.0641, GNorm = 0.8383, lr_0 = 3.6453e-04
Validation auc = 0.787085
Epoch 43
Loss = 4.7832e-01, PNorm = 24.0784, GNorm = 0.7368, lr_0 = 3.6027e-04
Loss = 5.3224e-01, PNorm = 24.0951, GNorm = 0.9248, lr_0 = 3.5607e-04
Validation auc = 0.773378
Epoch 44
Loss = 5.1566e-01, PNorm = 24.1100, GNorm = 0.6638, lr_0 = 3.5191e-04
Loss = 4.8057e-01, PNorm = 24.1229, GNorm = 0.5655, lr_0 = 3.4780e-04
Validation auc = 0.775206
Epoch 45
Loss = 4.7678e-01, PNorm = 24.1420, GNorm = 0.6643, lr_0 = 3.4333e-04
Loss = 5.0944e-01, PNorm = 24.1545, GNorm = 0.6802, lr_0 = 3.3932e-04
Validation auc = 0.778861
Epoch 46
Loss = 5.4485e-01, PNorm = 24.1643, GNorm = 0.6429, lr_0 = 3.3536e-04
Loss = 4.6898e-01, PNorm = 24.1775, GNorm = 0.7008, lr_0 = 3.3144e-04
Validation auc = 0.783430
Epoch 47
Loss = 5.4336e-01, PNorm = 24.1920, GNorm = 0.7202, lr_0 = 3.2757e-04
Loss = 4.5821e-01, PNorm = 24.2055, GNorm = 0.6973, lr_0 = 3.2375e-04
Validation auc = 0.785867
Epoch 48
Loss = 4.2496e-01, PNorm = 24.2171, GNorm = 0.8388, lr_0 = 3.1996e-04
Loss = 4.8211e-01, PNorm = 24.2307, GNorm = 1.8415, lr_0 = 3.1623e-04
Loss = 5.0340e-01, PNorm = 24.2408, GNorm = 0.8561, lr_0 = 3.1253e-04
Validation auc = 0.778861
Epoch 49
Loss = 4.8081e-01, PNorm = 24.2529, GNorm = 0.6394, lr_0 = 3.0888e-04
Loss = 4.9137e-01, PNorm = 24.2662, GNorm = 0.7234, lr_0 = 3.0528e-04
Validation auc = 0.775510
Epoch 50
Loss = 4.6739e-01, PNorm = 24.2785, GNorm = 0.6085, lr_0 = 3.0171e-04
Loss = 4.8823e-01, PNorm = 24.2921, GNorm = 0.7119, lr_0 = 2.9819e-04
Validation auc = 0.777947
Epoch 51
Loss = 4.9328e-01, PNorm = 24.3062, GNorm = 1.0395, lr_0 = 2.9436e-04
Loss = 4.8625e-01, PNorm = 24.3195, GNorm = 1.1592, lr_0 = 2.9092e-04
Validation auc = 0.779470
Epoch 52
Loss = 4.5367e-01, PNorm = 24.3299, GNorm = 0.6786, lr_0 = 2.8752e-04
Loss = 4.8040e-01, PNorm = 24.3412, GNorm = 0.8187, lr_0 = 2.8417e-04
Validation auc = 0.782821
Epoch 53
Loss = 5.0905e-01, PNorm = 24.3532, GNorm = 0.5885, lr_0 = 2.8085e-04
Loss = 4.7730e-01, PNorm = 24.3638, GNorm = 0.5339, lr_0 = 2.7757e-04
Validation auc = 0.781298
Epoch 54
Loss = 4.6064e-01, PNorm = 24.3766, GNorm = 0.7108, lr_0 = 2.7432e-04
Loss = 4.8939e-01, PNorm = 24.3864, GNorm = 0.8666, lr_0 = 2.7112e-04
Validation auc = 0.785257
Epoch 55
Loss = 4.6594e-01, PNorm = 24.3981, GNorm = 0.8503, lr_0 = 2.6795e-04
Loss = 4.7676e-01, PNorm = 24.4111, GNorm = 0.8416, lr_0 = 2.6483e-04
Validation auc = 0.776424
Epoch 56
Loss = 4.9736e-01, PNorm = 24.4223, GNorm = 1.3370, lr_0 = 2.6142e-04
Loss = 4.8282e-01, PNorm = 24.4294, GNorm = 0.8223, lr_0 = 2.5837e-04
Validation auc = 0.788913
Epoch 57
Loss = 4.1945e-01, PNorm = 24.4408, GNorm = 0.6557, lr_0 = 2.5535e-04
Loss = 4.5912e-01, PNorm = 24.4533, GNorm = 0.6663, lr_0 = 2.5237e-04
Validation auc = 0.791045
Epoch 58
Loss = 5.0425e-01, PNorm = 24.4639, GNorm = 0.7410, lr_0 = 2.4942e-04
Loss = 4.5341e-01, PNorm = 24.4753, GNorm = 1.0967, lr_0 = 2.4651e-04
Validation auc = 0.788608
Epoch 59
Loss = 4.2539e-01, PNorm = 24.4861, GNorm = 0.6216, lr_0 = 2.4363e-04
Loss = 4.7499e-01, PNorm = 24.4961, GNorm = 0.6943, lr_0 = 2.4079e-04
Validation auc = 0.787390
Epoch 60
Loss = 4.4097e-01, PNorm = 24.5059, GNorm = 0.7946, lr_0 = 2.3797e-04
Loss = 4.4940e-01, PNorm = 24.5147, GNorm = 0.6610, lr_0 = 2.3520e-04
Loss = 4.8042e-01, PNorm = 24.5247, GNorm = 0.8149, lr_0 = 2.3245e-04
Validation auc = 0.791654
Epoch 61
Loss = 4.6477e-01, PNorm = 24.5350, GNorm = 0.8642, lr_0 = 2.2973e-04
Loss = 4.3457e-01, PNorm = 24.5440, GNorm = 1.3065, lr_0 = 2.2705e-04
Loss = 4.3992e-01, PNorm = 24.5448, GNorm = 1.2013, lr_0 = 2.2678e-04
Validation auc = 0.788913
Epoch 62
Loss = 4.5071e-01, PNorm = 24.5554, GNorm = 1.3556, lr_0 = 2.2414e-04
Loss = 4.8802e-01, PNorm = 24.5649, GNorm = 0.6378, lr_0 = 2.2152e-04
Validation auc = 0.786171
Epoch 63
Loss = 4.6216e-01, PNorm = 24.5732, GNorm = 1.4418, lr_0 = 2.1893e-04
Loss = 4.6224e-01, PNorm = 24.5839, GNorm = 1.3118, lr_0 = 2.1637e-04
Validation auc = 0.792263
Epoch 64
Loss = 4.9494e-01, PNorm = 24.5934, GNorm = 1.2680, lr_0 = 2.1385e-04
Loss = 4.1898e-01, PNorm = 24.6029, GNorm = 0.7599, lr_0 = 2.1135e-04
Validation auc = 0.790436
Epoch 65
Loss = 4.7809e-01, PNorm = 24.6125, GNorm = 1.0576, lr_0 = 2.0888e-04
Loss = 4.3036e-01, PNorm = 24.6204, GNorm = 0.7581, lr_0 = 2.0644e-04
Validation auc = 0.793177
Epoch 66
Loss = 4.4798e-01, PNorm = 24.6282, GNorm = 0.8938, lr_0 = 2.0403e-04
Loss = 4.4436e-01, PNorm = 24.6367, GNorm = 0.7389, lr_0 = 2.0165e-04
Validation auc = 0.784648
Epoch 67
Loss = 4.5508e-01, PNorm = 24.6456, GNorm = 0.9919, lr_0 = 1.9906e-04
Loss = 4.2098e-01, PNorm = 24.6544, GNorm = 0.8941, lr_0 = 1.9673e-04
Validation auc = 0.785867
Epoch 68
Loss = 4.4580e-01, PNorm = 24.6600, GNorm = 0.8244, lr_0 = 1.9444e-04
Loss = 4.5606e-01, PNorm = 24.6673, GNorm = 0.9548, lr_0 = 1.9216e-04
Validation auc = 0.783734
Epoch 69
Loss = 4.7745e-01, PNorm = 24.6750, GNorm = 0.7019, lr_0 = 1.8992e-04
Loss = 4.6129e-01, PNorm = 24.6811, GNorm = 1.1069, lr_0 = 1.8770e-04
Validation auc = 0.789217
Epoch 70
Loss = 4.7254e-01, PNorm = 24.6884, GNorm = 0.7330, lr_0 = 1.8551e-04
Loss = 4.6581e-01, PNorm = 24.6953, GNorm = 0.8838, lr_0 = 1.8334e-04
Validation auc = 0.792263
Epoch 71
Loss = 4.5474e-01, PNorm = 24.7035, GNorm = 0.6113, lr_0 = 1.8120e-04
Loss = 4.5834e-01, PNorm = 24.7121, GNorm = 0.9671, lr_0 = 1.7909e-04
Validation auc = 0.787085
Epoch 72
Loss = 4.8118e-01, PNorm = 24.7196, GNorm = 0.9002, lr_0 = 1.7699e-04
Loss = 4.4614e-01, PNorm = 24.7254, GNorm = 1.0588, lr_0 = 1.7493e-04
Validation auc = 0.788608
Epoch 73
Loss = 3.8609e-01, PNorm = 24.7330, GNorm = 1.2809, lr_0 = 1.7268e-04
Loss = 4.4747e-01, PNorm = 24.7405, GNorm = 0.8030, lr_0 = 1.7066e-04
Loss = 4.3936e-01, PNorm = 24.7472, GNorm = 0.6552, lr_0 = 1.6867e-04
Validation auc = 0.788608
Epoch 74
Loss = 4.4093e-01, PNorm = 24.7549, GNorm = 0.9946, lr_0 = 1.6670e-04
Loss = 4.3221e-01, PNorm = 24.7605, GNorm = 0.6767, lr_0 = 1.6475e-04
Validation auc = 0.791045
Epoch 75
Loss = 4.5539e-01, PNorm = 24.7668, GNorm = 1.3782, lr_0 = 1.6283e-04
Loss = 4.1613e-01, PNorm = 24.7728, GNorm = 0.9692, lr_0 = 1.6093e-04
Validation auc = 0.794091
Epoch 76
Loss = 4.4448e-01, PNorm = 24.7788, GNorm = 0.9519, lr_0 = 1.5905e-04
Loss = 4.4266e-01, PNorm = 24.7835, GNorm = 0.7332, lr_0 = 1.5719e-04
Validation auc = 0.789217
Epoch 77
Loss = 4.2994e-01, PNorm = 24.7897, GNorm = 1.4193, lr_0 = 1.5536e-04
Loss = 4.4315e-01, PNorm = 24.7961, GNorm = 1.1221, lr_0 = 1.5354e-04
Validation auc = 0.793177
Epoch 78
Loss = 4.1237e-01, PNorm = 24.8031, GNorm = 0.7543, lr_0 = 1.5157e-04
Loss = 4.3248e-01, PNorm = 24.8089, GNorm = 0.7514, lr_0 = 1.4980e-04
Validation auc = 0.794091
Epoch 79
Loss = 3.8836e-01, PNorm = 24.8152, GNorm = 0.7181, lr_0 = 1.4805e-04
Loss = 4.5920e-01, PNorm = 24.8222, GNorm = 1.6128, lr_0 = 1.4632e-04
Validation auc = 0.796528
Epoch 80
Loss = 4.2193e-01, PNorm = 24.8274, GNorm = 0.7743, lr_0 = 1.4461e-04
Loss = 4.4154e-01, PNorm = 24.8339, GNorm = 1.0359, lr_0 = 1.4292e-04
Validation auc = 0.799878
Epoch 81
Loss = 4.7749e-01, PNorm = 24.8397, GNorm = 1.1678, lr_0 = 1.4125e-04
Loss = 4.3264e-01, PNorm = 24.8462, GNorm = 0.8972, lr_0 = 1.3960e-04
Validation auc = 0.795614
Epoch 82
Loss = 3.8560e-01, PNorm = 24.8508, GNorm = 1.1747, lr_0 = 1.3797e-04
Loss = 4.7380e-01, PNorm = 24.8555, GNorm = 1.6784, lr_0 = 1.3636e-04
Validation auc = 0.797137
Epoch 83
Loss = 5.3500e-01, PNorm = 24.8590, GNorm = 1.2130, lr_0 = 1.3477e-04
Loss = 4.2010e-01, PNorm = 24.8634, GNorm = 1.3538, lr_0 = 1.3320e-04
Validation auc = 0.796832
Epoch 84
Loss = 3.9247e-01, PNorm = 24.8695, GNorm = 0.9222, lr_0 = 1.3149e-04
Loss = 4.3119e-01, PNorm = 24.8751, GNorm = 0.9489, lr_0 = 1.2995e-04
Validation auc = 0.798660
Epoch 85
Loss = 3.4796e-01, PNorm = 24.8803, GNorm = 0.6670, lr_0 = 1.2843e-04
Loss = 3.8638e-01, PNorm = 24.8861, GNorm = 1.3123, lr_0 = 1.2693e-04
Loss = 4.6206e-01, PNorm = 24.8916, GNorm = 0.9225, lr_0 = 1.2545e-04
Validation auc = 0.797137
Epoch 86
Loss = 4.3219e-01, PNorm = 24.8947, GNorm = 0.8195, lr_0 = 1.2398e-04
Loss = 4.6620e-01, PNorm = 24.8989, GNorm = 1.0708, lr_0 = 1.2254e-04
Validation auc = 0.801401
Epoch 87
Loss = 4.2972e-01, PNorm = 24.9040, GNorm = 0.8116, lr_0 = 1.2111e-04
Loss = 4.2082e-01, PNorm = 24.9085, GNorm = 0.9353, lr_0 = 1.1969e-04
Validation auc = 0.801097
Epoch 88
Loss = 4.2196e-01, PNorm = 24.9129, GNorm = 0.8073, lr_0 = 1.1829e-04
Loss = 4.3925e-01, PNorm = 24.9175, GNorm = 0.9652, lr_0 = 1.1691e-04
Validation auc = 0.800487
Epoch 89
Loss = 4.0802e-01, PNorm = 24.9221, GNorm = 0.6949, lr_0 = 1.1541e-04
Loss = 4.5225e-01, PNorm = 24.9258, GNorm = 1.0357, lr_0 = 1.1406e-04
Validation auc = 0.799574
Epoch 90
Loss = 4.4004e-01, PNorm = 24.9289, GNorm = 0.8812, lr_0 = 1.1273e-04
Loss = 4.6527e-01, PNorm = 24.9326, GNorm = 0.8935, lr_0 = 1.1141e-04
Validation auc = 0.799269
Epoch 91
Loss = 4.7910e-01, PNorm = 24.9362, GNorm = 0.7915, lr_0 = 1.1011e-04
Loss = 4.3372e-01, PNorm = 24.9396, GNorm = 1.2011, lr_0 = 1.0883e-04
Validation auc = 0.798964
Epoch 92
Loss = 4.3660e-01, PNorm = 24.9443, GNorm = 0.7366, lr_0 = 1.0756e-04
Loss = 4.0764e-01, PNorm = 24.9487, GNorm = 0.7723, lr_0 = 1.0630e-04
Validation auc = 0.798964
Epoch 93
Loss = 3.7725e-01, PNorm = 24.9532, GNorm = 1.2508, lr_0 = 1.0506e-04
Loss = 4.4016e-01, PNorm = 24.9578, GNorm = 0.8413, lr_0 = 1.0383e-04
Validation auc = 0.796223
Epoch 94
Loss = 4.3959e-01, PNorm = 24.9614, GNorm = 1.0691, lr_0 = 1.0262e-04
Loss = 4.0570e-01, PNorm = 24.9648, GNorm = 0.7912, lr_0 = 1.0142e-04
Validation auc = 0.799269
Epoch 95
Loss = 3.7654e-01, PNorm = 24.9690, GNorm = 1.0024, lr_0 = 1.0012e-04
Loss = 4.3342e-01, PNorm = 24.9731, GNorm = 1.3253, lr_0 = 1.0000e-04
Validation auc = 0.801706
Epoch 96
Loss = 3.7425e-01, PNorm = 24.9763, GNorm = 0.9624, lr_0 = 1.0000e-04
Loss = 4.3126e-01, PNorm = 24.9800, GNorm = 1.2176, lr_0 = 1.0000e-04
Validation auc = 0.798660
Epoch 97
Loss = 3.6957e-01, PNorm = 24.9839, GNorm = 0.7932, lr_0 = 1.0000e-04
Loss = 4.1457e-01, PNorm = 24.9879, GNorm = 1.3028, lr_0 = 1.0000e-04
Loss = 4.4614e-01, PNorm = 24.9905, GNorm = 1.6170, lr_0 = 1.0000e-04
Validation auc = 0.800792
Epoch 98
Loss = 3.9562e-01, PNorm = 24.9937, GNorm = 0.6094, lr_0 = 1.0000e-04
Loss = 4.1910e-01, PNorm = 24.9972, GNorm = 0.7010, lr_0 = 1.0000e-04
Validation auc = 0.802924
Epoch 99
Loss = 3.9764e-01, PNorm = 25.0018, GNorm = 0.8797, lr_0 = 1.0000e-04
Loss = 4.2934e-01, PNorm = 25.0057, GNorm = 0.7071, lr_0 = 1.0000e-04
Validation auc = 0.800183
Model 0 best validation auc = 0.802924 on epoch 98
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.828436
Ensemble test auc = 0.828436
1-fold cross validation
	Seed 0 ==> test auc = 0.828436
Overall test auc = 0.828436 +/- 0.000000
Elapsed time = 0:02:14
Command line
python /home/jxy/anaconda3/envs/chemprop_1119/bin/chemprop_train --data_path data/train_full.csv --dataset_type classification --save_dir checkpoints_35 --config_path hyperoptfile5 --epochs 100 --separate_test_path data/test_random_nocanonical.csv --separate_val_path data/val_full.csv --features_generator rdkit_2d_normalized --no_features_scaling
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'hyperoptfile5',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/train_full.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'checkpoints_35',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'data/test_random_nocanonical.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'data/val_full.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smile'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 46.78%, 1: 53.22%
Total size = 1,041 | train size = 1,041 | val size = 116 | test size = 290
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.2, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=100, bias=False)
        (W_h): Linear(in_features=100, out_features=100, bias=False)
        (W_o): Linear(in_features=233, out_features=100, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=100, out_features=1, bias=True)
  )
)
Number of parameters = 78,401
Moving model to cuda
Epoch 0
Loss = 7.5430e-01, PNorm = 22.6181, GNorm = 0.8137, lr_0 = 3.4750e-04
Loss = 7.2277e-01, PNorm = 22.6170, GNorm = 1.2531, lr_0 = 5.7250e-04
Loss = 6.3699e-01, PNorm = 22.6170, GNorm = 0.7210, lr_0 = 5.9500e-04
Validation auc = 0.663722
Epoch 1
Loss = 6.7030e-01, PNorm = 22.6199, GNorm = 1.1939, lr_0 = 8.2000e-04
Loss = 6.5799e-01, PNorm = 22.6292, GNorm = 0.7365, lr_0 = 9.9765e-04
Validation auc = 0.691745
Epoch 2
Loss = 6.6161e-01, PNorm = 22.6378, GNorm = 0.8644, lr_0 = 9.8600e-04
Loss = 6.4800e-01, PNorm = 22.6452, GNorm = 0.8476, lr_0 = 9.7449e-04
Validation auc = 0.733171
Epoch 3
Loss = 6.4552e-01, PNorm = 22.6534, GNorm = 0.6694, lr_0 = 9.6310e-04
Loss = 6.3561e-01, PNorm = 22.6622, GNorm = 1.0124, lr_0 = 9.5186e-04
Validation auc = 0.745050
Epoch 4
Loss = 6.2005e-01, PNorm = 22.6717, GNorm = 0.5869, lr_0 = 9.4074e-04
Loss = 6.3682e-01, PNorm = 22.6820, GNorm = 1.4176, lr_0 = 9.2975e-04
Validation auc = 0.737435
Epoch 5
Loss = 6.5973e-01, PNorm = 22.6906, GNorm = 1.3846, lr_0 = 9.1889e-04
Loss = 6.0904e-01, PNorm = 22.6996, GNorm = 0.5884, lr_0 = 9.0816e-04
Validation auc = 0.746573
Epoch 6
Loss = 6.3862e-01, PNorm = 22.7067, GNorm = 1.1667, lr_0 = 8.9650e-04
Loss = 6.2793e-01, PNorm = 22.7153, GNorm = 0.5896, lr_0 = 8.8603e-04
Validation auc = 0.761803
Epoch 7
Loss = 6.0800e-01, PNorm = 22.7258, GNorm = 0.7919, lr_0 = 8.7568e-04
Loss = 6.2165e-01, PNorm = 22.7357, GNorm = 0.7717, lr_0 = 8.6546e-04
Validation auc = 0.766068
Epoch 8
Loss = 6.1586e-01, PNorm = 22.7471, GNorm = 0.6942, lr_0 = 8.5535e-04
Loss = 6.1857e-01, PNorm = 22.7609, GNorm = 0.5456, lr_0 = 8.4536e-04
Validation auc = 0.771855
Epoch 9
Loss = 6.4037e-01, PNorm = 22.7719, GNorm = 0.5085, lr_0 = 8.3549e-04
Loss = 6.1173e-01, PNorm = 22.7852, GNorm = 0.8127, lr_0 = 8.2573e-04
Validation auc = 0.768504
Epoch 10
Loss = 6.3485e-01, PNorm = 22.8004, GNorm = 0.4685, lr_0 = 8.1608e-04
Loss = 5.9423e-01, PNorm = 22.8146, GNorm = 0.5105, lr_0 = 8.0655e-04
Validation auc = 0.768504
Epoch 11
Loss = 6.8308e-01, PNorm = 22.8341, GNorm = 0.7422, lr_0 = 7.9713e-04
Loss = 5.8353e-01, PNorm = 22.8511, GNorm = 0.8733, lr_0 = 7.8782e-04
Validation auc = 0.776119
Epoch 12
Loss = 5.5065e-01, PNorm = 22.8720, GNorm = 0.4534, lr_0 = 7.7771e-04
Loss = 5.7302e-01, PNorm = 22.8930, GNorm = 0.4874, lr_0 = 7.6862e-04
Loss = 6.0492e-01, PNorm = 22.9075, GNorm = 0.6591, lr_0 = 7.5965e-04
Validation auc = 0.777033
Epoch 13
Loss = 5.8105e-01, PNorm = 22.9247, GNorm = 0.5926, lr_0 = 7.5078e-04
Loss = 5.8281e-01, PNorm = 22.9456, GNorm = 0.6333, lr_0 = 7.4201e-04
Validation auc = 0.786476
Epoch 14
Loss = 5.9606e-01, PNorm = 22.9671, GNorm = 0.5678, lr_0 = 7.3334e-04
Loss = 5.6930e-01, PNorm = 22.9846, GNorm = 0.7098, lr_0 = 7.2478e-04
Validation auc = 0.785562
Epoch 15
Loss = 5.5010e-01, PNorm = 23.0049, GNorm = 0.6178, lr_0 = 7.1631e-04
Loss = 5.5610e-01, PNorm = 23.0281, GNorm = 0.4489, lr_0 = 7.0795e-04
Validation auc = 0.778252
Epoch 16
Loss = 5.7355e-01, PNorm = 23.0464, GNorm = 0.7208, lr_0 = 6.9968e-04
Loss = 5.5924e-01, PNorm = 23.0685, GNorm = 0.5672, lr_0 = 6.9151e-04
Validation auc = 0.787999
Epoch 17
Loss = 5.4836e-01, PNorm = 23.0957, GNorm = 0.5797, lr_0 = 6.8263e-04
Loss = 5.5744e-01, PNorm = 23.1133, GNorm = 0.6004, lr_0 = 6.7465e-04
Validation auc = 0.786476
Epoch 18
Loss = 5.7252e-01, PNorm = 23.1344, GNorm = 0.6198, lr_0 = 6.6678e-04
Loss = 5.4568e-01, PNorm = 23.1626, GNorm = 0.5206, lr_0 = 6.5899e-04
Validation auc = 0.778252
Epoch 19
Loss = 5.2803e-01, PNorm = 23.1800, GNorm = 0.8220, lr_0 = 6.5129e-04
Loss = 5.6433e-01, PNorm = 23.2054, GNorm = 0.7979, lr_0 = 6.4369e-04
Validation auc = 0.778861
Epoch 20
Loss = 5.6779e-01, PNorm = 23.2297, GNorm = 0.5016, lr_0 = 6.3617e-04
Loss = 5.3941e-01, PNorm = 23.2493, GNorm = 0.7069, lr_0 = 6.2874e-04
Validation auc = 0.776119
Epoch 21
Loss = 5.7949e-01, PNorm = 23.2664, GNorm = 0.7147, lr_0 = 6.2139e-04
Loss = 5.3647e-01, PNorm = 23.2834, GNorm = 0.5418, lr_0 = 6.1414e-04
Validation auc = 0.773683
Epoch 22
Loss = 5.5822e-01, PNorm = 23.2967, GNorm = 0.9275, lr_0 = 6.0696e-04
Loss = 5.5129e-01, PNorm = 23.3185, GNorm = 0.5412, lr_0 = 5.9988e-04
Validation auc = 0.765458
Epoch 23
Loss = 5.4077e-01, PNorm = 23.3426, GNorm = 0.4907, lr_0 = 5.9217e-04
Loss = 5.4240e-01, PNorm = 23.3624, GNorm = 0.5911, lr_0 = 5.8526e-04
Validation auc = 0.759671
Epoch 24
Loss = 5.8446e-01, PNorm = 23.3861, GNorm = 0.5482, lr_0 = 5.7842e-04
Loss = 5.2754e-01, PNorm = 23.4070, GNorm = 0.8743, lr_0 = 5.7167e-04
Loss = 5.7260e-01, PNorm = 23.4289, GNorm = 0.7779, lr_0 = 5.6499e-04
Validation auc = 0.757234
Epoch 25
Loss = 5.6436e-01, PNorm = 23.4428, GNorm = 0.7279, lr_0 = 5.5839e-04
Loss = 5.2264e-01, PNorm = 23.4609, GNorm = 0.6052, lr_0 = 5.5187e-04
Validation auc = 0.766981
Epoch 26
Loss = 5.4315e-01, PNorm = 23.4771, GNorm = 1.0559, lr_0 = 5.4542e-04
Loss = 5.1591e-01, PNorm = 23.4975, GNorm = 1.0213, lr_0 = 5.3905e-04
Validation auc = 0.775510
Epoch 27
Loss = 5.2317e-01, PNorm = 23.5207, GNorm = 1.2068, lr_0 = 5.3276e-04
Loss = 5.2909e-01, PNorm = 23.5405, GNorm = 0.6998, lr_0 = 5.2654e-04
Validation auc = 0.776424
Epoch 28
Loss = 5.0575e-01, PNorm = 23.5637, GNorm = 1.0445, lr_0 = 5.1978e-04
Loss = 5.3809e-01, PNorm = 23.5782, GNorm = 0.6271, lr_0 = 5.1371e-04
Validation auc = 0.777947
Epoch 29
Loss = 5.1931e-01, PNorm = 23.5921, GNorm = 0.6618, lr_0 = 5.0771e-04
Loss = 5.2744e-01, PNorm = 23.6082, GNorm = 0.5313, lr_0 = 5.0178e-04
Validation auc = 0.777947
Epoch 30
Loss = 5.3506e-01, PNorm = 23.6243, GNorm = 0.4969, lr_0 = 4.9592e-04
Loss = 5.3943e-01, PNorm = 23.6407, GNorm = 1.0258, lr_0 = 4.9012e-04
Validation auc = 0.769114
Epoch 31
Loss = 5.3123e-01, PNorm = 23.6575, GNorm = 0.4905, lr_0 = 4.8440e-04
Loss = 5.2221e-01, PNorm = 23.6738, GNorm = 0.5442, lr_0 = 4.7874e-04
Validation auc = 0.772160
Epoch 32
Loss = 4.9795e-01, PNorm = 23.6947, GNorm = 0.8015, lr_0 = 4.7315e-04
Loss = 5.0939e-01, PNorm = 23.7164, GNorm = 0.5269, lr_0 = 4.6763e-04
Validation auc = 0.775815
Epoch 33
Loss = 4.9798e-01, PNorm = 23.7324, GNorm = 0.7902, lr_0 = 4.6216e-04
Loss = 5.0268e-01, PNorm = 23.7498, GNorm = 0.5092, lr_0 = 4.5677e-04
Validation auc = 0.776424
Epoch 34
Loss = 5.1129e-01, PNorm = 23.7713, GNorm = 0.7588, lr_0 = 4.5090e-04
Loss = 4.9192e-01, PNorm = 23.7913, GNorm = 0.6287, lr_0 = 4.4564e-04
Validation auc = 0.782211
Epoch 35
Loss = 5.2377e-01, PNorm = 23.8078, GNorm = 0.8462, lr_0 = 4.4043e-04
Loss = 5.0900e-01, PNorm = 23.8236, GNorm = 0.5631, lr_0 = 4.3529e-04
Validation auc = 0.773073
Epoch 36
Loss = 5.1647e-01, PNorm = 23.8417, GNorm = 0.5543, lr_0 = 4.3020e-04
Loss = 5.2593e-01, PNorm = 23.8596, GNorm = 0.9471, lr_0 = 4.2518e-04
Loss = 5.1168e-01, PNorm = 23.8789, GNorm = 0.6407, lr_0 = 4.2021e-04
Validation auc = 0.776119
Epoch 37
Loss = 5.3104e-01, PNorm = 23.8967, GNorm = 0.8078, lr_0 = 4.1531e-04
Loss = 5.2048e-01, PNorm = 23.9110, GNorm = 0.7360, lr_0 = 4.1045e-04
Validation auc = 0.788608
Epoch 38
Loss = 5.1776e-01, PNorm = 23.9260, GNorm = 0.7344, lr_0 = 4.0566e-04
Loss = 5.0532e-01, PNorm = 23.9411, GNorm = 0.7564, lr_0 = 4.0092e-04
Validation auc = 0.777338
Epoch 39
Loss = 5.4294e-01, PNorm = 23.9590, GNorm = 0.7052, lr_0 = 3.9578e-04
Loss = 4.7986e-01, PNorm = 23.9730, GNorm = 0.6054, lr_0 = 3.9115e-04
Validation auc = 0.782211
Epoch 40
Loss = 4.7298e-01, PNorm = 23.9937, GNorm = 0.7441, lr_0 = 3.8658e-04
Loss = 5.0346e-01, PNorm = 24.0072, GNorm = 0.6557, lr_0 = 3.8207e-04
Validation auc = 0.775510
Epoch 41
Loss = 4.7162e-01, PNorm = 24.0222, GNorm = 0.7407, lr_0 = 3.7761e-04
Loss = 4.8860e-01, PNorm = 24.0372, GNorm = 0.5457, lr_0 = 3.7320e-04
Validation auc = 0.778252
Epoch 42
Loss = 4.8205e-01, PNorm = 24.0505, GNorm = 0.6854, lr_0 = 3.6884e-04
Loss = 5.0969e-01, PNorm = 24.0641, GNorm = 0.8383, lr_0 = 3.6453e-04
Validation auc = 0.787085
Epoch 43
Loss = 4.7832e-01, PNorm = 24.0784, GNorm = 0.7368, lr_0 = 3.6027e-04
Loss = 5.3224e-01, PNorm = 24.0951, GNorm = 0.9248, lr_0 = 3.5607e-04
Validation auc = 0.773378
Epoch 44
Loss = 5.1566e-01, PNorm = 24.1100, GNorm = 0.6638, lr_0 = 3.5191e-04
Loss = 4.8057e-01, PNorm = 24.1229, GNorm = 0.5655, lr_0 = 3.4780e-04
Validation auc = 0.775206
Epoch 45
Loss = 4.7678e-01, PNorm = 24.1420, GNorm = 0.6643, lr_0 = 3.4333e-04
Loss = 5.0944e-01, PNorm = 24.1545, GNorm = 0.6802, lr_0 = 3.3932e-04
Validation auc = 0.778861
Epoch 46
Loss = 5.4485e-01, PNorm = 24.1643, GNorm = 0.6429, lr_0 = 3.3536e-04
Loss = 4.6898e-01, PNorm = 24.1775, GNorm = 0.7008, lr_0 = 3.3144e-04
Validation auc = 0.783430
Epoch 47
Loss = 5.4336e-01, PNorm = 24.1920, GNorm = 0.7202, lr_0 = 3.2757e-04
Loss = 4.5821e-01, PNorm = 24.2055, GNorm = 0.6973, lr_0 = 3.2375e-04
Validation auc = 0.785867
Epoch 48
Loss = 4.2496e-01, PNorm = 24.2171, GNorm = 0.8388, lr_0 = 3.1996e-04
Loss = 4.8211e-01, PNorm = 24.2307, GNorm = 1.8415, lr_0 = 3.1623e-04
Loss = 5.0340e-01, PNorm = 24.2408, GNorm = 0.8561, lr_0 = 3.1253e-04
Validation auc = 0.778861
Epoch 49
Loss = 4.8081e-01, PNorm = 24.2529, GNorm = 0.6394, lr_0 = 3.0888e-04
Loss = 4.9137e-01, PNorm = 24.2662, GNorm = 0.7234, lr_0 = 3.0528e-04
Validation auc = 0.775510
Epoch 50
Loss = 4.6739e-01, PNorm = 24.2785, GNorm = 0.6085, lr_0 = 3.0171e-04
Loss = 4.8823e-01, PNorm = 24.2921, GNorm = 0.7119, lr_0 = 2.9819e-04
Validation auc = 0.777947
Epoch 51
Loss = 4.9328e-01, PNorm = 24.3062, GNorm = 1.0395, lr_0 = 2.9436e-04
Loss = 4.8625e-01, PNorm = 24.3195, GNorm = 1.1592, lr_0 = 2.9092e-04
Validation auc = 0.779470
Epoch 52
Loss = 4.5367e-01, PNorm = 24.3299, GNorm = 0.6786, lr_0 = 2.8752e-04
Loss = 4.8040e-01, PNorm = 24.3412, GNorm = 0.8187, lr_0 = 2.8417e-04
Validation auc = 0.782821
Epoch 53
Loss = 5.0905e-01, PNorm = 24.3532, GNorm = 0.5885, lr_0 = 2.8085e-04
Loss = 4.7730e-01, PNorm = 24.3638, GNorm = 0.5339, lr_0 = 2.7757e-04
Validation auc = 0.781298
Epoch 54
Loss = 4.6064e-01, PNorm = 24.3766, GNorm = 0.7108, lr_0 = 2.7432e-04
Loss = 4.8939e-01, PNorm = 24.3864, GNorm = 0.8666, lr_0 = 2.7112e-04
Validation auc = 0.785257
Epoch 55
Loss = 4.6594e-01, PNorm = 24.3981, GNorm = 0.8503, lr_0 = 2.6795e-04
Loss = 4.7676e-01, PNorm = 24.4111, GNorm = 0.8416, lr_0 = 2.6483e-04
Validation auc = 0.776424
Epoch 56
Loss = 4.9736e-01, PNorm = 24.4223, GNorm = 1.3370, lr_0 = 2.6142e-04
Loss = 4.8282e-01, PNorm = 24.4294, GNorm = 0.8223, lr_0 = 2.5837e-04
Validation auc = 0.788913
Epoch 57
Loss = 4.1945e-01, PNorm = 24.4408, GNorm = 0.6557, lr_0 = 2.5535e-04
Loss = 4.5912e-01, PNorm = 24.4533, GNorm = 0.6663, lr_0 = 2.5237e-04
Validation auc = 0.791045
Epoch 58
Loss = 5.0425e-01, PNorm = 24.4639, GNorm = 0.7410, lr_0 = 2.4942e-04
Loss = 4.5341e-01, PNorm = 24.4753, GNorm = 1.0967, lr_0 = 2.4651e-04
Validation auc = 0.788608
Epoch 59
Loss = 4.2539e-01, PNorm = 24.4861, GNorm = 0.6216, lr_0 = 2.4363e-04
Loss = 4.7499e-01, PNorm = 24.4961, GNorm = 0.6943, lr_0 = 2.4079e-04
Validation auc = 0.787390
Epoch 60
Loss = 4.4097e-01, PNorm = 24.5059, GNorm = 0.7946, lr_0 = 2.3797e-04
Loss = 4.4940e-01, PNorm = 24.5147, GNorm = 0.6610, lr_0 = 2.3520e-04
Loss = 4.8042e-01, PNorm = 24.5247, GNorm = 0.8149, lr_0 = 2.3245e-04
Validation auc = 0.791654
Epoch 61
Loss = 4.6477e-01, PNorm = 24.5350, GNorm = 0.8642, lr_0 = 2.2973e-04
Loss = 4.3457e-01, PNorm = 24.5440, GNorm = 1.3065, lr_0 = 2.2705e-04
Loss = 4.3992e-01, PNorm = 24.5448, GNorm = 1.2013, lr_0 = 2.2678e-04
Validation auc = 0.788913
Epoch 62
Loss = 4.5071e-01, PNorm = 24.5554, GNorm = 1.3556, lr_0 = 2.2414e-04
Loss = 4.8802e-01, PNorm = 24.5649, GNorm = 0.6378, lr_0 = 2.2152e-04
Validation auc = 0.786171
Epoch 63
Loss = 4.6216e-01, PNorm = 24.5732, GNorm = 1.4418, lr_0 = 2.1893e-04
Loss = 4.6224e-01, PNorm = 24.5839, GNorm = 1.3118, lr_0 = 2.1637e-04
Validation auc = 0.792263
Epoch 64
Loss = 4.9494e-01, PNorm = 24.5934, GNorm = 1.2680, lr_0 = 2.1385e-04
Loss = 4.1898e-01, PNorm = 24.6029, GNorm = 0.7599, lr_0 = 2.1135e-04
Validation auc = 0.790436
Epoch 65
Loss = 4.7809e-01, PNorm = 24.6125, GNorm = 1.0576, lr_0 = 2.0888e-04
Loss = 4.3036e-01, PNorm = 24.6204, GNorm = 0.7581, lr_0 = 2.0644e-04
Validation auc = 0.793177
Epoch 66
Loss = 4.4798e-01, PNorm = 24.6282, GNorm = 0.8938, lr_0 = 2.0403e-04
Loss = 4.4436e-01, PNorm = 24.6367, GNorm = 0.7389, lr_0 = 2.0165e-04
Validation auc = 0.784648
Epoch 67
Loss = 4.5508e-01, PNorm = 24.6456, GNorm = 0.9919, lr_0 = 1.9906e-04
Loss = 4.2098e-01, PNorm = 24.6544, GNorm = 0.8941, lr_0 = 1.9673e-04
Validation auc = 0.785867
Epoch 68
Loss = 4.4580e-01, PNorm = 24.6600, GNorm = 0.8244, lr_0 = 1.9444e-04
Loss = 4.5606e-01, PNorm = 24.6673, GNorm = 0.9548, lr_0 = 1.9216e-04
Validation auc = 0.783734
Epoch 69
Loss = 4.7745e-01, PNorm = 24.6750, GNorm = 0.7019, lr_0 = 1.8992e-04
Loss = 4.6129e-01, PNorm = 24.6811, GNorm = 1.1069, lr_0 = 1.8770e-04
Validation auc = 0.789217
Epoch 70
Loss = 4.7254e-01, PNorm = 24.6884, GNorm = 0.7330, lr_0 = 1.8551e-04
Loss = 4.6581e-01, PNorm = 24.6953, GNorm = 0.8838, lr_0 = 1.8334e-04
Validation auc = 0.792263
Epoch 71
Loss = 4.5474e-01, PNorm = 24.7035, GNorm = 0.6113, lr_0 = 1.8120e-04
Loss = 4.5834e-01, PNorm = 24.7121, GNorm = 0.9671, lr_0 = 1.7909e-04
Validation auc = 0.787085
Epoch 72
Loss = 4.8118e-01, PNorm = 24.7196, GNorm = 0.9002, lr_0 = 1.7699e-04
Loss = 4.4614e-01, PNorm = 24.7254, GNorm = 1.0588, lr_0 = 1.7493e-04
Validation auc = 0.788608
Epoch 73
Loss = 3.8609e-01, PNorm = 24.7330, GNorm = 1.2809, lr_0 = 1.7268e-04
Loss = 4.4747e-01, PNorm = 24.7405, GNorm = 0.8030, lr_0 = 1.7066e-04
Loss = 4.3936e-01, PNorm = 24.7472, GNorm = 0.6552, lr_0 = 1.6867e-04
Validation auc = 0.788608
Epoch 74
Loss = 4.4093e-01, PNorm = 24.7549, GNorm = 0.9946, lr_0 = 1.6670e-04
Loss = 4.3221e-01, PNorm = 24.7605, GNorm = 0.6767, lr_0 = 1.6475e-04
Validation auc = 0.791045
Epoch 75
Loss = 4.5539e-01, PNorm = 24.7668, GNorm = 1.3782, lr_0 = 1.6283e-04
Loss = 4.1613e-01, PNorm = 24.7728, GNorm = 0.9692, lr_0 = 1.6093e-04
Validation auc = 0.794091
Epoch 76
Loss = 4.4448e-01, PNorm = 24.7788, GNorm = 0.9519, lr_0 = 1.5905e-04
Loss = 4.4266e-01, PNorm = 24.7835, GNorm = 0.7332, lr_0 = 1.5719e-04
Validation auc = 0.789217
Epoch 77
Loss = 4.2994e-01, PNorm = 24.7897, GNorm = 1.4193, lr_0 = 1.5536e-04
Loss = 4.4315e-01, PNorm = 24.7961, GNorm = 1.1221, lr_0 = 1.5354e-04
Validation auc = 0.793177
Epoch 78
Loss = 4.1237e-01, PNorm = 24.8031, GNorm = 0.7543, lr_0 = 1.5157e-04
Loss = 4.3248e-01, PNorm = 24.8089, GNorm = 0.7514, lr_0 = 1.4980e-04
Validation auc = 0.794091
Epoch 79
Loss = 3.8836e-01, PNorm = 24.8152, GNorm = 0.7181, lr_0 = 1.4805e-04
Loss = 4.5920e-01, PNorm = 24.8222, GNorm = 1.6128, lr_0 = 1.4632e-04
Validation auc = 0.796528
Epoch 80
Loss = 4.2193e-01, PNorm = 24.8274, GNorm = 0.7743, lr_0 = 1.4461e-04
Loss = 4.4154e-01, PNorm = 24.8339, GNorm = 1.0359, lr_0 = 1.4292e-04
Validation auc = 0.799878
Epoch 81
Loss = 4.7749e-01, PNorm = 24.8397, GNorm = 1.1678, lr_0 = 1.4125e-04
Loss = 4.3264e-01, PNorm = 24.8462, GNorm = 0.8972, lr_0 = 1.3960e-04
Validation auc = 0.795614
Epoch 82
Loss = 3.8560e-01, PNorm = 24.8508, GNorm = 1.1747, lr_0 = 1.3797e-04
Loss = 4.7380e-01, PNorm = 24.8555, GNorm = 1.6784, lr_0 = 1.3636e-04
Validation auc = 0.797137
Epoch 83
Loss = 5.3500e-01, PNorm = 24.8590, GNorm = 1.2130, lr_0 = 1.3477e-04
Loss = 4.2010e-01, PNorm = 24.8634, GNorm = 1.3538, lr_0 = 1.3320e-04
Validation auc = 0.796832
Epoch 84
Loss = 3.9247e-01, PNorm = 24.8695, GNorm = 0.9222, lr_0 = 1.3149e-04
Loss = 4.3119e-01, PNorm = 24.8751, GNorm = 0.9489, lr_0 = 1.2995e-04
Validation auc = 0.798660
Epoch 85
Loss = 3.4796e-01, PNorm = 24.8803, GNorm = 0.6670, lr_0 = 1.2843e-04
Loss = 3.8638e-01, PNorm = 24.8861, GNorm = 1.3123, lr_0 = 1.2693e-04
Loss = 4.6206e-01, PNorm = 24.8916, GNorm = 0.9225, lr_0 = 1.2545e-04
Validation auc = 0.797137
Epoch 86
Loss = 4.3219e-01, PNorm = 24.8947, GNorm = 0.8195, lr_0 = 1.2398e-04
Loss = 4.6620e-01, PNorm = 24.8989, GNorm = 1.0708, lr_0 = 1.2254e-04
Validation auc = 0.801401
Epoch 87
Loss = 4.2972e-01, PNorm = 24.9040, GNorm = 0.8116, lr_0 = 1.2111e-04
Loss = 4.2082e-01, PNorm = 24.9085, GNorm = 0.9353, lr_0 = 1.1969e-04
Validation auc = 0.801097
Epoch 88
Loss = 4.2196e-01, PNorm = 24.9129, GNorm = 0.8073, lr_0 = 1.1829e-04
Loss = 4.3925e-01, PNorm = 24.9175, GNorm = 0.9652, lr_0 = 1.1691e-04
Validation auc = 0.800487
Epoch 89
Loss = 4.0802e-01, PNorm = 24.9221, GNorm = 0.6949, lr_0 = 1.1541e-04
Loss = 4.5225e-01, PNorm = 24.9258, GNorm = 1.0357, lr_0 = 1.1406e-04
Validation auc = 0.799574
Epoch 90
Loss = 4.4004e-01, PNorm = 24.9289, GNorm = 0.8812, lr_0 = 1.1273e-04
Loss = 4.6527e-01, PNorm = 24.9326, GNorm = 0.8935, lr_0 = 1.1141e-04
Validation auc = 0.799269
Epoch 91
Loss = 4.7910e-01, PNorm = 24.9362, GNorm = 0.7915, lr_0 = 1.1011e-04
Loss = 4.3372e-01, PNorm = 24.9396, GNorm = 1.2011, lr_0 = 1.0883e-04
Validation auc = 0.798964
Epoch 92
Loss = 4.3660e-01, PNorm = 24.9443, GNorm = 0.7366, lr_0 = 1.0756e-04
Loss = 4.0764e-01, PNorm = 24.9487, GNorm = 0.7723, lr_0 = 1.0630e-04
Validation auc = 0.798964
Epoch 93
Loss = 3.7725e-01, PNorm = 24.9532, GNorm = 1.2508, lr_0 = 1.0506e-04
Loss = 4.4016e-01, PNorm = 24.9578, GNorm = 0.8413, lr_0 = 1.0383e-04
Validation auc = 0.796223
Epoch 94
Loss = 4.3959e-01, PNorm = 24.9614, GNorm = 1.0691, lr_0 = 1.0262e-04
Loss = 4.0570e-01, PNorm = 24.9648, GNorm = 0.7912, lr_0 = 1.0142e-04
Validation auc = 0.799269
Epoch 95
Loss = 3.7654e-01, PNorm = 24.9690, GNorm = 1.0024, lr_0 = 1.0012e-04
Loss = 4.3342e-01, PNorm = 24.9731, GNorm = 1.3253, lr_0 = 1.0000e-04
Validation auc = 0.801706
Epoch 96
Loss = 3.7425e-01, PNorm = 24.9763, GNorm = 0.9624, lr_0 = 1.0000e-04
Loss = 4.3126e-01, PNorm = 24.9800, GNorm = 1.2176, lr_0 = 1.0000e-04
Validation auc = 0.798660
Epoch 97
Loss = 3.6957e-01, PNorm = 24.9839, GNorm = 0.7932, lr_0 = 1.0000e-04
Loss = 4.1457e-01, PNorm = 24.9879, GNorm = 1.3028, lr_0 = 1.0000e-04
Loss = 4.4614e-01, PNorm = 24.9905, GNorm = 1.6170, lr_0 = 1.0000e-04
Validation auc = 0.800792
Epoch 98
Loss = 3.9562e-01, PNorm = 24.9937, GNorm = 0.6094, lr_0 = 1.0000e-04
Loss = 4.1910e-01, PNorm = 24.9972, GNorm = 0.7010, lr_0 = 1.0000e-04
Validation auc = 0.802924
Epoch 99
Loss = 3.9764e-01, PNorm = 25.0018, GNorm = 0.8797, lr_0 = 1.0000e-04
Loss = 4.2934e-01, PNorm = 25.0057, GNorm = 0.7071, lr_0 = 1.0000e-04
Validation auc = 0.800183
Model 0 best validation auc = 0.802924 on epoch 98
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.784293
Ensemble test auc = 0.784293
1-fold cross validation
	Seed 0 ==> test auc = 0.784293
Overall test auc = 0.784293 +/- 0.000000
Elapsed time = 0:02:18
