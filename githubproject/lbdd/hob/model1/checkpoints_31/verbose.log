Command line
python /home/jxy/anaconda3/envs/chemprop_1119/bin/chemprop_train --data_path data/train_full.csv --dataset_type classification --save_dir checkpoints_31 --config_path hyperoptfile3 --epochs 100 --separate_test_path data/test_random_nocanonical.csv --separate_val_path data/val_full.csv --features_generator rdkit_2d_normalized --no_features_scaling
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'hyperoptfile3',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/train_full.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'checkpoints_31',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'data/test_random_nocanonical.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'data/val_full.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smile'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 46.78%, 1: 53.22%
Total size = 1,041 | train size = 1,041 | val size = 116 | test size = 290
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 890,001
Moving model to cuda
Epoch 0
Loss = 7.0239e-01, PNorm = 38.6545, GNorm = 0.8366, lr_0 = 3.4750e-04
Loss = 6.8586e-01, PNorm = 38.6647, GNorm = 2.3548, lr_0 = 5.7250e-04
Loss = 6.5871e-01, PNorm = 38.6661, GNorm = 0.7821, lr_0 = 5.9500e-04
Validation auc = 0.687786
Epoch 1
Loss = 6.6523e-01, PNorm = 38.6886, GNorm = 1.0218, lr_0 = 8.2000e-04
Loss = 6.7216e-01, PNorm = 38.7187, GNorm = 0.6483, lr_0 = 9.9765e-04
Validation auc = 0.686263
Epoch 2
Loss = 6.9226e-01, PNorm = 38.7520, GNorm = 1.4985, lr_0 = 9.8600e-04
Loss = 6.7141e-01, PNorm = 38.7857, GNorm = 0.6556, lr_0 = 9.7449e-04
Validation auc = 0.730429
Epoch 3
Loss = 6.5737e-01, PNorm = 38.8165, GNorm = 0.6552, lr_0 = 9.6310e-04
Loss = 6.5415e-01, PNorm = 38.8413, GNorm = 1.0453, lr_0 = 9.5186e-04
Validation auc = 0.717941
Epoch 4
Loss = 6.2268e-01, PNorm = 38.8652, GNorm = 0.4593, lr_0 = 9.4074e-04
Loss = 6.4956e-01, PNorm = 38.8934, GNorm = 1.3389, lr_0 = 9.2975e-04
Validation auc = 0.731039
Epoch 5
Loss = 6.7194e-01, PNorm = 38.9243, GNorm = 1.0844, lr_0 = 9.1889e-04
Loss = 6.1372e-01, PNorm = 38.9618, GNorm = 0.4472, lr_0 = 9.0816e-04
Validation auc = 0.739872
Epoch 6
Loss = 6.5309e-01, PNorm = 39.0024, GNorm = 1.5601, lr_0 = 8.9650e-04
Loss = 6.3802e-01, PNorm = 39.0280, GNorm = 0.4905, lr_0 = 8.8603e-04
Validation auc = 0.754188
Epoch 7
Loss = 6.3873e-01, PNorm = 39.0584, GNorm = 0.7384, lr_0 = 8.7568e-04
Loss = 6.3820e-01, PNorm = 39.0895, GNorm = 0.9805, lr_0 = 8.6546e-04
Validation auc = 0.741090
Epoch 8
Loss = 6.3897e-01, PNorm = 39.1144, GNorm = 0.5289, lr_0 = 8.5535e-04
Loss = 6.2266e-01, PNorm = 39.1466, GNorm = 0.5831, lr_0 = 8.4536e-04
Validation auc = 0.747182
Epoch 9
Loss = 6.5584e-01, PNorm = 39.1762, GNorm = 0.4494, lr_0 = 8.3549e-04
Loss = 6.2086e-01, PNorm = 39.2081, GNorm = 0.8081, lr_0 = 8.2573e-04
Validation auc = 0.745964
Epoch 10
Loss = 6.4532e-01, PNorm = 39.2425, GNorm = 0.3934, lr_0 = 8.1608e-04
Loss = 6.0794e-01, PNorm = 39.2832, GNorm = 0.4673, lr_0 = 8.0655e-04
Validation auc = 0.738044
Epoch 11
Loss = 6.6132e-01, PNorm = 39.3251, GNorm = 0.6333, lr_0 = 7.9713e-04
Loss = 5.9872e-01, PNorm = 39.3652, GNorm = 0.7889, lr_0 = 7.8782e-04
Validation auc = 0.747487
Epoch 12
Loss = 5.5373e-01, PNorm = 39.4184, GNorm = 0.4390, lr_0 = 7.7771e-04
Loss = 6.1307e-01, PNorm = 39.4718, GNorm = 0.4776, lr_0 = 7.6862e-04
Loss = 6.1558e-01, PNorm = 39.5229, GNorm = 0.6556, lr_0 = 7.5965e-04
Validation auc = 0.760889
Epoch 13
Loss = 6.0847e-01, PNorm = 39.5712, GNorm = 0.4797, lr_0 = 7.5078e-04
Loss = 6.0888e-01, PNorm = 39.6208, GNorm = 0.4898, lr_0 = 7.4201e-04
Validation auc = 0.741700
Epoch 14
Loss = 5.9644e-01, PNorm = 39.6796, GNorm = 0.6149, lr_0 = 7.3334e-04
Loss = 6.1981e-01, PNorm = 39.7356, GNorm = 0.9755, lr_0 = 7.2478e-04
Validation auc = 0.747792
Epoch 15
Loss = 5.9136e-01, PNorm = 39.7996, GNorm = 0.6916, lr_0 = 7.1631e-04
Loss = 5.8636e-01, PNorm = 39.8679, GNorm = 0.4969, lr_0 = 7.0795e-04
Validation auc = 0.742613
Epoch 16
Loss = 5.8558e-01, PNorm = 39.9343, GNorm = 0.6460, lr_0 = 6.9968e-04
Loss = 5.8356e-01, PNorm = 40.0079, GNorm = 0.7843, lr_0 = 6.9151e-04
Validation auc = 0.750228
Epoch 17
Loss = 5.6625e-01, PNorm = 40.0769, GNorm = 0.4911, lr_0 = 6.8263e-04
Loss = 5.8922e-01, PNorm = 40.1417, GNorm = 1.0040, lr_0 = 6.7465e-04
Validation auc = 0.759062
Epoch 18
Loss = 5.7546e-01, PNorm = 40.2093, GNorm = 0.6758, lr_0 = 6.6678e-04
Loss = 5.3203e-01, PNorm = 40.2844, GNorm = 0.5571, lr_0 = 6.5899e-04
Validation auc = 0.763631
Epoch 19
Loss = 5.4664e-01, PNorm = 40.3544, GNorm = 1.2362, lr_0 = 6.5129e-04
Loss = 5.9201e-01, PNorm = 40.4382, GNorm = 0.8292, lr_0 = 6.4369e-04
Validation auc = 0.747792
Epoch 20
Loss = 5.6796e-01, PNorm = 40.5073, GNorm = 0.4179, lr_0 = 6.3617e-04
Loss = 5.6777e-01, PNorm = 40.5799, GNorm = 1.7119, lr_0 = 6.2874e-04
Validation auc = 0.747182
Epoch 21
Loss = 5.3626e-01, PNorm = 40.6402, GNorm = 0.6392, lr_0 = 6.2139e-04
Loss = 5.4528e-01, PNorm = 40.7018, GNorm = 0.5871, lr_0 = 6.1414e-04
Validation auc = 0.766677
Epoch 22
Loss = 5.6124e-01, PNorm = 40.7627, GNorm = 1.0687, lr_0 = 6.0696e-04
Loss = 5.1096e-01, PNorm = 40.8301, GNorm = 0.8047, lr_0 = 5.9988e-04
Validation auc = 0.759671
Epoch 23
Loss = 5.4548e-01, PNorm = 40.8986, GNorm = 0.5547, lr_0 = 5.9217e-04
Loss = 5.3715e-01, PNorm = 40.9658, GNorm = 0.7586, lr_0 = 5.8526e-04
Validation auc = 0.751142
Epoch 24
Loss = 5.1450e-01, PNorm = 41.0391, GNorm = 0.8407, lr_0 = 5.7842e-04
Loss = 5.1265e-01, PNorm = 41.0997, GNorm = 1.5165, lr_0 = 5.7167e-04
Loss = 5.4650e-01, PNorm = 41.1650, GNorm = 0.7455, lr_0 = 5.6499e-04
Validation auc = 0.762108
Epoch 25
Loss = 5.3497e-01, PNorm = 41.2395, GNorm = 0.5895, lr_0 = 5.5839e-04
Loss = 5.3163e-01, PNorm = 41.3118, GNorm = 1.2650, lr_0 = 5.5187e-04
Validation auc = 0.740786
Epoch 26
Loss = 5.3697e-01, PNorm = 41.3747, GNorm = 0.7232, lr_0 = 5.4542e-04
Loss = 5.3305e-01, PNorm = 41.4395, GNorm = 1.1233, lr_0 = 5.3905e-04
Validation auc = 0.753884
Epoch 27
Loss = 5.2558e-01, PNorm = 41.4996, GNorm = 1.5485, lr_0 = 5.3276e-04
Loss = 4.9848e-01, PNorm = 41.5535, GNorm = 0.5774, lr_0 = 5.2654e-04
Validation auc = 0.733171
Epoch 28
Loss = 4.6021e-01, PNorm = 41.6213, GNorm = 0.8584, lr_0 = 5.1978e-04
Loss = 5.0083e-01, PNorm = 41.6802, GNorm = 1.3001, lr_0 = 5.1371e-04
Validation auc = 0.777947
Epoch 29
Loss = 5.0198e-01, PNorm = 41.7451, GNorm = 0.7491, lr_0 = 5.0771e-04
Loss = 5.0144e-01, PNorm = 41.8098, GNorm = 0.6104, lr_0 = 5.0178e-04
Validation auc = 0.747182
Epoch 30
Loss = 4.2972e-01, PNorm = 41.8829, GNorm = 1.3231, lr_0 = 4.9592e-04
Loss = 5.0153e-01, PNorm = 41.9490, GNorm = 1.5797, lr_0 = 4.9012e-04
Validation auc = 0.755711
Epoch 31
Loss = 4.5938e-01, PNorm = 42.0186, GNorm = 0.9455, lr_0 = 4.8440e-04
Loss = 4.4976e-01, PNorm = 42.0860, GNorm = 0.9599, lr_0 = 4.7874e-04
Validation auc = 0.753274
Epoch 32
Loss = 3.9513e-01, PNorm = 42.1499, GNorm = 1.5893, lr_0 = 4.7315e-04
Loss = 4.5210e-01, PNorm = 42.2128, GNorm = 2.9791, lr_0 = 4.6763e-04
Validation auc = 0.753884
Epoch 33
Loss = 4.5060e-01, PNorm = 42.2755, GNorm = 0.9189, lr_0 = 4.6216e-04
Loss = 4.3947e-01, PNorm = 42.3396, GNorm = 0.9833, lr_0 = 4.5677e-04
Validation auc = 0.745050
Epoch 34
Loss = 4.3316e-01, PNorm = 42.4056, GNorm = 0.9515, lr_0 = 4.5090e-04
Loss = 4.1068e-01, PNorm = 42.4724, GNorm = 1.4612, lr_0 = 4.4564e-04
Validation auc = 0.736826
Epoch 35
Loss = 4.0064e-01, PNorm = 42.5420, GNorm = 0.6781, lr_0 = 4.4043e-04
Loss = 4.2290e-01, PNorm = 42.6066, GNorm = 1.0401, lr_0 = 4.3529e-04
Validation auc = 0.760585
Epoch 36
Loss = 6.0692e-01, PNorm = 42.6651, GNorm = 3.1914, lr_0 = 4.3020e-04
Loss = 4.6281e-01, PNorm = 42.7221, GNorm = 1.8316, lr_0 = 4.2518e-04
Loss = 4.1688e-01, PNorm = 42.7835, GNorm = 1.6292, lr_0 = 4.2021e-04
Validation auc = 0.751751
Epoch 37
Loss = 4.2227e-01, PNorm = 42.8406, GNorm = 1.3468, lr_0 = 4.1531e-04
Loss = 3.9681e-01, PNorm = 42.8942, GNorm = 1.0365, lr_0 = 4.1045e-04
Validation auc = 0.759671
Epoch 38
Loss = 4.3830e-01, PNorm = 42.9518, GNorm = 1.1502, lr_0 = 4.0566e-04
Loss = 3.6479e-01, PNorm = 43.0124, GNorm = 1.0097, lr_0 = 4.0092e-04
Validation auc = 0.752970
Epoch 39
Loss = 3.9153e-01, PNorm = 43.0778, GNorm = 1.6562, lr_0 = 3.9578e-04
Loss = 3.6511e-01, PNorm = 43.1378, GNorm = 1.4583, lr_0 = 3.9115e-04
Validation auc = 0.756320
Epoch 40
Loss = 3.5149e-01, PNorm = 43.1942, GNorm = 0.9638, lr_0 = 3.8658e-04
Loss = 3.8395e-01, PNorm = 43.2535, GNorm = 1.3629, lr_0 = 3.8207e-04
Validation auc = 0.776424
Epoch 41
Loss = 3.4721e-01, PNorm = 43.3101, GNorm = 1.6701, lr_0 = 3.7761e-04
Loss = 3.8292e-01, PNorm = 43.3638, GNorm = 1.4015, lr_0 = 3.7320e-04
Validation auc = 0.773073
Epoch 42
Loss = 3.7186e-01, PNorm = 43.4194, GNorm = 1.8347, lr_0 = 3.6884e-04
Loss = 3.7588e-01, PNorm = 43.4724, GNorm = 2.2898, lr_0 = 3.6453e-04
Validation auc = 0.798355
Epoch 43
Loss = 3.5164e-01, PNorm = 43.5256, GNorm = 1.5005, lr_0 = 3.6027e-04
Loss = 3.7716e-01, PNorm = 43.5800, GNorm = 2.0400, lr_0 = 3.5607e-04
Validation auc = 0.760280
Epoch 44
Loss = 3.8160e-01, PNorm = 43.6317, GNorm = 1.7071, lr_0 = 3.5191e-04
Loss = 3.3026e-01, PNorm = 43.6735, GNorm = 1.6757, lr_0 = 3.4780e-04
Validation auc = 0.780079
Epoch 45
Loss = 3.4314e-01, PNorm = 43.7209, GNorm = 1.6237, lr_0 = 3.4333e-04
Loss = 3.6148e-01, PNorm = 43.7716, GNorm = 1.3016, lr_0 = 3.3932e-04
Validation auc = 0.777642
Epoch 46
Loss = 3.5284e-01, PNorm = 43.8171, GNorm = 1.6154, lr_0 = 3.3536e-04
Loss = 3.3784e-01, PNorm = 43.8613, GNorm = 1.0571, lr_0 = 3.3144e-04
Validation auc = 0.788303
Epoch 47
Loss = 3.4163e-01, PNorm = 43.9045, GNorm = 1.5879, lr_0 = 3.2757e-04
Loss = 2.9295e-01, PNorm = 43.9530, GNorm = 2.1554, lr_0 = 3.2375e-04
Validation auc = 0.769114
Epoch 48
Loss = 2.6865e-01, PNorm = 43.9949, GNorm = 1.5173, lr_0 = 3.1996e-04
Loss = 3.0355e-01, PNorm = 44.0385, GNorm = 2.9605, lr_0 = 3.1623e-04
Loss = 2.9091e-01, PNorm = 44.0769, GNorm = 2.4593, lr_0 = 3.1253e-04
Validation auc = 0.768809
Epoch 49
Loss = 2.7811e-01, PNorm = 44.1176, GNorm = 1.5112, lr_0 = 3.0888e-04
Loss = 3.3622e-01, PNorm = 44.1535, GNorm = 1.1171, lr_0 = 3.0528e-04
Validation auc = 0.776119
Epoch 50
Loss = 2.8723e-01, PNorm = 44.1896, GNorm = 1.3098, lr_0 = 3.0171e-04
Loss = 3.0666e-01, PNorm = 44.2267, GNorm = 2.1463, lr_0 = 2.9819e-04
Validation auc = 0.772769
Epoch 51
Loss = 2.8194e-01, PNorm = 44.2692, GNorm = 3.2836, lr_0 = 2.9436e-04
Loss = 2.9196e-01, PNorm = 44.3028, GNorm = 1.6048, lr_0 = 2.9092e-04
Validation auc = 0.772769
Epoch 52
Loss = 2.6360e-01, PNorm = 44.3344, GNorm = 1.8812, lr_0 = 2.8752e-04
Loss = 2.6091e-01, PNorm = 44.3725, GNorm = 1.8176, lr_0 = 2.8417e-04
Validation auc = 0.775815
Epoch 53
Loss = 2.7508e-01, PNorm = 44.4083, GNorm = 1.6948, lr_0 = 2.8085e-04
Loss = 2.4495e-01, PNorm = 44.4434, GNorm = 1.9336, lr_0 = 2.7757e-04
Validation auc = 0.778556
Epoch 54
Loss = 2.4739e-01, PNorm = 44.4752, GNorm = 2.4673, lr_0 = 2.7432e-04
Loss = 2.8194e-01, PNorm = 44.5077, GNorm = 2.2036, lr_0 = 2.7112e-04
Validation auc = 0.764849
Epoch 55
Loss = 2.2591e-01, PNorm = 44.5415, GNorm = 2.7150, lr_0 = 2.6795e-04
Loss = 2.4800e-01, PNorm = 44.5739, GNorm = 1.6015, lr_0 = 2.6483e-04
Validation auc = 0.775815
Epoch 56
Loss = 2.4774e-01, PNorm = 44.6090, GNorm = 1.6156, lr_0 = 2.6142e-04
Loss = 2.2077e-01, PNorm = 44.6411, GNorm = 1.6777, lr_0 = 2.5837e-04
Validation auc = 0.778556
Epoch 57
Loss = 2.3311e-01, PNorm = 44.6708, GNorm = 1.5669, lr_0 = 2.5535e-04
Loss = 2.5564e-01, PNorm = 44.6992, GNorm = 1.5190, lr_0 = 2.5237e-04
Validation auc = 0.763022
Epoch 58
Loss = 2.5893e-01, PNorm = 44.7270, GNorm = 1.6435, lr_0 = 2.4942e-04
Loss = 2.4576e-01, PNorm = 44.7517, GNorm = 2.4274, lr_0 = 2.4651e-04
Validation auc = 0.778861
Epoch 59
Loss = 2.1055e-01, PNorm = 44.7788, GNorm = 1.5735, lr_0 = 2.4363e-04
Loss = 2.4740e-01, PNorm = 44.8068, GNorm = 1.3953, lr_0 = 2.4079e-04
Validation auc = 0.767895
Epoch 60
Loss = 1.4647e-01, PNorm = 44.8349, GNorm = 1.5961, lr_0 = 2.3797e-04
Loss = 2.1161e-01, PNorm = 44.8597, GNorm = 1.9041, lr_0 = 2.3520e-04
Loss = 2.1519e-01, PNorm = 44.8865, GNorm = 2.1000, lr_0 = 2.3245e-04
Validation auc = 0.759062
Epoch 61
Loss = 2.3828e-01, PNorm = 44.9119, GNorm = 3.3138, lr_0 = 2.2973e-04
Loss = 2.1643e-01, PNorm = 44.9319, GNorm = 2.9273, lr_0 = 2.2705e-04
Loss = 1.7002e-01, PNorm = 44.9340, GNorm = 1.8167, lr_0 = 2.2678e-04
Validation auc = 0.773683
Epoch 62
Loss = 2.1535e-01, PNorm = 44.9536, GNorm = 1.8209, lr_0 = 2.2414e-04
Loss = 2.5879e-01, PNorm = 44.9746, GNorm = 2.7216, lr_0 = 2.2152e-04
Validation auc = 0.774292
Epoch 63
Loss = 2.3845e-01, PNorm = 44.9989, GNorm = 3.2117, lr_0 = 2.1893e-04
Loss = 1.9471e-01, PNorm = 45.0229, GNorm = 1.2794, lr_0 = 2.1637e-04
Validation auc = 0.767438
Epoch 64
Loss = 1.9579e-01, PNorm = 45.0448, GNorm = 1.0905, lr_0 = 2.1385e-04
Loss = 2.3393e-01, PNorm = 45.0664, GNorm = 3.2609, lr_0 = 2.1135e-04
Validation auc = 0.770027
Epoch 65
Loss = 2.3744e-01, PNorm = 45.0851, GNorm = 2.6163, lr_0 = 2.0888e-04
Loss = 1.7918e-01, PNorm = 45.1050, GNorm = 1.6229, lr_0 = 2.0644e-04
Validation auc = 0.778252
Epoch 66
Loss = 1.8494e-01, PNorm = 45.1277, GNorm = 3.3646, lr_0 = 2.0403e-04
Loss = 1.7824e-01, PNorm = 45.1494, GNorm = 2.0994, lr_0 = 2.0165e-04
Validation auc = 0.776119
Epoch 67
Loss = 1.9958e-01, PNorm = 45.1709, GNorm = 2.1163, lr_0 = 1.9906e-04
Loss = 1.7038e-01, PNorm = 45.1902, GNorm = 2.2759, lr_0 = 1.9673e-04
Validation auc = 0.775510
Epoch 68
Loss = 1.7211e-01, PNorm = 45.2084, GNorm = 2.8687, lr_0 = 1.9444e-04
Loss = 2.2473e-01, PNorm = 45.2253, GNorm = 5.1254, lr_0 = 1.9216e-04
Validation auc = 0.782821
Epoch 69
Loss = 2.2247e-01, PNorm = 45.2449, GNorm = 1.6894, lr_0 = 1.8992e-04
Loss = 1.7960e-01, PNorm = 45.2638, GNorm = 2.0358, lr_0 = 1.8770e-04
Validation auc = 0.769114
Epoch 70
Loss = 1.4976e-01, PNorm = 45.2786, GNorm = 1.3905, lr_0 = 1.8551e-04
Loss = 1.7773e-01, PNorm = 45.2965, GNorm = 1.2783, lr_0 = 1.8334e-04
Validation auc = 0.773073
Epoch 71
Loss = 1.2625e-01, PNorm = 45.3129, GNorm = 1.5113, lr_0 = 1.8120e-04
Loss = 1.8740e-01, PNorm = 45.3285, GNorm = 2.3526, lr_0 = 1.7909e-04
Validation auc = 0.760280
Epoch 72
Loss = 1.4945e-01, PNorm = 45.3439, GNorm = 1.7738, lr_0 = 1.7699e-04
Loss = 1.8040e-01, PNorm = 45.3584, GNorm = 3.5087, lr_0 = 1.7493e-04
Validation auc = 0.759366
Epoch 73
Loss = 1.0310e-01, PNorm = 45.3743, GNorm = 1.1917, lr_0 = 1.7268e-04
Loss = 1.4046e-01, PNorm = 45.3928, GNorm = 2.0859, lr_0 = 1.7066e-04
Loss = 1.7116e-01, PNorm = 45.4099, GNorm = 1.8419, lr_0 = 1.6867e-04
Validation auc = 0.769114
Epoch 74
Loss = 1.4346e-01, PNorm = 45.4242, GNorm = 2.7683, lr_0 = 1.6670e-04
Loss = 1.6920e-01, PNorm = 45.4390, GNorm = 1.8117, lr_0 = 1.6475e-04
Validation auc = 0.771550
Epoch 75
Loss = 1.6297e-01, PNorm = 45.4556, GNorm = 1.7401, lr_0 = 1.6283e-04
Loss = 1.4754e-01, PNorm = 45.4704, GNorm = 1.4883, lr_0 = 1.6093e-04
Validation auc = 0.773683
Epoch 76
Loss = 1.7359e-01, PNorm = 45.4839, GNorm = 2.3287, lr_0 = 1.5905e-04
Loss = 1.7222e-01, PNorm = 45.4964, GNorm = 3.8094, lr_0 = 1.5719e-04
Validation auc = 0.777947
Epoch 77
Loss = 1.6782e-01, PNorm = 45.5097, GNorm = 4.4811, lr_0 = 1.5536e-04
Loss = 1.5506e-01, PNorm = 45.5220, GNorm = 1.7036, lr_0 = 1.5354e-04
Validation auc = 0.773073
Epoch 78
Loss = 1.2812e-01, PNorm = 45.5334, GNorm = 2.5708, lr_0 = 1.5157e-04
Loss = 1.6688e-01, PNorm = 45.5458, GNorm = 2.7067, lr_0 = 1.4980e-04
Validation auc = 0.768504
Epoch 79
Loss = 1.2853e-01, PNorm = 45.5573, GNorm = 1.6013, lr_0 = 1.4805e-04
Loss = 1.5844e-01, PNorm = 45.5704, GNorm = 2.0634, lr_0 = 1.4632e-04
Validation auc = 0.769723
Epoch 80
Loss = 1.1888e-01, PNorm = 45.5823, GNorm = 2.0594, lr_0 = 1.4461e-04
Loss = 1.5349e-01, PNorm = 45.5947, GNorm = 3.2765, lr_0 = 1.4292e-04
Validation auc = 0.772769
Epoch 81
Loss = 1.5318e-01, PNorm = 45.6049, GNorm = 3.5157, lr_0 = 1.4125e-04
Loss = 1.8702e-01, PNorm = 45.6162, GNorm = 1.0481, lr_0 = 1.3960e-04
Validation auc = 0.773073
Epoch 82
Loss = 1.2334e-01, PNorm = 45.6276, GNorm = 1.8696, lr_0 = 1.3797e-04
Loss = 1.6463e-01, PNorm = 45.6389, GNorm = 2.0896, lr_0 = 1.3636e-04
Validation auc = 0.781298
Epoch 83
Loss = 2.2270e-01, PNorm = 45.6498, GNorm = 5.0306, lr_0 = 1.3477e-04
Loss = 1.2075e-01, PNorm = 45.6611, GNorm = 1.5307, lr_0 = 1.3320e-04
Validation auc = 0.778252
Epoch 84
Loss = 1.3420e-01, PNorm = 45.6711, GNorm = 2.1359, lr_0 = 1.3149e-04
Loss = 1.4537e-01, PNorm = 45.6793, GNorm = 2.3265, lr_0 = 1.2995e-04
Validation auc = 0.769418
Epoch 85
Loss = 1.4244e-01, PNorm = 45.6884, GNorm = 1.7475, lr_0 = 1.2843e-04
Loss = 1.5208e-01, PNorm = 45.6972, GNorm = 2.1895, lr_0 = 1.2693e-04
Loss = 1.5471e-01, PNorm = 45.7069, GNorm = 2.6479, lr_0 = 1.2545e-04
Validation auc = 0.769418
Epoch 86
Loss = 1.6403e-01, PNorm = 45.7151, GNorm = 2.5315, lr_0 = 1.2398e-04
Loss = 1.3130e-01, PNorm = 45.7238, GNorm = 1.2747, lr_0 = 1.2254e-04
Validation auc = 0.778252
Epoch 87
Loss = 1.6309e-01, PNorm = 45.7342, GNorm = 3.3481, lr_0 = 1.2111e-04
Loss = 1.3018e-01, PNorm = 45.7425, GNorm = 2.0912, lr_0 = 1.1969e-04
Validation auc = 0.769418
Epoch 88
Loss = 1.2351e-01, PNorm = 45.7495, GNorm = 1.4311, lr_0 = 1.1829e-04
Loss = 1.1387e-01, PNorm = 45.7571, GNorm = 1.6203, lr_0 = 1.1691e-04
Validation auc = 0.772160
Epoch 89
Loss = 1.1197e-01, PNorm = 45.7673, GNorm = 1.7448, lr_0 = 1.1541e-04
Loss = 1.3024e-01, PNorm = 45.7774, GNorm = 2.6961, lr_0 = 1.1406e-04
Validation auc = 0.775206
Epoch 90
Loss = 1.4039e-01, PNorm = 45.7856, GNorm = 2.8504, lr_0 = 1.1273e-04
Loss = 1.3581e-01, PNorm = 45.7936, GNorm = 1.9045, lr_0 = 1.1141e-04
Validation auc = 0.773987
Epoch 91
Loss = 1.2097e-01, PNorm = 45.8000, GNorm = 2.0717, lr_0 = 1.1011e-04
Loss = 1.4019e-01, PNorm = 45.8076, GNorm = 1.7651, lr_0 = 1.0883e-04
Validation auc = 0.773683
Epoch 92
Loss = 1.2283e-01, PNorm = 45.8163, GNorm = 1.4530, lr_0 = 1.0756e-04
Loss = 1.4192e-01, PNorm = 45.8243, GNorm = 2.1816, lr_0 = 1.0630e-04
Validation auc = 0.777947
Epoch 93
Loss = 1.0175e-01, PNorm = 45.8326, GNorm = 2.1936, lr_0 = 1.0506e-04
Loss = 1.5706e-01, PNorm = 45.8396, GNorm = 2.7189, lr_0 = 1.0383e-04
Validation auc = 0.772464
Epoch 94
Loss = 1.3065e-01, PNorm = 45.8468, GNorm = 1.9672, lr_0 = 1.0262e-04
Loss = 1.2802e-01, PNorm = 45.8536, GNorm = 2.4421, lr_0 = 1.0142e-04
Validation auc = 0.778861
Epoch 95
Loss = 8.8788e-02, PNorm = 45.8614, GNorm = 0.9958, lr_0 = 1.0012e-04
Loss = 1.1950e-01, PNorm = 45.8694, GNorm = 2.3698, lr_0 = 1.0000e-04
Validation auc = 0.771094
Epoch 96
Loss = 8.8808e-02, PNorm = 45.8764, GNorm = 2.1990, lr_0 = 1.0000e-04
Loss = 1.0466e-01, PNorm = 45.8828, GNorm = 3.3054, lr_0 = 1.0000e-04
Validation auc = 0.772464
Epoch 97
Loss = 9.2559e-02, PNorm = 45.8877, GNorm = 2.0790, lr_0 = 1.0000e-04
Loss = 1.2485e-01, PNorm = 45.8939, GNorm = 2.3840, lr_0 = 1.0000e-04
Loss = 1.2318e-01, PNorm = 45.9018, GNorm = 2.8636, lr_0 = 1.0000e-04
Validation auc = 0.772160
Epoch 98
Loss = 1.1203e-01, PNorm = 45.9093, GNorm = 1.6496, lr_0 = 1.0000e-04
Loss = 1.3616e-01, PNorm = 45.9151, GNorm = 2.9730, lr_0 = 1.0000e-04
Validation auc = 0.771855
Epoch 99
Loss = 1.3075e-01, PNorm = 45.9228, GNorm = 3.6034, lr_0 = 1.0000e-04
Loss = 1.2075e-01, PNorm = 45.9290, GNorm = 2.0624, lr_0 = 1.0000e-04
Validation auc = 0.768200
Model 0 best validation auc = 0.798355 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.774952
Ensemble test auc = 0.774952
1-fold cross validation
	Seed 0 ==> test auc = 0.774952
Overall test auc = 0.774952 +/- 0.000000
Elapsed time = 0:02:26
Command line
python /home/jxy/anaconda3/envs/chemprop_1119/bin/chemprop_train --data_path data/train_full.csv --dataset_type classification --save_dir checkpoints_31 --config_path hyperoptfile3 --epochs 100 --separate_test_path data/test_random_nocanonical.csv --separate_val_path data/val_full.csv --features_generator rdkit_2d_normalized --no_features_scaling
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'hyperoptfile3',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/train_full.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.3,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'checkpoints_31',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'data/test_random_nocanonical.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'data/val_full.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smile'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 46.78%, 1: 53.22%
Total size = 1,041 | train size = 1,041 | val size = 116 | test size = 290
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.3, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=800, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,370,401
Moving model to cuda
Epoch 0
Loss = 7.1538e-01, PNorm = 46.7647, GNorm = 1.1660, lr_0 = 3.4750e-04
Loss = 7.0015e-01, PNorm = 46.7805, GNorm = 2.4763, lr_0 = 5.7250e-04
Loss = 6.4806e-01, PNorm = 46.7826, GNorm = 1.1446, lr_0 = 5.9500e-04
Validation auc = 0.722814
Epoch 1
Loss = 6.6468e-01, PNorm = 46.8136, GNorm = 1.3994, lr_0 = 8.2000e-04
Loss = 6.6929e-01, PNorm = 46.8588, GNorm = 1.2617, lr_0 = 9.9765e-04
Validation auc = 0.724337
Epoch 2
Loss = 6.5372e-01, PNorm = 46.9060, GNorm = 1.7230, lr_0 = 9.8600e-04
Loss = 6.6522e-01, PNorm = 46.9495, GNorm = 1.0772, lr_0 = 9.7449e-04
Validation auc = 0.748705
Epoch 3
Loss = 6.2076e-01, PNorm = 46.9880, GNorm = 0.7310, lr_0 = 9.6310e-04
Loss = 6.3438e-01, PNorm = 47.0202, GNorm = 1.3359, lr_0 = 9.5186e-04
Validation auc = 0.747487
Epoch 4
Loss = 6.1554e-01, PNorm = 47.0487, GNorm = 0.5898, lr_0 = 9.4074e-04
Loss = 6.1024e-01, PNorm = 47.0801, GNorm = 0.9885, lr_0 = 9.2975e-04
Validation auc = 0.747487
Epoch 5
Loss = 5.9415e-01, PNorm = 47.1083, GNorm = 0.9309, lr_0 = 9.1889e-04
Loss = 6.0489e-01, PNorm = 47.1443, GNorm = 0.6201, lr_0 = 9.0816e-04
Validation auc = 0.752665
Epoch 6
Loss = 6.1540e-01, PNorm = 47.1848, GNorm = 1.5146, lr_0 = 8.9650e-04
Loss = 6.0003e-01, PNorm = 47.2132, GNorm = 0.7081, lr_0 = 8.8603e-04
Validation auc = 0.758757
Epoch 7
Loss = 5.7440e-01, PNorm = 47.2516, GNorm = 0.7129, lr_0 = 8.7568e-04
Loss = 6.1238e-01, PNorm = 47.2914, GNorm = 1.0540, lr_0 = 8.6546e-04
Validation auc = 0.762108
Epoch 8
Loss = 5.7738e-01, PNorm = 47.3147, GNorm = 0.8741, lr_0 = 8.5535e-04
Loss = 5.8895e-01, PNorm = 47.3501, GNorm = 0.6415, lr_0 = 8.4536e-04
Validation auc = 0.754493
Epoch 9
Loss = 6.4209e-01, PNorm = 47.3861, GNorm = 0.7784, lr_0 = 8.3549e-04
Loss = 5.7642e-01, PNorm = 47.4230, GNorm = 0.9093, lr_0 = 8.2573e-04
Validation auc = 0.755711
Epoch 10
Loss = 6.3198e-01, PNorm = 47.4554, GNorm = 0.6434, lr_0 = 8.1608e-04
Loss = 5.8255e-01, PNorm = 47.4932, GNorm = 0.8799, lr_0 = 8.0655e-04
Validation auc = 0.751751
Epoch 11
Loss = 6.7831e-01, PNorm = 47.5346, GNorm = 1.0224, lr_0 = 7.9713e-04
Loss = 5.5697e-01, PNorm = 47.5765, GNorm = 0.8648, lr_0 = 7.8782e-04
Validation auc = 0.770637
Epoch 12
Loss = 5.9378e-01, PNorm = 47.6302, GNorm = 0.6290, lr_0 = 7.7771e-04
Loss = 5.6403e-01, PNorm = 47.6678, GNorm = 0.5771, lr_0 = 7.6862e-04
Loss = 5.8200e-01, PNorm = 47.7018, GNorm = 0.7212, lr_0 = 7.5965e-04
Validation auc = 0.774292
Epoch 13
Loss = 5.7481e-01, PNorm = 47.7432, GNorm = 0.5452, lr_0 = 7.5078e-04
Loss = 5.7361e-01, PNorm = 47.7886, GNorm = 0.6381, lr_0 = 7.4201e-04
Validation auc = 0.761194
Epoch 14
Loss = 5.8514e-01, PNorm = 47.8356, GNorm = 0.7490, lr_0 = 7.3334e-04
Loss = 5.6585e-01, PNorm = 47.8765, GNorm = 0.9853, lr_0 = 7.2478e-04
Validation auc = 0.765763
Epoch 15
Loss = 5.3763e-01, PNorm = 47.9220, GNorm = 0.6913, lr_0 = 7.1631e-04
Loss = 5.4216e-01, PNorm = 47.9757, GNorm = 0.6625, lr_0 = 7.0795e-04
Validation auc = 0.758453
Epoch 16
Loss = 5.4547e-01, PNorm = 48.0218, GNorm = 0.6775, lr_0 = 6.9968e-04
Loss = 5.2912e-01, PNorm = 48.0761, GNorm = 0.7553, lr_0 = 6.9151e-04
Validation auc = 0.774596
Epoch 17
Loss = 5.1985e-01, PNorm = 48.1341, GNorm = 0.6707, lr_0 = 6.8263e-04
Loss = 5.5264e-01, PNorm = 48.1878, GNorm = 0.8727, lr_0 = 6.7465e-04
Validation auc = 0.774901
Epoch 18
Loss = 5.3609e-01, PNorm = 48.2415, GNorm = 0.6616, lr_0 = 6.6678e-04
Loss = 5.0815e-01, PNorm = 48.3032, GNorm = 0.6507, lr_0 = 6.5899e-04
Validation auc = 0.774901
Epoch 19
Loss = 5.4778e-01, PNorm = 48.3665, GNorm = 1.1362, lr_0 = 6.5129e-04
Loss = 5.4300e-01, PNorm = 48.4305, GNorm = 1.0615, lr_0 = 6.4369e-04
Validation auc = 0.768809
Epoch 20
Loss = 5.3178e-01, PNorm = 48.4953, GNorm = 0.6025, lr_0 = 6.3617e-04
Loss = 5.3648e-01, PNorm = 48.5649, GNorm = 1.1364, lr_0 = 6.2874e-04
Validation auc = 0.774596
Epoch 21
Loss = 5.0340e-01, PNorm = 48.6273, GNorm = 0.8027, lr_0 = 6.2139e-04
Loss = 5.0752e-01, PNorm = 48.6848, GNorm = 0.6317, lr_0 = 6.1414e-04
Validation auc = 0.784344
Epoch 22
Loss = 5.1978e-01, PNorm = 48.7371, GNorm = 0.9020, lr_0 = 6.0696e-04
Loss = 4.9506e-01, PNorm = 48.8054, GNorm = 0.9052, lr_0 = 5.9988e-04
Validation auc = 0.784039
Epoch 23
Loss = 4.9764e-01, PNorm = 48.8745, GNorm = 0.6432, lr_0 = 5.9217e-04
Loss = 5.0548e-01, PNorm = 48.9496, GNorm = 0.8841, lr_0 = 5.8526e-04
Validation auc = 0.791349
Epoch 24
Loss = 4.8851e-01, PNorm = 49.0175, GNorm = 0.7085, lr_0 = 5.7842e-04
Loss = 4.8335e-01, PNorm = 49.0877, GNorm = 1.1029, lr_0 = 5.7167e-04
Loss = 5.2215e-01, PNorm = 49.1540, GNorm = 0.8280, lr_0 = 5.6499e-04
Validation auc = 0.779470
Epoch 25
Loss = 5.0880e-01, PNorm = 49.2197, GNorm = 0.6297, lr_0 = 5.5839e-04
Loss = 4.8759e-01, PNorm = 49.2880, GNorm = 0.5954, lr_0 = 5.5187e-04
Validation auc = 0.758453
Epoch 26
Loss = 5.0504e-01, PNorm = 49.3497, GNorm = 0.9905, lr_0 = 5.4542e-04
Loss = 4.7742e-01, PNorm = 49.4262, GNorm = 0.9491, lr_0 = 5.3905e-04
Validation auc = 0.771246
Epoch 27
Loss = 4.8649e-01, PNorm = 49.4931, GNorm = 0.9009, lr_0 = 5.3276e-04
Loss = 4.7118e-01, PNorm = 49.5634, GNorm = 0.6028, lr_0 = 5.2654e-04
Validation auc = 0.776119
Epoch 28
Loss = 4.3010e-01, PNorm = 49.6461, GNorm = 0.8381, lr_0 = 5.1978e-04
Loss = 4.6848e-01, PNorm = 49.7174, GNorm = 1.0368, lr_0 = 5.1371e-04
Validation auc = 0.811148
Epoch 29
Loss = 4.6550e-01, PNorm = 49.7983, GNorm = 0.7009, lr_0 = 5.0771e-04
Loss = 4.8006e-01, PNorm = 49.8722, GNorm = 0.8508, lr_0 = 5.0178e-04
Validation auc = 0.789217
Epoch 30
Loss = 4.2924e-01, PNorm = 49.9537, GNorm = 1.5017, lr_0 = 4.9592e-04
Loss = 4.8089e-01, PNorm = 50.0214, GNorm = 1.5915, lr_0 = 4.9012e-04
Validation auc = 0.791045
Epoch 31
Loss = 4.6349e-01, PNorm = 50.0922, GNorm = 0.8471, lr_0 = 4.8440e-04
Loss = 4.6867e-01, PNorm = 50.1632, GNorm = 1.0937, lr_0 = 4.7874e-04
Validation auc = 0.802010
Epoch 32
Loss = 3.7545e-01, PNorm = 50.2279, GNorm = 0.9845, lr_0 = 4.7315e-04
Loss = 4.3112e-01, PNorm = 50.2974, GNorm = 2.8313, lr_0 = 4.6763e-04
Validation auc = 0.772464
Epoch 33
Loss = 3.9240e-01, PNorm = 50.3613, GNorm = 0.6364, lr_0 = 4.6216e-04
Loss = 4.1922e-01, PNorm = 50.4309, GNorm = 0.9461, lr_0 = 4.5677e-04
Validation auc = 0.794395
Epoch 34
Loss = 4.5321e-01, PNorm = 50.5011, GNorm = 1.4793, lr_0 = 4.5090e-04
Loss = 3.7620e-01, PNorm = 50.5660, GNorm = 0.6562, lr_0 = 4.4564e-04
Validation auc = 0.777033
Epoch 35
Loss = 3.2366e-01, PNorm = 50.6274, GNorm = 0.7739, lr_0 = 4.4043e-04
Loss = 4.4458e-01, PNorm = 50.6893, GNorm = 1.4344, lr_0 = 4.3529e-04
Validation auc = 0.809625
Epoch 36
Loss = 5.1128e-01, PNorm = 50.7487, GNorm = 1.2459, lr_0 = 4.3020e-04
Loss = 4.1073e-01, PNorm = 50.8082, GNorm = 1.2566, lr_0 = 4.2518e-04
Loss = 3.8326e-01, PNorm = 50.8647, GNorm = 0.8702, lr_0 = 4.2021e-04
Validation auc = 0.784648
Epoch 37
Loss = 4.1976e-01, PNorm = 50.9185, GNorm = 1.3625, lr_0 = 4.1531e-04
Loss = 4.1713e-01, PNorm = 50.9754, GNorm = 0.8263, lr_0 = 4.1045e-04
Validation auc = 0.779775
Epoch 38
Loss = 4.2746e-01, PNorm = 51.0323, GNorm = 0.9792, lr_0 = 4.0566e-04
Loss = 3.7433e-01, PNorm = 51.0911, GNorm = 0.8530, lr_0 = 4.0092e-04
Validation auc = 0.798660
Epoch 39
Loss = 4.3049e-01, PNorm = 51.1503, GNorm = 1.5392, lr_0 = 3.9578e-04
Loss = 3.3813e-01, PNorm = 51.2049, GNorm = 1.0750, lr_0 = 3.9115e-04
Validation auc = 0.781907
Epoch 40
Loss = 3.4281e-01, PNorm = 51.2550, GNorm = 1.1324, lr_0 = 3.8658e-04
Loss = 4.0516e-01, PNorm = 51.3159, GNorm = 1.2230, lr_0 = 3.8207e-04
Validation auc = 0.788913
Epoch 41
Loss = 3.4957e-01, PNorm = 51.3675, GNorm = 0.9282, lr_0 = 3.7761e-04
Loss = 3.5123e-01, PNorm = 51.4274, GNorm = 1.0243, lr_0 = 3.7320e-04
Validation auc = 0.784039
Epoch 42
Loss = 3.5570e-01, PNorm = 51.4814, GNorm = 1.6667, lr_0 = 3.6884e-04
Loss = 3.5260e-01, PNorm = 51.5378, GNorm = 1.2236, lr_0 = 3.6453e-04
Validation auc = 0.795918
Epoch 43
Loss = 3.2447e-01, PNorm = 51.5871, GNorm = 0.9561, lr_0 = 3.6027e-04
Loss = 3.5350e-01, PNorm = 51.6436, GNorm = 1.5659, lr_0 = 3.5607e-04
Validation auc = 0.770027
Epoch 44
Loss = 3.6764e-01, PNorm = 51.6935, GNorm = 1.4013, lr_0 = 3.5191e-04
Loss = 3.1945e-01, PNorm = 51.7409, GNorm = 1.4218, lr_0 = 3.4780e-04
Validation auc = 0.771550
Epoch 45
Loss = 3.4027e-01, PNorm = 51.7934, GNorm = 1.5526, lr_0 = 3.4333e-04
Loss = 3.8246e-01, PNorm = 51.8345, GNorm = 1.5439, lr_0 = 3.3932e-04
Validation auc = 0.792872
Epoch 46
Loss = 4.0549e-01, PNorm = 51.8750, GNorm = 1.4971, lr_0 = 3.3536e-04
Loss = 3.3601e-01, PNorm = 51.9193, GNorm = 0.9191, lr_0 = 3.3144e-04
Validation auc = 0.785562
Epoch 47
Loss = 3.6740e-01, PNorm = 51.9612, GNorm = 1.1763, lr_0 = 3.2757e-04
Loss = 2.9494e-01, PNorm = 52.0060, GNorm = 1.4652, lr_0 = 3.2375e-04
Validation auc = 0.774596
Epoch 48
Loss = 2.4913e-01, PNorm = 52.0481, GNorm = 1.1229, lr_0 = 3.1996e-04
Loss = 3.1140e-01, PNorm = 52.0898, GNorm = 2.1721, lr_0 = 3.1623e-04
Loss = 3.0120e-01, PNorm = 52.1342, GNorm = 1.5257, lr_0 = 3.1253e-04
Validation auc = 0.786171
Epoch 49
Loss = 2.9730e-01, PNorm = 52.1788, GNorm = 0.8195, lr_0 = 3.0888e-04
Loss = 2.7788e-01, PNorm = 52.2247, GNorm = 1.2595, lr_0 = 3.0528e-04
Validation auc = 0.779470
Epoch 50
Loss = 3.1728e-01, PNorm = 52.2599, GNorm = 1.9231, lr_0 = 3.0171e-04
Loss = 2.7336e-01, PNorm = 52.2992, GNorm = 1.2441, lr_0 = 2.9819e-04
Validation auc = 0.778861
Epoch 51
Loss = 2.6678e-01, PNorm = 52.3443, GNorm = 2.1274, lr_0 = 2.9436e-04
Loss = 2.8259e-01, PNorm = 52.3826, GNorm = 1.5914, lr_0 = 2.9092e-04
Validation auc = 0.770637
Epoch 52
Loss = 2.4594e-01, PNorm = 52.4205, GNorm = 1.6848, lr_0 = 2.8752e-04
Loss = 2.7190e-01, PNorm = 52.4610, GNorm = 2.2868, lr_0 = 2.8417e-04
Validation auc = 0.772464
Epoch 53
Loss = 2.7365e-01, PNorm = 52.4965, GNorm = 2.4069, lr_0 = 2.8085e-04
Loss = 2.6706e-01, PNorm = 52.5329, GNorm = 1.1817, lr_0 = 2.7757e-04
Validation auc = 0.768504
Epoch 54
Loss = 2.6673e-01, PNorm = 52.5655, GNorm = 1.0058, lr_0 = 2.7432e-04
Loss = 2.9200e-01, PNorm = 52.5965, GNorm = 2.5909, lr_0 = 2.7112e-04
Validation auc = 0.756930
Epoch 55
Loss = 2.7963e-01, PNorm = 52.6285, GNorm = 2.5874, lr_0 = 2.6795e-04
Loss = 2.5996e-01, PNorm = 52.6607, GNorm = 1.4238, lr_0 = 2.6483e-04
Validation auc = 0.772464
Epoch 56
Loss = 2.7245e-01, PNorm = 52.6951, GNorm = 2.2201, lr_0 = 2.6142e-04
Loss = 2.3549e-01, PNorm = 52.7212, GNorm = 1.1387, lr_0 = 2.5837e-04
Validation auc = 0.773987
Epoch 57
Loss = 2.2902e-01, PNorm = 52.7535, GNorm = 1.6738, lr_0 = 2.5535e-04
Loss = 2.5391e-01, PNorm = 52.7840, GNorm = 1.9023, lr_0 = 2.5237e-04
Validation auc = 0.773073
Epoch 58
Loss = 2.6348e-01, PNorm = 52.8098, GNorm = 1.5565, lr_0 = 2.4942e-04
Loss = 2.3382e-01, PNorm = 52.8385, GNorm = 1.2651, lr_0 = 2.4651e-04
Validation auc = 0.771550
Epoch 59
Loss = 1.8984e-01, PNorm = 52.8697, GNorm = 0.8713, lr_0 = 2.4363e-04
Loss = 2.5620e-01, PNorm = 52.8965, GNorm = 1.3743, lr_0 = 2.4079e-04
Validation auc = 0.773987
Epoch 60
Loss = 1.2618e-01, PNorm = 52.9222, GNorm = 1.1456, lr_0 = 2.3797e-04
Loss = 2.0828e-01, PNorm = 52.9507, GNorm = 2.1075, lr_0 = 2.3520e-04
Loss = 2.8032e-01, PNorm = 52.9752, GNorm = 2.6466, lr_0 = 2.3245e-04
Validation auc = 0.768809
Epoch 61
Loss = 2.4057e-01, PNorm = 53.0004, GNorm = 1.5846, lr_0 = 2.2973e-04
Loss = 2.3004e-01, PNorm = 53.0256, GNorm = 3.2013, lr_0 = 2.2705e-04
Loss = 1.4926e-01, PNorm = 53.0284, GNorm = 1.3671, lr_0 = 2.2678e-04
Validation auc = 0.778861
Epoch 62
Loss = 2.1722e-01, PNorm = 53.0519, GNorm = 1.2306, lr_0 = 2.2414e-04
Loss = 2.4466e-01, PNorm = 53.0735, GNorm = 2.8599, lr_0 = 2.2152e-04
Validation auc = 0.775815
Epoch 63
Loss = 2.5813e-01, PNorm = 53.0982, GNorm = 4.2538, lr_0 = 2.1893e-04
Loss = 2.2214e-01, PNorm = 53.1228, GNorm = 0.9380, lr_0 = 2.1637e-04
Validation auc = 0.766372
Epoch 64
Loss = 2.1443e-01, PNorm = 53.1465, GNorm = 1.0249, lr_0 = 2.1385e-04
Loss = 2.0276e-01, PNorm = 53.1706, GNorm = 2.1733, lr_0 = 2.1135e-04
Validation auc = 0.764240
Epoch 65
Loss = 2.2908e-01, PNorm = 53.1939, GNorm = 2.3358, lr_0 = 2.0888e-04
Loss = 1.7063e-01, PNorm = 53.2135, GNorm = 1.5328, lr_0 = 2.0644e-04
Validation auc = 0.769418
Epoch 66
Loss = 1.7697e-01, PNorm = 53.2349, GNorm = 1.9204, lr_0 = 2.0403e-04
Loss = 1.9671e-01, PNorm = 53.2567, GNorm = 1.4338, lr_0 = 2.0165e-04
Validation auc = 0.771550
Epoch 67
Loss = 1.9313e-01, PNorm = 53.2797, GNorm = 1.2987, lr_0 = 1.9906e-04
Loss = 1.8064e-01, PNorm = 53.2989, GNorm = 1.1657, lr_0 = 1.9673e-04
Validation auc = 0.766981
Epoch 68
Loss = 2.0197e-01, PNorm = 53.3188, GNorm = 2.8432, lr_0 = 1.9444e-04
Loss = 2.0531e-01, PNorm = 53.3382, GNorm = 2.3800, lr_0 = 1.9216e-04
Validation auc = 0.775510
Epoch 69
Loss = 2.0957e-01, PNorm = 53.3572, GNorm = 1.6494, lr_0 = 1.8992e-04
Loss = 1.6189e-01, PNorm = 53.3765, GNorm = 1.7873, lr_0 = 1.8770e-04
Validation auc = 0.770027
Epoch 70
Loss = 1.6920e-01, PNorm = 53.3923, GNorm = 1.0123, lr_0 = 1.8551e-04
Loss = 1.8805e-01, PNorm = 53.4096, GNorm = 2.0214, lr_0 = 1.8334e-04
Validation auc = 0.773987
Epoch 71
Loss = 1.3403e-01, PNorm = 53.4253, GNorm = 1.3303, lr_0 = 1.8120e-04
Loss = 1.8159e-01, PNorm = 53.4462, GNorm = 1.6144, lr_0 = 1.7909e-04
Validation auc = 0.765763
Epoch 72
Loss = 2.3311e-01, PNorm = 53.4640, GNorm = 2.0124, lr_0 = 1.7699e-04
Loss = 1.7826e-01, PNorm = 53.4782, GNorm = 2.1848, lr_0 = 1.7493e-04
Validation auc = 0.771246
Epoch 73
Loss = 1.4105e-01, PNorm = 53.4947, GNorm = 1.2438, lr_0 = 1.7268e-04
Loss = 1.6450e-01, PNorm = 53.5112, GNorm = 1.4192, lr_0 = 1.7066e-04
Loss = 2.0181e-01, PNorm = 53.5271, GNorm = 1.0543, lr_0 = 1.6867e-04
Validation auc = 0.770941
Epoch 74
Loss = 1.7793e-01, PNorm = 53.5418, GNorm = 3.1475, lr_0 = 1.6670e-04
Loss = 1.9484e-01, PNorm = 53.5578, GNorm = 1.3894, lr_0 = 1.6475e-04
Validation auc = 0.764545
Epoch 75
Loss = 1.8520e-01, PNorm = 53.5709, GNorm = 1.4234, lr_0 = 1.6283e-04
Loss = 1.8386e-01, PNorm = 53.5841, GNorm = 1.9663, lr_0 = 1.6093e-04
Validation auc = 0.770637
Epoch 76
Loss = 1.6568e-01, PNorm = 53.6001, GNorm = 2.5484, lr_0 = 1.5905e-04
Loss = 1.6268e-01, PNorm = 53.6132, GNorm = 1.9054, lr_0 = 1.5719e-04
Validation auc = 0.763935
Epoch 77
Loss = 1.4794e-01, PNorm = 53.6282, GNorm = 2.1246, lr_0 = 1.5536e-04
Loss = 1.6643e-01, PNorm = 53.6414, GNorm = 1.3321, lr_0 = 1.5354e-04
Validation auc = 0.768809
Epoch 78
Loss = 1.2380e-01, PNorm = 53.6576, GNorm = 1.0502, lr_0 = 1.5157e-04
Loss = 1.7340e-01, PNorm = 53.6714, GNorm = 1.6646, lr_0 = 1.4980e-04
Validation auc = 0.763326
Epoch 79
Loss = 1.0825e-01, PNorm = 53.6837, GNorm = 1.2797, lr_0 = 1.4805e-04
Loss = 1.5406e-01, PNorm = 53.6972, GNorm = 1.2303, lr_0 = 1.4632e-04
Validation auc = 0.773683
Epoch 80
Loss = 1.4607e-01, PNorm = 53.7098, GNorm = 2.4534, lr_0 = 1.4461e-04
Loss = 1.6263e-01, PNorm = 53.7232, GNorm = 3.6461, lr_0 = 1.4292e-04
Validation auc = 0.767591
Epoch 81
Loss = 2.3315e-01, PNorm = 53.7323, GNorm = 2.6149, lr_0 = 1.4125e-04
Loss = 1.5822e-01, PNorm = 53.7425, GNorm = 1.8334, lr_0 = 1.3960e-04
Validation auc = 0.764240
Epoch 82
Loss = 1.3865e-01, PNorm = 53.7543, GNorm = 1.5573, lr_0 = 1.3797e-04
Loss = 1.6659e-01, PNorm = 53.7657, GNorm = 1.6163, lr_0 = 1.3636e-04
Validation auc = 0.767591
Epoch 83
Loss = 1.9603e-01, PNorm = 53.7762, GNorm = 2.6543, lr_0 = 1.3477e-04
Loss = 1.3796e-01, PNorm = 53.7859, GNorm = 0.6799, lr_0 = 1.3320e-04
Validation auc = 0.766981
Epoch 84
Loss = 4.9915e-02, PNorm = 53.7960, GNorm = 0.5566, lr_0 = 1.3149e-04
Loss = 1.5014e-01, PNorm = 53.8061, GNorm = 1.0122, lr_0 = 1.2995e-04
Validation auc = 0.763326
Epoch 85
Loss = 7.0384e-02, PNorm = 53.8155, GNorm = 1.1625, lr_0 = 1.2843e-04
Loss = 1.2508e-01, PNorm = 53.8236, GNorm = 2.5191, lr_0 = 1.2693e-04
Loss = 1.6452e-01, PNorm = 53.8325, GNorm = 1.2630, lr_0 = 1.2545e-04
Validation auc = 0.771550
Epoch 86
Loss = 1.6762e-01, PNorm = 53.8394, GNorm = 3.7337, lr_0 = 1.2398e-04
Loss = 1.3011e-01, PNorm = 53.8479, GNorm = 1.2933, lr_0 = 1.2254e-04
Validation auc = 0.768504
Epoch 87
Loss = 1.6781e-01, PNorm = 53.8572, GNorm = 2.3109, lr_0 = 1.2111e-04
Loss = 1.3248e-01, PNorm = 53.8659, GNorm = 1.9316, lr_0 = 1.1969e-04
Validation auc = 0.767286
Epoch 88
Loss = 1.3082e-01, PNorm = 53.8735, GNorm = 2.0241, lr_0 = 1.1829e-04
Loss = 1.3537e-01, PNorm = 53.8823, GNorm = 1.0443, lr_0 = 1.1691e-04
Validation auc = 0.771855
Epoch 89
Loss = 1.2129e-01, PNorm = 53.8927, GNorm = 1.3396, lr_0 = 1.1541e-04
Loss = 1.2845e-01, PNorm = 53.9023, GNorm = 0.9718, lr_0 = 1.1406e-04
Validation auc = 0.767895
Epoch 90
Loss = 1.0410e-01, PNorm = 53.9100, GNorm = 1.9298, lr_0 = 1.1273e-04
Loss = 1.4895e-01, PNorm = 53.9187, GNorm = 2.0808, lr_0 = 1.1141e-04
Validation auc = 0.768809
Epoch 91
Loss = 1.6354e-01, PNorm = 53.9288, GNorm = 2.1577, lr_0 = 1.1011e-04
Loss = 1.2142e-01, PNorm = 53.9382, GNorm = 1.9336, lr_0 = 1.0883e-04
Validation auc = 0.763935
Epoch 92
Loss = 1.3548e-01, PNorm = 53.9462, GNorm = 1.8125, lr_0 = 1.0756e-04
Loss = 1.0630e-01, PNorm = 53.9547, GNorm = 1.9268, lr_0 = 1.0630e-04
Validation auc = 0.767591
Epoch 93
Loss = 9.2430e-02, PNorm = 53.9623, GNorm = 1.9578, lr_0 = 1.0506e-04
Loss = 1.2778e-01, PNorm = 53.9703, GNorm = 2.1604, lr_0 = 1.0383e-04
Validation auc = 0.762108
Epoch 94
Loss = 1.7120e-01, PNorm = 53.9778, GNorm = 2.7633, lr_0 = 1.0262e-04
Loss = 1.4883e-01, PNorm = 53.9840, GNorm = 1.5453, lr_0 = 1.0142e-04
Validation auc = 0.766372
Epoch 95
Loss = 7.2900e-02, PNorm = 53.9909, GNorm = 1.2105, lr_0 = 1.0012e-04
Loss = 1.3835e-01, PNorm = 53.9986, GNorm = 2.3157, lr_0 = 1.0000e-04
Validation auc = 0.763935
Epoch 96
Loss = 7.4869e-02, PNorm = 54.0059, GNorm = 1.4284, lr_0 = 1.0000e-04
Loss = 1.1602e-01, PNorm = 54.0133, GNorm = 2.0662, lr_0 = 1.0000e-04
Validation auc = 0.765763
Epoch 97
Loss = 9.5353e-02, PNorm = 54.0204, GNorm = 1.8700, lr_0 = 1.0000e-04
Loss = 1.1480e-01, PNorm = 54.0288, GNorm = 2.6987, lr_0 = 1.0000e-04
Loss = 1.3104e-01, PNorm = 54.0362, GNorm = 3.3270, lr_0 = 1.0000e-04
Validation auc = 0.767591
Epoch 98
Loss = 1.3827e-01, PNorm = 54.0438, GNorm = 0.8957, lr_0 = 1.0000e-04
Loss = 1.3863e-01, PNorm = 54.0499, GNorm = 1.7985, lr_0 = 1.0000e-04
Validation auc = 0.764545
Epoch 99
Loss = 1.2752e-01, PNorm = 54.0588, GNorm = 1.9678, lr_0 = 1.0000e-04
Loss = 1.1899e-01, PNorm = 54.0670, GNorm = 1.3172, lr_0 = 1.0000e-04
Validation auc = 0.762717
Model 0 best validation auc = 0.811148 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.808842
Ensemble test auc = 0.808842
1-fold cross validation
	Seed 0 ==> test auc = 0.808842
Overall test auc = 0.808842 +/- 0.000000
Elapsed time = 0:02:28
